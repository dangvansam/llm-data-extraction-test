2025-11-24 03:05:32.302 | INFO     | __main__:<module>:17 - ================================================================================
2025-11-24 03:05:32.302 | INFO     | __main__:<module>:18 - RAG-based NER Evaluation
2025-11-24 03:05:32.302 | INFO     | __main__:<module>:19 - ================================================================================
2025-11-24 03:05:32.304 | INFO     | __main__:<module>:32 - Loaded 100 corpus documents
2025-11-24 03:05:32.304 | INFO     | __main__:<module>:35 - Loading test dataset from /data2/samdv/test/data/processed/test.json
2025-11-24 03:05:32.306 | INFO     | __main__:<module>:37 - Loaded 100 test samples
2025-11-24 03:05:32.306 | INFO     | __main__:<module>:41 - Model: Qwen/Qwen3-4B-Instruct-2507
2025-11-24 03:05:32.306 | INFO     | __main__:<module>:42 - Embedding model: AITeamVN/Vietnamese_Embedding_v2
2025-11-24 03:05:32.306 | INFO     | __main__:<module>:43 - Top-k retrieval: 3
2025-11-24 03:05:32.306 | INFO     | __main__:<module>:44 - 
2025-11-24 03:05:32.306 | INFO     | src.rag_pipeline:__init__:37 - Loading embedding model: AITeamVN/Vietnamese_Embedding_v2
[2025-11-24 03:05:32] INFO SentenceTransformer.py:219: Use pytorch device_name: cuda:0
[2025-11-24 03:05:32] INFO SentenceTransformer.py:227: Load pretrained SentenceTransformer: AITeamVN/Vietnamese_Embedding_v2
2025-11-24 03:05:39.342 | INFO     | src.rag_pipeline:__init__:44 - Loading reranker model: AITeamVN/Vietnamese_Reranker
2025-11-24 03:05:42.110 | SUCCESS  | src.rag_pipeline:__init__:50 - Reranker loaded as transformer model
2025-11-24 03:05:42.110 | INFO     | src.rag_pipeline:_load_llm:72 - Loading LLM with vLLM: Qwen/Qwen3-4B-Instruct-2507
INFO 11-24 03:05:43 [utils.py:253] non-default args: {'max_model_len': 4096, 'gpu_memory_utilization': 0.3, 'kv_cache_memory_bytes': 1073741824, 'disable_log_stats': True, 'model': 'Qwen/Qwen3-4B-Instruct-2507'}
INFO 11-24 03:05:44 [model.py:631] Resolved architecture: Qwen3ForCausalLM
INFO 11-24 03:05:44 [model.py:1745] Using max model len 4096
INFO 11-24 03:05:46 [scheduler.py:216] Chunked prefill is enabled with max_num_batched_tokens=8192.
WARNING 11-24 03:05:47 [system_utils.py:103] We must use the `spawn` multiprocessing start method. Overriding VLLM_WORKER_MULTIPROC_METHOD to 'spawn'. See https://docs.vllm.ai/en/latest/usage/troubleshooting.html#python-multiprocessing for more information. Reasons: CUDA is initialized
(EngineCore_DP0 pid=1875704) INFO 11-24 03:05:52 [core.py:93] Initializing a V1 LLM engine (v0.11.2) with config: model='Qwen/Qwen3-4B-Instruct-2507', speculative_config=None, tokenizer='Qwen/Qwen3-4B-Instruct-2507', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.bfloat16, max_seq_len=4096, download_dir=None, load_format=auto, tensor_parallel_size=1, pipeline_parallel_size=1, data_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, device_config=cuda, structured_outputs_config=StructuredOutputsConfig(backend='auto', disable_fallback=False, disable_any_whitespace=False, disable_additional_properties=False, reasoning_parser='', reasoning_parser_plugin='', enable_in_reasoning=False), observability_config=ObservabilityConfig(show_hidden_metrics_for_version=None, otlp_traces_endpoint=None, collect_detailed_traces=None), seed=0, served_model_name=Qwen/Qwen3-4B-Instruct-2507, enable_prefix_caching=True, enable_chunked_prefill=True, pooler_config=None, compilation_config={'level': None, 'mode': <CompilationMode.VLLM_COMPILE: 3>, 'debug_dump_path': None, 'cache_dir': '', 'compile_cache_save_format': 'binary', 'backend': 'inductor', 'custom_ops': ['none'], 'splitting_ops': ['vllm::unified_attention', 'vllm::unified_attention_with_output', 'vllm::unified_mla_attention', 'vllm::unified_mla_attention_with_output', 'vllm::mamba_mixer2', 'vllm::mamba_mixer', 'vllm::short_conv', 'vllm::linear_attention', 'vllm::plamo2_mamba_mixer', 'vllm::gdn_attention_core', 'vllm::kda_attention', 'vllm::sparse_attn_indexer'], 'compile_mm_encoder': False, 'use_inductor': None, 'compile_sizes': [], 'inductor_compile_config': {'enable_auto_functionalized_v2': False, 'combo_kernels': True, 'benchmark_combo_kernel': True}, 'inductor_passes': {}, 'cudagraph_mode': <CUDAGraphMode.FULL_AND_PIECEWISE: (2, 1)>, 'cudagraph_num_of_warmups': 1, 'cudagraph_capture_sizes': [1, 2, 4, 8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104, 112, 120, 128, 136, 144, 152, 160, 168, 176, 184, 192, 200, 208, 216, 224, 232, 240, 248, 256, 272, 288, 304, 320, 336, 352, 368, 384, 400, 416, 432, 448, 464, 480, 496, 512], 'cudagraph_copy_inputs': False, 'cudagraph_specialize_lora': True, 'use_inductor_graph_partition': False, 'pass_config': {}, 'max_cudagraph_capture_size': 512, 'local_cache_dir': None}
(EngineCore_DP0 pid=1875704) INFO 11-24 03:05:54 [parallel_state.py:1208] world_size=1 rank=0 local_rank=0 distributed_init_method=tcp://192.168.1.3:57255 backend=nccl
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
(EngineCore_DP0 pid=1875704) INFO 11-24 03:05:54 [parallel_state.py:1394] rank 0 in world size 1 is assigned as DP rank 0, PP rank 0, TP rank 0, EP rank 0
(EngineCore_DP0 pid=1875704) INFO 11-24 03:05:54 [gpu_model_runner.py:3259] Starting to load model Qwen/Qwen3-4B-Instruct-2507...
(EngineCore_DP0 pid=1875704) INFO 11-24 03:05:55 [cuda.py:418] Valid backends: ['FLASH_ATTN', 'FLASHINFER', 'TRITON_ATTN', 'FLEX_ATTENTION']
(EngineCore_DP0 pid=1875704) INFO 11-24 03:05:55 [cuda.py:427] Using FLASH_ATTN backend.
Loading safetensors checkpoint shards:   0% Completed | 0/3 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:  33% Completed | 1/3 [00:00<00:01,  1.35it/s]
Loading safetensors checkpoint shards:  67% Completed | 2/3 [00:16<00:09,  9.74s/it]
Loading safetensors checkpoint shards: 100% Completed | 3/3 [00:16<00:00,  5.35s/it]
Loading safetensors checkpoint shards: 100% Completed | 3/3 [00:16<00:00,  5.64s/it]
(EngineCore_DP0 pid=1875704) 
(EngineCore_DP0 pid=1875704) INFO 11-24 03:06:13 [default_loader.py:314] Loading weights took 16.91 seconds
(EngineCore_DP0 pid=1875704) INFO 11-24 03:06:14 [gpu_model_runner.py:3338] Model loading took 7.6065 GiB memory and 19.046565 seconds
(EngineCore_DP0 pid=1875704) INFO 11-24 03:06:20 [backends.py:631] Using cache directory: /home/samdv/.cache/vllm/torch_compile_cache/444ea1ef27/rank_0_0/backbone for vLLM's torch.compile
(EngineCore_DP0 pid=1875704) INFO 11-24 03:06:20 [backends.py:647] Dynamo bytecode transform time: 5.74 s
(EngineCore_DP0 pid=1875704) INFO 11-24 03:06:26 [backends.py:210] Directly load the compiled graph(s) for dynamic shape from the cache, took 5.244 s
(EngineCore_DP0 pid=1875704) INFO 11-24 03:06:27 [monitor.py:34] torch.compile takes 10.99 s in total
(EngineCore_DP0 pid=1875704) INFO 11-24 03:06:28 [gpu_worker.py:312] Initial free memory 15.20 GiB, reserved 1.00 GiB memory for KV Cache as specified by kv_cache_memory_bytes config and skipped memory profiling. This does not respect the gpu_memory_utilization config. Only use kv_cache_memory_bytes config when you want manual control of KV cache memory size. If OOM'ed, check the difference of initial free memory between the current run and the previous run where kv_cache_memory_bytes is suggested and update it correspondingly.
(EngineCore_DP0 pid=1875704) INFO 11-24 03:06:28 [kv_cache_utils.py:1229] GPU KV cache size: 7,280 tokens
(EngineCore_DP0 pid=1875704) INFO 11-24 03:06:28 [kv_cache_utils.py:1234] Maximum concurrency for 4,096 tokens per request: 1.78x
Capturing CUDA graphs (mixed prefill-decode, PIECEWISE): 100%|████████████████████████████████████| 51/51 [00:06<00:00,  7.49it/s]
Capturing CUDA graphs (decode, FULL): 100%|███████████████████████████████████████████████████████| 35/35 [00:01<00:00, 18.17it/s]
(EngineCore_DP0 pid=1875704) INFO 11-24 03:06:37 [gpu_model_runner.py:4244] Graph capturing finished in 9 secs, took 0.18 GiB
(EngineCore_DP0 pid=1875704) INFO 11-24 03:06:37 [core.py:250] init engine (profile, create kv cache, warmup model) took 23.33 seconds
INFO 11-24 03:06:39 [llm.py:352] Supported tasks: ['generate']
2025-11-24 03:06:39.418 | SUCCESS  | src.rag_pipeline:_load_llm:87 - LLM loaded successfully with vLLM
2025-11-24 03:06:39.418 | INFO     | src.rag_pipeline:build_index:96 - Building FAISS index...
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 4/4 [00:06<00:00,  1.64s/it]
2025-11-24 03:06:45.992 | SUCCESS  | src.rag_pipeline:build_index:111 - Index built with 100 documents
2025-11-24 03:06:45.992 | INFO     | __main__:<module>:51 - Starting RAG extraction...
Extracting entities:   0%|                                                                                | 0/100 [00:00<?, ?it/s]2025-11-24 03:06:45.992 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 23.98it/s]
2025-11-24 03:06:46.037 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:06:55.390 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [9.750243186950684, -7.728096961975098, -7.843038082122803]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 240.65it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:01<00:00,  1.71s/it, est. speed input: 471.11 toks/s, output: 22.77 toks/s]
2025-11-24 03:06:57.108 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": [], "organizations": ["Cơ quan quản lý xây dựng", "UBND cấp huyện", "cơ quan tư vấn thiết kế"], "address": []}
2025-11-24 03:06:57.108 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 11.12s
2025-11-24 03:06:57.108 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Thủ tướng'], 'organizations': ['UBND cấp huyện'], 'address': []}
2025-11-24 03:06:57.108 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': [], 'organizations': ['Cơ quan quản lý xây dựng', 'UBND cấp huyện', 'cơ quan tư vấn thiết kế'], 'address': []}
Extracting entities:   1%|▋                                                                       | 1/100 [00:11<18:20, 11.12s/it]2025-11-24 03:06:57.108 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 43.02it/s]
2025-11-24 03:06:57.135 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:07:02.179 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [5.325591564178467, 0.8335598111152649, 0.4286525845527649]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 294.46it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:01<00:00,  1.20s/it, est. speed input: 620.70 toks/s, output: 29.95 toks/s]
2025-11-24 03:07:03.385 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": [], "organizations": ["Đoàn Thanh tra liên ngành tỉnh Gia Lai", "NLĐ"], "address": ["Gia Lai"]}
2025-11-24 03:07:03.385 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 6.28s
2025-11-24 03:07:03.385 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': [], 'organizations': ['Đoàn Thanh tra liên ngành tỉnh Gia Lai', 'NLĐ'], 'address': ['Gia Lai']}
2025-11-24 03:07:03.386 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': [], 'organizations': ['Đoàn Thanh tra liên ngành tỉnh Gia Lai', 'NLĐ'], 'address': ['Gia Lai']}
Extracting entities:   2%|█▍                                                                      | 2/100 [00:17<13:30,  8.27s/it]2025-11-24 03:07:03.386 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 11.14it/s]
2025-11-24 03:07:03.479 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:07:24.532 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.443767547607422, 6.200070381164551, 5.357513904571533]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 146.29it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:04<00:00,  4.73s/it, est. speed input: 434.69 toks/s, output: 30.04 toks/s]
2025-11-24 03:07:29.268 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Thanh", "Thủy", "Thuỳ Vân", "Diễm", "Cường", "ông Sáu"], "organizations": ["Phòng Công chứng số 2", "Phòng Công chứng số 5", "Phòng Công chứng số 4", "Phòng Công chứng số 1"], "address": ["TP HCM", "đường Nguyễn Văn Nghi", "quân Gò Vấp", "khu phố 4", "phường Tân Chánh Hiệp", "quận 12", "phường Tây Thạnh", "quận Tân Phú", "phường 5", "Gò Vấp"]}
2025-11-24 03:07:29.268 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 25.88s
2025-11-24 03:07:29.268 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Diễm', 'ông Sáu', 'Vân', 'Thuỳ Vân', 'Thanh', 'Thủy', 'Cường'], 'organizations': ['Phòng Công chứng số 5', 'Phòng Công chứng số 4', 'Phòng Công chứng số 2', 'Phòng Công chứng số 1'], 'address': ['Gò Vấp', 'đường Nguyễn Văn Nghi', 'quân Gò Vấp', 'phường Tân Chánh Hiệp', 'quận 12', 'phường Tây Thạnh', 'khu phố 4', 'quận Tân Phú', 'TP HCM']}
2025-11-24 03:07:29.268 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Thanh', 'Thủy', 'Thuỳ Vân', 'Diễm', 'Cường', 'ông Sáu'], 'organizations': ['Phòng Công chứng số 2', 'Phòng Công chứng số 5', 'Phòng Công chứng số 4', 'Phòng Công chứng số 1'], 'address': ['TP HCM', 'đường Nguyễn Văn Nghi', 'quân Gò Vấp', 'khu phố 4', 'phường Tân Chánh Hiệp', 'quận 12', 'phường Tây Thạnh', 'quận Tân Phú', 'phường 5', 'Gò Vấp']}
Extracting entities:   3%|██▏                                                                     | 3/100 [00:43<26:22, 16.31s/it]2025-11-24 03:07:29.268 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 54.03it/s]
2025-11-24 03:07:29.290 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:07:33.281 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [10.777338027954102, -10.204425811767578, -11.453201293945312]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 406.19it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:00<00:00,  1.75it/s, est. speed input: 898.44 toks/s, output: 29.71 toks/s]
2025-11-24 03:07:33.856 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": [], "organizations": [], "address": ["Hà Nội"]}
2025-11-24 03:07:33.856 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 4.59s
2025-11-24 03:07:33.857 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': [], 'organizations': [], 'address': ['Hà Nội']}
2025-11-24 03:07:33.857 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': [], 'organizations': [], 'address': ['Hà Nội']}
Extracting entities:   4%|██▉                                                                     | 4/100 [00:47<18:41, 11.68s/it]2025-11-24 03:07:33.857 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 21.24it/s]
2025-11-24 03:07:33.908 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:07:53.752 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [7.725546836853027, -0.3684699535369873, -0.43328091502189636]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 233.86it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:03<00:00,  3.15s/it, est. speed input: 426.67 toks/s, output: 30.20 toks/s]
2025-11-24 03:07:56.902 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Vũ Nam Trung", "Đặng Minh Đạt"], "organizations": ["UBND phường 17", "UBND TP HCM", "UBND phường Đa Kao", "UBND thành phố", "phòng công chứng", "UBND quận 1"], "address": ["quận Bình Thạnh", "quận 1", "phường 17", "phường Đa Kao"]}
2025-11-24 03:07:56.902 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 23.05s
2025-11-24 03:07:56.902 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Đặng Minh Đạt', 'Vũ Nam Trung'], 'organizations': ['UBND phường 17', 'UBND TP HCM', 'UBND phường', 'phòng công chứng', 'UBND phường Đa Kao', 'UBND thành phố'], 'address': ['quận', 'huyện', 'quận 1', 'quận Bình Thạnh', 'thành phố']}
2025-11-24 03:07:56.902 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Vũ Nam Trung', 'Đặng Minh Đạt'], 'organizations': ['UBND phường 17', 'UBND TP HCM', 'UBND phường Đa Kao', 'UBND thành phố', 'phòng công chứng', 'UBND quận 1'], 'address': ['quận Bình Thạnh', 'quận 1', 'phường 17', 'phường Đa Kao']}
Extracting entities:   5%|███▌                                                                    | 5/100 [01:10<24:59, 15.78s/it]2025-11-24 03:07:56.903 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.07it/s]
2025-11-24 03:07:56.962 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:08:16.120 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.446465492248535, 0.6632437705993652, 0.5221642255783081]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 191.49it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:04<00:00,  4.19s/it, est. speed input: 385.27 toks/s, output: 30.08 toks/s]
2025-11-24 03:08:20.315 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Nguyễn Văn Cường", "Nguyễn Văn Lang"], "organizations": ["Viettravel", "Saigontourist", "Exotissimo Travel Việt Nam", "Exotissimo", "Công ty Mỹ Hà", "Thái Dương", "Việt Âu", "Cửu Long", "công ty Dịch vụ Lữ hành Saigontourist"], "address": ["Đà Lạt", "Nha Trang", "Phan Thiết", "Phú Quốc", "TP HCM", "Tây Ban Nha", "Italy"]}
2025-11-24 03:08:20.315 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 23.41s
2025-11-24 03:08:20.316 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Nguyễn Văn Cường', 'Nguyễn Văn Lang'], 'organizations': ['Viettravel', 'Saigontourist', 'Exotissimo Travel Việt Nam', 'Việt Âu', 'Thái Dương', 'Công ty Mỹ Hà', 'Exotissimo', 'công ty Dịch vụ Lữ hành Saigontourist', 'Cửu Long'], 'address': ['Đà Lạt', 'Phú Quốc', 'Nha Trang', 'Italy', 'Phan Thiết', 'Tây Ban Nha', 'TP HCM', 'Nha Trang - Đà Lạt']}
2025-11-24 03:08:20.316 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Nguyễn Văn Cường', 'Nguyễn Văn Lang'], 'organizations': ['Viettravel', 'Saigontourist', 'Exotissimo Travel Việt Nam', 'Exotissimo', 'Công ty Mỹ Hà', 'Thái Dương', 'Việt Âu', 'Cửu Long', 'công ty Dịch vụ Lữ hành Saigontourist'], 'address': ['Đà Lạt', 'Nha Trang', 'Phan Thiết', 'Phú Quốc', 'TP HCM', 'Tây Ban Nha', 'Italy']}
Extracting entities:   6%|████▎                                                                   | 6/100 [01:34<28:47, 18.38s/it]2025-11-24 03:08:20.316 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.10it/s]
2025-11-24 03:08:20.372 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:08:40.292 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.280550956726074, -3.014472484588623, -3.8912389278411865]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 207.92it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.44s/it, est. speed input: 568.00 toks/s, output: 29.98 toks/s]
2025-11-24 03:08:42.733 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Vũ Hiền"], "organizations": ["Hội nhà báo Việt Nam", "Ban chấp hành Hội nhà báo Việt Nam", "Liên chi hội", "Hội nhà báo cơ sở", "Đảng Cộng sản Việt Nam"], "address": ["Hội trường Ba Đình", "Hà Nội", "Việt Nam"]}
2025-11-24 03:08:42.733 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 22.42s
2025-11-24 03:08:42.733 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Vũ Hiền'], 'organizations': ['Ban chấp hành Hội nhà báo Việt Nam', 'Hội nhà báo cơ sở', 'Liên chi hội', 'Ban chấp hành', 'Ban chấp hành Hội Nhà Báo Việt Nam', 'Đảng Cộng sản Việt Nam', 'Hội nhà báo Việt Nam', 'Hội Nhà báo Việt Nam'], 'address': ['Hội trường Ba Đình', 'Hà Nội', 'Việt Nam']}
2025-11-24 03:08:42.733 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Vũ Hiền'], 'organizations': ['Hội nhà báo Việt Nam', 'Ban chấp hành Hội nhà báo Việt Nam', 'Liên chi hội', 'Hội nhà báo cơ sở', 'Đảng Cộng sản Việt Nam'], 'address': ['Hội trường Ba Đình', 'Hà Nội', 'Việt Nam']}
Extracting entities:   7%|█████                                                                   | 7/100 [01:56<30:31, 19.70s/it]2025-11-24 03:08:42.733 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 33.26it/s]
2025-11-24 03:08:42.767 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:08:51.515 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [7.713641166687012, -4.199095726013184, -5.169923782348633]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 294.32it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.60s/it, est. speed input: 332.02 toks/s, output: 30.78 toks/s]
2025-11-24 03:08:54.119 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Alan Wheatley", "Janine Murray"], "organizations": ["Informatics Centre School of Computing, Technology", "Khoa Máy tính và Công nghệ thông tin, ĐH Sunderland", "Wellstream International Ltd"], "address": ["UK", "St Peter's Way", "Sunderland, Tyne Wear", "SR6 0DD", "Anh"]}
2025-11-24 03:08:54.119 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 11.39s
2025-11-24 03:08:54.119 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Alan Wheatley', 'Janine Murray'], 'organizations': ['Informatics Centre School of Computing, Technology', 'Khoa Máy tính và Công nghệ thông tin, ĐH Sunderland', 'Wellstream International Ltd'], 'address': ['UK', "St Peter's Way", 'Anh', 'Sunderland, Tyne Wear']}
2025-11-24 03:08:54.119 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Alan Wheatley', 'Janine Murray'], 'organizations': ['Informatics Centre School of Computing, Technology', 'Khoa Máy tính và Công nghệ thông tin, ĐH Sunderland', 'Wellstream International Ltd'], 'address': ['UK', "St Peter's Way", 'Sunderland, Tyne Wear', 'SR6 0DD', 'Anh']}
Extracting entities:   8%|█████▊                                                                  | 8/100 [02:08<26:08, 17.05s/it]2025-11-24 03:08:54.119 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 14.21it/s]
2025-11-24 03:08:54.194 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:09:15.017 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [6.028903007507324, -3.682222843170166, -4.296947002410889]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 185.39it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:03<00:00,  3.04s/it, est. speed input: 577.72 toks/s, output: 29.94 toks/s]
2025-11-24 03:09:18.063 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Bình", "Anh Bình", "chị Loan", "chị Minh", "anh Quang", "bà Mình"], "organizations": ["Bộ Nông nghiệp Phát triển nông thôn", "UBND", "cơ quan thú y", "phường"], "address": ["Ngô Tất Tố", "Hà Nội", "chợ Hàng Da", "vùng ngoại thành"]}
2025-11-24 03:09:18.063 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 23.94s
2025-11-24 03:09:18.063 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Chị Minh', 'Loan', 'bà Mình', 'Bình', 'Anh Bình', 'anh Bình', 'Chị Loan', 'chị Loan', 'Anh Quang'], 'organizations': ['phường', 'nhà nước', 'cơ quan chức năng', 'UBND', 'Bộ Nông nghiệp Phát triển nông thôn'], 'address': ['Ngô Tất Tố', 'Hà Nội', 'thành phố', 'chợ', 'chợ Hàng Da', 'vùng ngoại thành']}
2025-11-24 03:09:18.063 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Bình', 'Anh Bình', 'chị Loan', 'chị Minh', 'anh Quang', 'bà Mình'], 'organizations': ['Bộ Nông nghiệp Phát triển nông thôn', 'UBND', 'cơ quan thú y', 'phường'], 'address': ['Ngô Tất Tố', 'Hà Nội', 'chợ Hàng Da', 'vùng ngoại thành']}
Extracting entities:   9%|██████▍                                                                 | 9/100 [02:32<29:07, 19.21s/it]2025-11-24 03:09:18.064 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 35.13it/s]
2025-11-24 03:09:18.095 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:09:26.649 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.445937156677246, 0.025468256324529648, -0.02749972976744175]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 328.91it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.35s/it, est. speed input: 370.03 toks/s, output: 30.27 toks/s]
2025-11-24 03:09:28.999 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Nguyễn Hữu Quế"], "organizations": ["VnExpress", "Công ty Quản lý đường sắt Bình Trị Thiên"], "address": ["đường sắt Bắc - Nam", "Lăng Cô", "Hà Nội", "thành phố Huế", "TP HCM", "ga Huế"]}
2025-11-24 03:09:28.999 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 10.94s
2025-11-24 03:09:28.999 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Nguyễn Hữu Quế'], 'organizations': ['VnExpress', 'Công ty Quản lý đường sắt Bình Trị Thiên'], 'address': ['đường sắt Bắc - Nam', 'Lăng Cô', 'Hà Nội', 'thành phố Huế', 'TP HCM', 'ga Huế']}
2025-11-24 03:09:28.999 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Nguyễn Hữu Quế'], 'organizations': ['VnExpress', 'Công ty Quản lý đường sắt Bình Trị Thiên'], 'address': ['đường sắt Bắc - Nam', 'Lăng Cô', 'Hà Nội', 'thành phố Huế', 'TP HCM', 'ga Huế']}
Extracting entities:  10%|███████                                                                | 10/100 [02:43<24:58, 16.65s/it]2025-11-24 03:09:28.999 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 37.50it/s]
2025-11-24 03:09:29.030 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:09:34.942 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.444969177246094, 1.31251859664917, 0.4624277651309967]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 297.55it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.36s/it, est. speed input: 380.34 toks/s, output: 30.46 toks/s]
2025-11-24 03:09:37.310 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Lê Huy Ngọ", "Cao Đức Phát", "Lã Thị Kim Oanh"], "organizations": ["Bộ Nông nghiệp và Phát triển nông thôn", "Chính phủ", "Quốc hội", "ban chỉ đạo phòng chống lụt bão trung ương"], "address": []}
2025-11-24 03:09:37.310 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 8.31s
2025-11-24 03:09:37.310 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Cao Đức Phát', 'Lê Huy Ngọ', 'Lã Thị Kim Oanh'], 'organizations': ['Nhà nước', 'Quốc hội', 'Chính phủ', 'ban chỉ đạo phòng chống lụt bão trung ương', 'Bộ Nông nghiệp và Phát triển nông thôn', 'Đảng'], 'address': []}
2025-11-24 03:09:37.310 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Lê Huy Ngọ', 'Cao Đức Phát', 'Lã Thị Kim Oanh'], 'organizations': ['Bộ Nông nghiệp và Phát triển nông thôn', 'Chính phủ', 'Quốc hội', 'ban chỉ đạo phòng chống lụt bão trung ương'], 'address': []}
Extracting entities:  11%|███████▊                                                               | 11/100 [02:51<20:54, 14.10s/it]2025-11-24 03:09:37.310 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 37.42it/s]
2025-11-24 03:09:37.341 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:09:43.421 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [8.710851669311523, 3.462503671646118, 3.1221137046813965]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 342.90it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.57s/it, est. speed input: 313.38 toks/s, output: 30.79 toks/s]
2025-11-24 03:09:45.990 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Lê Truyền"], "organizations": ["Ủy ban Trung ương MTTQ VN", "Mặt trận Trung ương", "Ban Vận động “Ngày vì người nghèo” Trung ương", "Quỹ “Vì người nghèo”"], "address": ["TPHCM", "miền Nam", "cả nước"]}
2025-11-24 03:09:45.990 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 8.68s
2025-11-24 03:09:45.990 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Lê Truyền'], 'organizations': ['Mặt trận Trung ương', 'Ban Vận động “Ngày vì người nghèo” Trung ương', 'Quỹ “Vì người nghèo”', 'Ủy ban Trung ương MTTQ VN'], 'address': ['miền Nam', 'cả nước', 'TPHCM']}
2025-11-24 03:09:45.990 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Lê Truyền'], 'organizations': ['Ủy ban Trung ương MTTQ VN', 'Mặt trận Trung ương', 'Ban Vận động “Ngày vì người nghèo” Trung ương', 'Quỹ “Vì người nghèo”'], 'address': ['TPHCM', 'miền Nam', 'cả nước']}
Extracting entities:  12%|████████▌                                                              | 12/100 [02:59<18:15, 12.45s/it]2025-11-24 03:09:45.990 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 30.60it/s]
2025-11-24 03:09:46.027 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:09:57.885 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [9.723271369934082, -5.762029647827148, -6.1055145263671875]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 309.22it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:03<00:00,  3.01s/it, est. speed input: 315.72 toks/s, output: 30.91 toks/s]
2025-11-24 03:10:00.898 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Caroline"], "organizations": ["Quỹ Cathalyst", "mái ấm Tam Bình", "trường tiểu học Đa Lợi", "công ty Little Red", "Hội bảo trợ trẻ em thành phố", "Hội bảo trợ trẻ em TP HCM"], "address": ["Đà Lạt", "Nha Trang", "Mỹ", "Việt Nam", "TP HCM"]}
2025-11-24 03:10:00.899 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 14.91s
2025-11-24 03:10:00.899 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Caroline'], 'organizations': ['Quỹ Cathalyst', 'mái ấm Tam Bình', 'trường tiểu học Đa Lợi', 'công ty Little Red', 'Hội bảo trợ trẻ em thành phố', 'Hội bảo trợ trẻ em TP HCM'], 'address': ['Đà Lạt', 'Nha Trang', 'Mỹ', 'Việt Nam', 'TP HCM']}
2025-11-24 03:10:00.899 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Caroline'], 'organizations': ['Quỹ Cathalyst', 'mái ấm Tam Bình', 'trường tiểu học Đa Lợi', 'công ty Little Red', 'Hội bảo trợ trẻ em thành phố', 'Hội bảo trợ trẻ em TP HCM'], 'address': ['Đà Lạt', 'Nha Trang', 'Mỹ', 'Việt Nam', 'TP HCM']}
Extracting entities:  13%|█████████▏                                                             | 13/100 [03:14<19:08, 13.20s/it]2025-11-24 03:10:00.899 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 30.64it/s]
2025-11-24 03:10:00.935 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:10:13.135 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [8.371672630310059, 2.9106757640838623, 2.841310501098633]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 250.12it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:06<00:00,  6.04s/it, est. speed input: 212.21 toks/s, output: 30.62 toks/s]
2025-11-24 03:10:19.181 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": [], "organizations": ["Cty Dịch vụ Lữ hành Saigontourist", "Hội chợ AIME", "MDIS"], "address": ["hồ Taupo", "Công viên Thú hoang dã", "vịnh Sydney", "Cầu Cảng Sydney", "Vườn Fitzroy", "bảo tàng Te Papa", "nhà Hát Con Sò", "Sydney", "Ballarat", "Melbourne", "Wellington", "Auckland", "khu bảo tồn Te Whakarewarewa", "châu Úc", "49 Lê Thánh Tôn - Quận 1", "Wellington", "núi lửa Eden", "Sky Tower", "Úc", "New Zealand", "Thiên Đàng Thung Lũng Mùa Xuân", "Sở thú Taronga"]}
2025-11-24 03:10:19.181 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 18.28s
2025-11-24 03:10:19.181 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Cook'], 'organizations': ['Cty Dịch vụ Lữ hành Saigontourist', 'Hội chợ AIME'], 'address': ['hồ Taupo', 'Công viên Thú hoang dã', 'vịnh Sydney', 'Cầu Cảng Sydney', 'Vườn Fitzroy', 'bảo tàng Te Papa', 'nhà Hát Con Sò', 'Sydney', 'Ballarat', 'Melbourne', 'Auckland', 'khu bảo tồn Te Whakarewarewa', 'châu Úc', '49 Lê Thánh Tôn - Quận 1', 'Wellington', 'núi lửa Eden', 'Sky Tower', 'Úc', 'New Zealand', 'Thiên Đàng Thung Lũng Mùa Xuân', 'Sở thú Taronga']}
2025-11-24 03:10:19.181 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': [], 'organizations': ['Cty Dịch vụ Lữ hành Saigontourist', 'Hội chợ AIME', 'MDIS'], 'address': ['hồ Taupo', 'Công viên Thú hoang dã', 'vịnh Sydney', 'Cầu Cảng Sydney', 'Vườn Fitzroy', 'bảo tàng Te Papa', 'nhà Hát Con Sò', 'Sydney', 'Ballarat', 'Melbourne', 'Wellington', 'Auckland', 'khu bảo tồn Te Whakarewarewa', 'châu Úc', '49 Lê Thánh Tôn - Quận 1', 'Wellington', 'núi lửa Eden', 'Sky Tower', 'Úc', 'New Zealand', 'Thiên Đàng Thung Lũng Mùa Xuân', 'Sở thú Taronga']}
Extracting entities:  14%|█████████▉                                                             | 14/100 [03:33<21:06, 14.73s/it]2025-11-24 03:10:19.181 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 42.78it/s]
2025-11-24 03:10:19.209 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:10:24.586 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [7.46185302734375, -5.710604190826416, -5.852278232574463]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 339.70it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.08s/it, est. speed input: 371.78 toks/s, output: 30.82 toks/s]
2025-11-24 03:10:26.666 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": [], "organizations": ["Cơ quan chức năng địa phương", "ngành chức năng địa phương"], "address": ["xã Đông Hải", "huyện Duyên Hải", "xã An Quãng Hữu", "huyện Trà Cú", "Trà Vinh"]}
2025-11-24 03:10:26.666 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 7.48s
2025-11-24 03:10:26.666 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': [], 'organizations': ['Cơ quan chức năng địa phương', 'ngành chức năng địa phương', 'ngành chức năng'], 'address': ['xã An Quãng Hữu', 'huyện Duyên Hải', 'huyện Trà Cú', 'xã Đông Hải', 'Trà Vinh']}
2025-11-24 03:10:26.666 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': [], 'organizations': ['Cơ quan chức năng địa phương', 'ngành chức năng địa phương'], 'address': ['xã Đông Hải', 'huyện Duyên Hải', 'xã An Quãng Hữu', 'huyện Trà Cú', 'Trà Vinh']}
Extracting entities:  15%|██████████▋                                                            | 15/100 [03:40<17:46, 12.55s/it]2025-11-24 03:10:26.666 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 27.55it/s]
2025-11-24 03:10:26.706 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:10:42.493 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.30787181854248, 2.902984857559204, 1.9261208772659302]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 241.55it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:03<00:00,  3.08s/it, est. speed input: 383.91 toks/s, output: 30.21 toks/s]
2025-11-24 03:10:45.577 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Nguyễn Đình Liêu"], "organizations": ["Quỹ hỗ trợ việc làm", "Quỹ quốc gia hỗ trợ việc làm", "Bộ Lao động Thương binh và Xã hội"], "address": ["ven biển miền Trung", "đồng bằng Bắc Bộ", "miền núi phía Bắc", "đồng bằng sông Cửu Long", "Tây Nguyên", "trung du Bắc Bộ"]}
2025-11-24 03:10:45.577 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 18.91s
2025-11-24 03:10:45.577 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Nguyễn Đình Liêu'], 'organizations': ['Bộ Lao động Thương binh và Xã hội', 'Quỹ quốc gia hỗ trợ việc làm', 'Quỹ hỗ trợ việc làm'], 'address': ['ven biển miền Trung', 'đồng bằng Bắc Bộ', 'miền núi phía Bắc', 'đồng bằng sông Cửu Long', 'Tây Nguyên', 'trung du Bắc Bộ']}
2025-11-24 03:10:45.577 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Nguyễn Đình Liêu'], 'organizations': ['Quỹ hỗ trợ việc làm', 'Quỹ quốc gia hỗ trợ việc làm', 'Bộ Lao động Thương binh và Xã hội'], 'address': ['ven biển miền Trung', 'đồng bằng Bắc Bộ', 'miền núi phía Bắc', 'đồng bằng sông Cửu Long', 'Tây Nguyên', 'trung du Bắc Bộ']}
Extracting entities:  16%|███████████▎                                                           | 16/100 [03:59<20:14, 14.46s/it]2025-11-24 03:10:45.578 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 35.70it/s]
2025-11-24 03:10:45.609 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:10:52.579 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [10.646137237548828, -5.161355972290039, -5.605935573577881]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 322.39it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:01<00:00,  1.54s/it, est. speed input: 521.20 toks/s, output: 30.58 toks/s]
2025-11-24 03:10:54.120 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Ngô Trần Ái"], "organizations": ["Nhà Xuất bản Giáo dục", "Hội nghệ sĩ Nhiếp ảnh Việt Nam", "Báo Giáo dục Thời đại"], "address": []}
2025-11-24 03:10:54.120 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 8.54s
2025-11-24 03:10:54.120 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Ngô Trần Ái'], 'organizations': ['Báo Giáo dục Thời đại', 'Hội nghệ sĩ Nhiếp ảnh Việt Nam', 'Nhà Xuất bản Giáo dục', 'Nhà xuất bản Giáo dục'], 'address': []}
2025-11-24 03:10:54.120 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Ngô Trần Ái'], 'organizations': ['Nhà Xuất bản Giáo dục', 'Hội nghệ sĩ Nhiếp ảnh Việt Nam', 'Báo Giáo dục Thời đại'], 'address': []}
Extracting entities:  17%|████████████                                                           | 17/100 [04:08<17:32, 12.68s/it]2025-11-24 03:10:54.120 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 33.08it/s]
2025-11-24 03:10:54.154 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:11:04.825 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.317793846130371, -1.293180227279663, -2.634873151779175]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 323.19it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.76s/it, est. speed input: 339.95 toks/s, output: 30.81 toks/s]
2025-11-24 03:11:07.588 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Nguyễn Văn Lạng", "M.Mc Goun"], "organizations": ["Văn phòng đại diện Hội thánh Tin lành Đăk Lăk", "UBND tỉnh", "Tòa giám mục Buôn Ma Thuột"], "address": ["Đăk Lăk", "New Zealand", "Canada", "Na Uy", "Thụy Sĩ"]}
2025-11-24 03:11:07.588 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 13.47s
2025-11-24 03:11:07.589 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Nguyễn Văn Lạng', 'M.Mc Goun'], 'organizations': ['Văn phòng đại diện Hội thánh Tin lành Đăk Lăk', 'UBND tỉnh', 'Tòa giám mục Buôn Ma Thuột'], 'address': ['Đăk Lăk', 'New Zealand', 'Canada', 'Na Uy', 'Thụy Sĩ']}
2025-11-24 03:11:07.589 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Nguyễn Văn Lạng', 'M.Mc Goun'], 'organizations': ['Văn phòng đại diện Hội thánh Tin lành Đăk Lăk', 'UBND tỉnh', 'Tòa giám mục Buôn Ma Thuột'], 'address': ['Đăk Lăk', 'New Zealand', 'Canada', 'Na Uy', 'Thụy Sĩ']}
Extracting entities:  18%|████████████▊                                                          | 18/100 [04:21<17:39, 12.92s/it]2025-11-24 03:11:07.589 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 15.33it/s]
2025-11-24 03:11:07.658 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:11:27.886 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [10.654659271240234, 5.0666399002075195, 4.876796245574951]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 188.84it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:04<00:00,  4.01s/it, est. speed input: 426.02 toks/s, output: 29.91 toks/s]
2025-11-24 03:11:31.904 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Bùi Bá Bổng", "Nguyễn Tấn Dũng", "Thành Vinh"], "organizations": ["Ban chỉ đạo Quốc gia phòng chống dịch cúm gà", "VnExpress", "UBND các tỉnh, thành phố", "Cục Thú y", "Bộ Y tế", "Bộ Công an", "OIE"], "address": ["Hà Nội", "TP HCM", "Bình Dương", "56/64 tỉnh, thành", "các huyện thị", "các địa phương"]}
2025-11-24 03:11:31.904 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 24.32s
2025-11-24 03:11:31.904 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Bùi Bá Bổng', 'Nguyễn Tấn Dũng', 'Thành Vinh'], 'organizations': ['Ban chỉ đạo Quốc gia phòng chống dịch cúm gà', 'OIE', 'Bộ Công an', 'VnExpress', 'UBND', 'Chính phủ', 'Bộ Y tế', 'Cục Thú y'], 'address': ['Hà Nội', 'TP HCM', 'Bình Dương', 'Việt Nam']}
2025-11-24 03:11:31.904 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Bùi Bá Bổng', 'Nguyễn Tấn Dũng', 'Thành Vinh'], 'organizations': ['Ban chỉ đạo Quốc gia phòng chống dịch cúm gà', 'VnExpress', 'UBND các tỉnh, thành phố', 'Cục Thú y', 'Bộ Y tế', 'Bộ Công an', 'OIE'], 'address': ['Hà Nội', 'TP HCM', 'Bình Dương', '56/64 tỉnh, thành', 'các huyện thị', 'các địa phương']}
Extracting entities:  19%|█████████████▍                                                         | 19/100 [04:45<22:03, 16.34s/it]2025-11-24 03:11:31.904 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 16.25it/s]
2025-11-24 03:11:31.969 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:11:52.418 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.446099281311035, 8.779979705810547, 6.802016258239746]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 191.13it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:04<00:00,  4.86s/it, est. speed input: 401.71 toks/s, output: 29.84 toks/s]
2025-11-24 03:11:57.284 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Nguyễn Kim Thanh", "Nguyễn Phương Mai"], "organizations": ["Hương Giang", "Sở Du lịch", "Du lịch Việt Nam tại Hà Nội", "Thuận Hóa", "Saigontourist", "Vietravel", "khách sạn Morin", "UBND thành phố Huế", "Khách sạn Hương Giang", "Century"], "address": ["Đà Nẵng", "Việt Nam", "Hà Nội", "cố đô", "Bồ Đào Nha", "quảng trường Ngọ Môn", "châu Mỹ", "châu Âu", "Hội An", "Huế"]}
2025-11-24 03:11:57.284 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 25.38s
2025-11-24 03:11:57.284 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Nguyễn Kim Thanh', 'Nguyễn Phương Mai'], 'organizations': ['Hương Giang', 'Sở Du lịch', 'Du lịch Việt Nam tại Hà Nội', 'Thuận Hóa', 'Saigontourist', 'Vietravel', 'khách sạn Morin', 'UBND thành phố Huế', 'Khách sạn Hương Giang', 'Century'], 'address': ['Đà Nẵng', 'Việt Nam', 'Hà Nội', 'cố đô', 'Bồ Đào Nha', 'quảng trường Ngọ Môn', 'châu Mỹ', 'châu Âu', 'Hội An', 'Huế']}
2025-11-24 03:11:57.284 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Nguyễn Kim Thanh', 'Nguyễn Phương Mai'], 'organizations': ['Hương Giang', 'Sở Du lịch', 'Du lịch Việt Nam tại Hà Nội', 'Thuận Hóa', 'Saigontourist', 'Vietravel', 'khách sạn Morin', 'UBND thành phố Huế', 'Khách sạn Hương Giang', 'Century'], 'address': ['Đà Nẵng', 'Việt Nam', 'Hà Nội', 'cố đô', 'Bồ Đào Nha', 'quảng trường Ngọ Môn', 'châu Mỹ', 'châu Âu', 'Hội An', 'Huế']}
Extracting entities:  20%|██████████████▏                                                        | 20/100 [05:11<25:24, 19.06s/it]2025-11-24 03:11:57.284 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 22.98it/s]
2025-11-24 03:11:57.331 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:12:12.098 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.437315940856934, -0.3164212703704834, -0.6200264692306519]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 253.29it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.58s/it, est. speed input: 492.99 toks/s, output: 29.89 toks/s]
2025-11-24 03:12:14.679 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Phạm Thế Hiển", "Tô Hiến Thành", "Nguyễn Duy", "Nguyễn Xuân Bảng"], "organizations": ["Sở Giao thông công chính TP HCM", "VnExperss"], "address": ["TP HCM", "Tô Hiến Thành", "Nguyễn Duy"]}
2025-11-24 03:12:14.679 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 17.39s
2025-11-24 03:12:14.679 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Bảng', 'Nguyễn Xuân Bảng'], 'organizations': ['VnExperss', 'Sở Giao thông công chính TP HCM'], 'address': ['TP HCM', 'Tô Hiến Thành', 'Phạm Thế Hiển', 'Nguyễn Duy']}
2025-11-24 03:12:14.679 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Phạm Thế Hiển', 'Tô Hiến Thành', 'Nguyễn Duy', 'Nguyễn Xuân Bảng'], 'organizations': ['Sở Giao thông công chính TP HCM', 'VnExperss'], 'address': ['TP HCM', 'Tô Hiến Thành', 'Nguyễn Duy']}
Extracting entities:  21%|██████████████▉                                                        | 21/100 [05:28<24:25, 18.56s/it]2025-11-24 03:12:14.679 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 26.41it/s]
2025-11-24 03:12:14.721 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:12:27.590 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.44633960723877, -0.8028769493103027, -1.2547357082366943]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 280.26it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.89s/it, est. speed input: 411.88 toks/s, output: 30.09 toks/s]
2025-11-24 03:12:30.486 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Nguyễn Hữu Hải"], "organizations": ["Trung tâm Dự báo khí tượng thuỷ văn"], "address": ["Nho Quan", "Ninh Bình", "Sơn Tây", "Hà Tây", "Hà Nội", "Hưng Yên", "Nam Định", "Bắc Ninh", "Vĩnh Yên", "Tĩnh Gia", "Thanh Hoá"]}
2025-11-24 03:12:30.487 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 15.81s
2025-11-24 03:12:30.487 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Hải', 'Nguyễn Hữu Hải'], 'organizations': ['Trung tâm Dự báo khí tượng thuỷ văn'], 'address': ['Nam Định', 'Bắc Ninh', 'Hưng Yên', 'Thanh Hoá', 'Hà Nội', 'Vĩnh Yên', 'Trung du Bắc Bộ', 'Ninh Bình', 'Hà Tây', 'Tĩnh Gia', 'Sơn Tây', 'Bắc Bộ', 'Nho Quan', 'Bắc và Trung Trung Bộ']}
2025-11-24 03:12:30.487 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Nguyễn Hữu Hải'], 'organizations': ['Trung tâm Dự báo khí tượng thuỷ văn'], 'address': ['Nho Quan', 'Ninh Bình', 'Sơn Tây', 'Hà Tây', 'Hà Nội', 'Hưng Yên', 'Nam Định', 'Bắc Ninh', 'Vĩnh Yên', 'Tĩnh Gia', 'Thanh Hoá']}
Extracting entities:  22%|███████████████▌                                                       | 22/100 [05:44<23:03, 17.73s/it]2025-11-24 03:12:30.487 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.43it/s]
2025-11-24 03:12:30.542 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:12:51.450 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [6.924880027770996, -2.900266408920288, -4.225613117218018]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 212.50it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:03<00:00,  3.04s/it, est. speed input: 509.72 toks/s, output: 29.62 toks/s]
2025-11-24 03:12:54.495 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Võ Văn Cương"], "organizations": ["HĐND TP HCM", "HĐND", "Ủy ban Mặt trận Tổ quốc TP HCM", "Hội đồng bầu cử TP HCM", "Ủy ban Mặt trận Tổ quốc Việt Nam", "UBND"], "address": ["TP HCM", "Nhà Bè", "Cần Giờ", "quận 7"]}
2025-11-24 03:12:54.495 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 24.01s
2025-11-24 03:12:54.495 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Võ Văn Cương'], 'organizations': ['HĐND TP HCM', 'HĐND', 'Ủy ban Mặt trận Tổ quốc TP HCM', 'Hội đồng bầu cử', 'UBND', 'Uỷ ban Mặt trận Tổ quốc', 'Hội đồng bầu cử TP HCM', 'Ủy ban Mặt trận Tổ quốc Việt Nam'], 'address': ['TP HCM', 'Nhà Bè', 'quận 7', 'Cần Giờ']}
2025-11-24 03:12:54.495 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Võ Văn Cương'], 'organizations': ['HĐND TP HCM', 'HĐND', 'Ủy ban Mặt trận Tổ quốc TP HCM', 'Hội đồng bầu cử TP HCM', 'Ủy ban Mặt trận Tổ quốc Việt Nam', 'UBND'], 'address': ['TP HCM', 'Nhà Bè', 'Cần Giờ', 'quận 7']}
Extracting entities:  23%|████████████████▎                                                      | 23/100 [06:08<25:10, 19.62s/it]2025-11-24 03:12:54.495 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 25.72it/s]
2025-11-24 03:12:54.538 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:13:13.048 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.255654335021973, -3.3695828914642334, -3.7247889041900635]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 275.16it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:04<00:00,  4.79s/it, est. speed input: 268.94 toks/s, output: 30.67 toks/s]
2025-11-24 03:13:17.845 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Hoàng Chí Trung", "Lê Quốc Dũng", "Bùi Nhật Thắng", "Hoa"], "organizations": ["Đội Quản lý thị trường số 1", "Đội Quản lý thị trường số 2", "lực lượng cảnh sát hình sự quận Hoàn Kiếm", "thanh tra ngành bưu điện", "Bưu điện Hà Nội"], "address": ["bến xe Long Biên", "chợ Đồng Xuân", "đường Yên Phụ", "Hà Nội", "quận Hoàn Kiếm", "Hải Phòng", "Quảng Ninh", "số nhà 12, Đồng Xuân", "Trung Quốc"]}
2025-11-24 03:13:17.846 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 23.35s
2025-11-24 03:13:17.846 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Lê Quốc Dũng', 'Hoàng Chí Trung', 'Hoa', 'Bùi Nhật Thắng'], 'organizations': ['Đội Quản lý thị trường số 1', 'Đội Quản lý thị trường số 2', 'lực lượng cảnh sát hình sự quận Hoàn Kiếm'], 'address': ['bến xe Long Biên', 'đường Yên Phụ', 'Hà Nội', 'chợ Đồng Xuân', 'Quảng Ninh', 'Trung Quốc', 'Hải Phòng', 'số nhà 12, Đồng Xuân']}
2025-11-24 03:13:17.846 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Hoàng Chí Trung', 'Lê Quốc Dũng', 'Bùi Nhật Thắng', 'Hoa'], 'organizations': ['Đội Quản lý thị trường số 1', 'Đội Quản lý thị trường số 2', 'lực lượng cảnh sát hình sự quận Hoàn Kiếm', 'thanh tra ngành bưu điện', 'Bưu điện Hà Nội'], 'address': ['bến xe Long Biên', 'chợ Đồng Xuân', 'đường Yên Phụ', 'Hà Nội', 'quận Hoàn Kiếm', 'Hải Phòng', 'Quảng Ninh', 'số nhà 12, Đồng Xuân', 'Trung Quốc']}
Extracting entities:  24%|█████████████████                                                      | 24/100 [06:31<26:15, 20.74s/it]2025-11-24 03:13:17.846 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.51it/s]
2025-11-24 03:13:17.901 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:13:36.206 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [9.574623107910156, -4.352860450744629, -4.627079486846924]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 231.74it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:04<00:00,  4.17s/it, est. speed input: 349.33 toks/s, output: 30.25 toks/s]
2025-11-24 03:13:40.377 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": [], "organizations": ["RV Centre Hà Nội", "rvgroup", "Đại học Buffalo", "fpt", "SIM", "ĐH Tổng hợp London", "Đại học SIM", "Polytechnic", "Học viện - Đại học SIM", "Đại học RMIT"], "address": ["Anh", "Mỹ", "úc", "RV Centre Hà Nội – 86 Phạm Ngọc Thạch, Quận Đống Đa, Tp Hà Nội", "86 Phạm Ngọc Thạch, Quận Đống Đa, Tp Hà Nội", "Singapore"]}
2025-11-24 03:13:40.377 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 22.53s
2025-11-24 03:13:40.377 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': [], 'organizations': ['RV Centre Hà Nội', 'rvgroup', 'Đại học Buffalo', 'fpt', 'SIM', 'ĐH Tổng hợp London', 'Đại học SIM', 'Polytechnic', 'Học viện - Đại học SIM', 'Đại học RMIT'], 'address': ['Anh', 'Mỹ', 'úc', 'RV Centre Hà Nội – 86 Phạm Ngọc Thạch, Quận Đống Đa, Tp Hà Nội', '86 Phạm Ngọc Thạch, Quận Đống Đa, Tp Hà Nội', 'Singapore']}
2025-11-24 03:13:40.377 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': [], 'organizations': ['RV Centre Hà Nội', 'rvgroup', 'Đại học Buffalo', 'fpt', 'SIM', 'ĐH Tổng hợp London', 'Đại học SIM', 'Polytechnic', 'Học viện - Đại học SIM', 'Đại học RMIT'], 'address': ['Anh', 'Mỹ', 'úc', 'RV Centre Hà Nội – 86 Phạm Ngọc Thạch, Quận Đống Đa, Tp Hà Nội', '86 Phạm Ngọc Thạch, Quận Đống Đa, Tp Hà Nội', 'Singapore']}
Extracting entities:  25%|█████████████████▊                                                     | 25/100 [06:54<26:35, 21.27s/it]2025-11-24 03:13:40.377 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 29.00it/s]
2025-11-24 03:13:40.415 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:13:52.125 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [9.70499324798584, 4.639079570770264, 4.399440288543701]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 279.99it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:03<00:00,  3.07s/it, est. speed input: 315.11 toks/s, output: 30.63 toks/s]
2025-11-24 03:13:55.198 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Đỗ Hoàng Ân"], "organizations": ["UBND thành phố", "Sở Quy hoạch kiến trúc Hà Nội"], "address": ["Thăng Long Hà Nội", "Việt Nam", "Hà Nội", "Cửa ô phía nam", "thủ đô", "Đài Chiến thắng", "24 ha", "khu vực phía nam thành phố", "Sở Quy hoạch kiến trúc Hà Nội"]}
2025-11-24 03:13:55.198 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 14.82s
2025-11-24 03:13:55.198 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Đỗ Hoàng Ân'], 'organizations': ['Sở Quy hoạch kiến trúc Hà Nội', 'UBND thành phố'], 'address': ['Thăng Long Hà Nội', 'Việt Nam', 'Hà Nội', 'Cửa ô phía nam', 'thủ đô', 'Đài Chiến thắng', 'Cửa ô phía nam Hà Nội']}
2025-11-24 03:13:55.198 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Đỗ Hoàng Ân'], 'organizations': ['UBND thành phố', 'Sở Quy hoạch kiến trúc Hà Nội'], 'address': ['Thăng Long Hà Nội', 'Việt Nam', 'Hà Nội', 'Cửa ô phía nam', 'thủ đô', 'Đài Chiến thắng', '24 ha', 'khu vực phía nam thành phố', 'Sở Quy hoạch kiến trúc Hà Nội']}
Extracting entities:  26%|██████████████████▍                                                    | 26/100 [07:09<23:51, 19.34s/it]2025-11-24 03:13:55.198 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 42.35it/s]
2025-11-24 03:13:55.226 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:14:02.140 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [10.359622955322266, -2.8452556133270264, -4.308746337890625]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 307.84it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:01<00:00,  1.97s/it, est. speed input: 398.34 toks/s, output: 30.41 toks/s]
2025-11-24 03:14:04.118 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": [], "organizations": ["nhà Thanh"], "address": ["Nam Kinh", "Xuanwu", "Trung Quốc", "Kunlun", "Yến Sơn", "Jiefang", "thành phố Nam Kinh", "Kunning"]}
2025-11-24 03:14:04.118 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 8.92s
2025-11-24 03:14:04.118 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': [], 'organizations': ['nhà Thanh'], 'address': ['Nam Kinh', 'Xuanwu', 'Trung Quốc', 'Kunlun', 'Yến Sơn', 'Jiefang', 'thành phố Nam Kinh', 'Kunning']}
2025-11-24 03:14:04.118 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': [], 'organizations': ['nhà Thanh'], 'address': ['Nam Kinh', 'Xuanwu', 'Trung Quốc', 'Kunlun', 'Yến Sơn', 'Jiefang', 'thành phố Nam Kinh', 'Kunning']}
Extracting entities:  27%|███████████████████▏                                                   | 27/100 [07:18<19:43, 16.21s/it]2025-11-24 03:14:04.118 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 30.46it/s]
2025-11-24 03:14:04.155 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:14:15.631 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [7.795368194580078, 4.463919639587402, 4.2025980949401855]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 253.19it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:05<00:00,  5.99s/it, est. speed input: 192.97 toks/s, output: 30.74 toks/s]
2025-11-24 03:14:21.622 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Lê Công Minh", "Trần Quang Phượng"],"organizations": ["Cảng Sài Gòn", "Sở Kế hoạch Đầu tư", "Quy hoạch Kiến trúc", "GTCC", "Tài nguyên và Môi trường", "Sở Giao thông công chính TP HCM", "Sở Tài nguyên và môi trường TP HCM"],"address": ["Hiệp Phước", "Nhà Bè", "TP HCM", "Cái Mép", "Thị Vải", "Bà Rịa - Vũng Tàu", "Thủ Thiêm", "phường 22", "Bình Thạnh", "đường Tôn Đức Thắng", "cầu Bến Nghé", "Trần Não", "phường Tân Thuận Đông", "quận 7", "quận 2"]}
2025-11-24 03:14:21.622 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 17.50s
2025-11-24 03:14:21.622 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Trần Quang Phượng', 'Lê Công Minh'], 'organizations': ['bảo tàng hàng hải', 'GTCC', 'Tài nguyên và Môi trường', 'Sở Kế hoạch Đầu tư', 'Sở Giao thông công chính TP HCM', 'Cảng Sài Gòn', 'Sở Tài nguyên và môi trường TP HCM', 'Quy hoạch Kiến trúc'], 'address': ['Bình Thạnh', 'phường 22', 'cầu Bến Nghé', 'Bà Rịa - Vũng Tàu', 'Trần Não', 'phường Tân Thuận Đông', 'Thủ Thiêm', 'Thị Vải', 'cầu Tôn Đức Thắng', 'Nhà Bè', 'quận 2', 'quận 7', 'Cái Mép', 'TP HCM', 'đường Tôn Đức Thắng', 'Hiệp Phước']}
2025-11-24 03:14:21.622 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Lê Công Minh', 'Trần Quang Phượng'], 'organizations': ['Cảng Sài Gòn', 'Sở Kế hoạch Đầu tư', 'Quy hoạch Kiến trúc', 'GTCC', 'Tài nguyên và Môi trường', 'Sở Giao thông công chính TP HCM', 'Sở Tài nguyên và môi trường TP HCM'], 'address': ['Hiệp Phước', 'Nhà Bè', 'TP HCM', 'Cái Mép', 'Thị Vải', 'Bà Rịa - Vũng Tàu', 'Thủ Thiêm', 'phường 22', 'Bình Thạnh', 'đường Tôn Đức Thắng', 'cầu Bến Nghé', 'Trần Não', 'phường Tân Thuận Đông', 'quận 7', 'quận 2']}
Extracting entities:  28%|███████████████████▉                                                   | 28/100 [07:35<19:55, 16.60s/it]2025-11-24 03:14:21.622 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 15.42it/s]
2025-11-24 03:14:21.691 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:14:42.922 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.445219993591309, -8.461461067199707, -8.72092056274414]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 182.09it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.19s/it, est. speed input: 813.05 toks/s, output: 28.82 toks/s]
2025-11-24 03:14:45.114 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Hưng", "Trang", "Cẩm Thanh", "Việt Phong"], "organizations": ["Đại học UEA", "UEA"], "address": ["Norwich", "Anh quốc", "VN", "Trung Quốc", "châu Á"]}
2025-11-24 03:14:45.114 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 23.49s
2025-11-24 03:14:45.114 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Cẩm Thanh', 'Hưng', 'Việt Phong', 'Trang'], 'organizations': ['Đại học UEA', 'UEA'], 'address': ['Norwich', 'Anh', 'Anh quốc', 'VN', 'Trung Quốc', 'châu Á']}
2025-11-24 03:14:45.114 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Hưng', 'Trang', 'Cẩm Thanh', 'Việt Phong'], 'organizations': ['Đại học UEA', 'UEA'], 'address': ['Norwich', 'Anh quốc', 'VN', 'Trung Quốc', 'châu Á']}
Extracting entities:  29%|████████████████████▌                                                  | 29/100 [07:59<22:05, 18.67s/it]2025-11-24 03:14:45.115 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 35.20it/s]
2025-11-24 03:14:45.147 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:14:52.324 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [5.835649490356445, -4.377843379974365, -7.301952838897705]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 312.36it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:01<00:00,  1.48s/it, est. speed input: 635.89 toks/s, output: 29.70 toks/s]
2025-11-24 03:14:53.809 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": [], "organizations": ["Nhà nước", "NLĐ", "MTTQ tỉnh", "TTXVN", "Quỹ Vì người nghèo"], "address": ["Cà Mau"]}
2025-11-24 03:14:53.810 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 8.69s
2025-11-24 03:14:53.810 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': [], 'organizations': ['Nhà nước', 'NLĐ', 'MTTQ tỉnh', 'TTXVN'], 'address': ['Cà Mau']}
2025-11-24 03:14:53.810 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': [], 'organizations': ['Nhà nước', 'NLĐ', 'MTTQ tỉnh', 'TTXVN', 'Quỹ Vì người nghèo'], 'address': ['Cà Mau']}
Extracting entities:  30%|█████████████████████▎                                                 | 30/100 [08:07<18:17, 15.68s/it]2025-11-24 03:14:53.810 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 42.47it/s]
2025-11-24 03:14:53.837 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:14:59.373 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.360945701599121, -2.866513967514038, -3.8289132118225098]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 329.07it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:01<00:00,  1.37s/it, est. speed input: 555.54 toks/s, output: 29.93 toks/s]
2025-11-24 03:15:00.747 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": [], "organizations": [], "address": ["xã Yên Hợp", "huyện Quỳ Hợp", "Nghệ An", "Trại Bò"]}
2025-11-24 03:15:00.747 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 6.94s
2025-11-24 03:15:00.747 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': [], 'organizations': [], 'address': ['xã Yên Hợp', 'Nghệ An', 'huyện Quỳ Hợp', 'Trại Bò']}
2025-11-24 03:15:00.747 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': [], 'organizations': [], 'address': ['xã Yên Hợp', 'huyện Quỳ Hợp', 'Nghệ An', 'Trại Bò']}
Extracting entities:  31%|██████████████████████                                                 | 31/100 [08:14<15:00, 13.05s/it]2025-11-24 03:15:00.747 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.47it/s]
2025-11-24 03:15:00.802 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:15:16.425 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.431666374206543, 6.078625679016113, 0.4187454283237457]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 230.65it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:05<00:00,  5.82s/it, est. speed input: 279.31 toks/s, output: 30.40 toks/s]
2025-11-24 03:15:22.252 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Nguyễn Thị Thu", "chị Thảo", "Trương Quốc Hùng", "Nguyễn Văn Tưởng"], "organizations": ["Sở Du lịch thương mại Điện Biên", "Saigontourist", "Vietravel", "Đầu tư và xuất nhập khẩu Hồ Gươm", "Hà Nội Startour", "Tổng cục Du lịch", "Hương Thảo", "Mường Thanh", "Điện Biên 21"], "address": ["Điện Biên Phủ", "Việt Nam", "Hà Nội", "Điện Biên", "phía Tây", "500 km", "cánh đồng bằng phẳng", "thành phố Điện Biên Phủ", "các bản văn hoá ngoại vi thành phố Điện Biên Phủ"]}
2025-11-24 03:15:22.252 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 21.50s
2025-11-24 03:15:22.252 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Nguyễn Văn Tưởng', 'Thảo', 'Trương Quốc Hùng', 'Nguyễn Thị Thu'], 'organizations': ['Sở Du lịch thương mại Điện Biên', 'Saigontourist', 'Đầu tư và xuất nhập khẩu Hồ Gươm', 'Điện Biên', 'Vietravel', 'Startour', 'Năm du lịch Điện Biên', 'Tổng cục Du lịch', 'Hương Thảo', 'Hà Nội Startour', 'Mường Thanh'], 'address': ['Điện Biên Phủ', 'Việt Nam', 'Hà Nội', 'Điện Biên', 'Pháp', 'thành phố Điện Biên Phủ', 'TP HCM']}
2025-11-24 03:15:22.252 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Nguyễn Thị Thu', 'chị Thảo', 'Trương Quốc Hùng', 'Nguyễn Văn Tưởng'], 'organizations': ['Sở Du lịch thương mại Điện Biên', 'Saigontourist', 'Vietravel', 'Đầu tư và xuất nhập khẩu Hồ Gươm', 'Hà Nội Startour', 'Tổng cục Du lịch', 'Hương Thảo', 'Mường Thanh', 'Điện Biên 21'], 'address': ['Điện Biên Phủ', 'Việt Nam', 'Hà Nội', 'Điện Biên', 'phía Tây', '500 km', 'cánh đồng bằng phẳng', 'thành phố Điện Biên Phủ', 'các bản văn hoá ngoại vi thành phố Điện Biên Phủ']}
Extracting entities:  32%|██████████████████████▋                                                | 32/100 [08:36<17:40, 15.59s/it]2025-11-24 03:15:22.252 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 14.23it/s]
2025-11-24 03:15:22.326 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:15:42.697 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [9.516815185546875, -1.758829116821289, -1.9127055406570435]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 172.78it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:08<00:00,  8.38s/it, est. speed input: 229.32 toks/s, output: 30.42 toks/s]
2025-11-24 03:15:51.085 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Lê Tuyết", "Dũng", "Lê Hoài Xum", "Nguyễn Đức Chính", "Trần Anh Dũng", "Tư Sul", "Phạm Ngọc Tuấn", "Huỳnh Công Khanh"], "organizations": ["Ban phòng chống dịch cúm gia cầm quận Bình Thủy", "UBND quận Bình Thủy", "UBND xã Thành Lợi", "phòng chống cúm gia cầm", "cơ quan chức năng môi trường và y tế"], "address": ["phà Cần Thơ", "sông Hậu", "quận Bình Thủy", "Ninh Kiều", "thành phố Cần Thơ", "phường An Thới", "phường Trà Nóc", "phường Cái Khế", "sông Trà Mơn", "ấp Tân Đông", "xã Tân Qưới", "huyện Bình Minh", "Vĩnh Long", "Chợ Đình", "xã Thành Lợi", "Bình Minh", "phường Bình Thủy", "cầu tàu", "sông Trà Mơn", "xã Thành Lợi", "Bình Minh", "Vĩnh Long"]}
2025-11-24 03:15:51.085 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 28.83s
2025-11-24 03:15:51.085 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Lê Tuyết', 'Nguyễn Đức Chính', 'Tư Sul', 'Lê Hoài Xum', 'Trần Anh Dũng', 'Phạm Ngọc Tuấn', 'Dũng', 'Huỳnh Công Khanh'], 'organizations': ['Ban phòng chống dịch cúm gia cầm quận Bình Thủy', 'UBND xã Thành Lợi', 'Trại cá Tư Sul', 'UBND quận Bình Thủy'], 'address': ['phà Cần Thơ', 'phường An Thới', 'sông Hậu', 'xã Tân Qưới', 'thành phố Cần Thơ', 'huyện Bình Minh', 'phường Bình Thủy', 'phường Cái Khế', 'sông Trà Mơn', 'quận Bình Thủy', 'ấp Tân Đông', 'xã Thành Lợi', 'Chợ Đình', 'Ninh Kiều', 'Vĩnh Long', 'Bình Minh', 'phường Trà Nóc']}
2025-11-24 03:15:51.086 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Lê Tuyết', 'Dũng', 'Lê Hoài Xum', 'Nguyễn Đức Chính', 'Trần Anh Dũng', 'Tư Sul', 'Phạm Ngọc Tuấn', 'Huỳnh Công Khanh'], 'organizations': ['Ban phòng chống dịch cúm gia cầm quận Bình Thủy', 'UBND quận Bình Thủy', 'UBND xã Thành Lợi', 'phòng chống cúm gia cầm', 'cơ quan chức năng môi trường và y tế'], 'address': ['phà Cần Thơ', 'sông Hậu', 'quận Bình Thủy', 'Ninh Kiều', 'thành phố Cần Thơ', 'phường An Thới', 'phường Trà Nóc', 'phường Cái Khế', 'sông Trà Mơn', 'ấp Tân Đông', 'xã Tân Qưới', 'huyện Bình Minh', 'Vĩnh Long', 'Chợ Đình', 'xã Thành Lợi', 'Bình Minh', 'phường Bình Thủy', 'cầu tàu', 'sông Trà Mơn', 'xã Thành Lợi', 'Bình Minh', 'Vĩnh Long']}
Extracting entities:  33%|███████████████████████▍                                               | 33/100 [09:05<21:50, 19.56s/it]2025-11-24 03:15:51.086 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 18.96it/s]
2025-11-24 03:15:51.142 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:16:07.771 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.446077346801758, -2.900054454803467, -2.9651777744293213]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 198.22it/s]
Processed prompts: 100%|████████████████████| 1/1 [00:01<00:00,  1.09s/it, est. speed input: 1424.40 toks/s, output: 72.32 toks/s]
2025-11-24 03:16:08.869 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Nguyễn Văn Xuân", "Nguyễn Đức Thắng", "Sáu Huyến", "Mộng Thu"], "organizations": [], "address": ["Làng Lương Hội", "xã Hố Nai 3", "huyện Trảng Bom", "tỉnh Đồng Nai", "miền Trung", "Mỹ"]}
2025-11-24 03:16:08.870 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 17.78s
2025-11-24 03:16:08.870 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Mộng Thu', 'Nguyễn Đức Thắng', 'Nguyễn Văn Xuân', 'Sáu Huyến'], 'organizations': ['Olympia'], 'address': ['Mỹ', 'huyện Trảng Bom', 'tỉnh Đồng Nai', 'xã Hố Nai 3', 'Làng Lương Hội', 'trời Tây', 'làng Lương Hội', 'miền Trung']}
2025-11-24 03:16:08.870 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Nguyễn Văn Xuân', 'Nguyễn Đức Thắng', 'Sáu Huyến', 'Mộng Thu'], 'organizations': [], 'address': ['Làng Lương Hội', 'xã Hố Nai 3', 'huyện Trảng Bom', 'tỉnh Đồng Nai', 'miền Trung', 'Mỹ']}
Extracting entities:  34%|████████████████████████▏                                              | 34/100 [09:22<20:55, 19.03s/it]2025-11-24 03:16:08.870 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 67.07it/s]
2025-11-24 03:16:08.889 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:16:17.067 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.398086547851562, 2.1492300033569336, 1.8775053024291992]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 285.17it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:01<00:00,  1.28s/it, est. speed input: 924.02 toks/s, output: 73.95 toks/s]
2025-11-24 03:16:18.356 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": [], "organizations": ["IELTS", "công ty tư vấn quốc tế Cát Tường", "TOEFL"], "address": ["Thụy Sĩ", "557-559 Sư Vạn Hạnh (nối dài), P.13, quận 10", "66 - Ngô Thì Nhậm, quận Hai Bà Trưng", "TP HCM", "Hà Nội"]}
2025-11-24 03:16:18.356 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 9.49s
2025-11-24 03:16:18.356 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': [], 'organizations': ['IELTS', 'công ty tư vấn quốc tế Cát Tường', 'TOEFL'], 'address': ['Hà Nội', '66 - Ngô Thì Nhậm, quận Hai Bà Trưng', 'TP HCM', 'Thụy Sĩ', '557-559 Sư Vạn Hạnh (nối dài), P.13, quận 10']}
2025-11-24 03:16:18.356 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': [], 'organizations': ['IELTS', 'công ty tư vấn quốc tế Cát Tường', 'TOEFL'], 'address': ['Thụy Sĩ', '557-559 Sư Vạn Hạnh (nối dài), P.13, quận 10', '66 - Ngô Thì Nhậm, quận Hai Bà Trưng', 'TP HCM', 'Hà Nội']}
Extracting entities:  35%|████████████████████████▊                                              | 35/100 [09:32<17:30, 16.17s/it]2025-11-24 03:16:18.356 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 83.56it/s]
2025-11-24 03:16:18.372 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:16:26.115 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [10.18659782409668, -4.384725570678711, -4.727156162261963]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 320.00it/s]
Processed prompts: 100%|████████████████████| 1/1 [00:00<00:00,  1.34it/s, est. speed input: 1249.45 toks/s, output: 73.73 toks/s]
2025-11-24 03:16:26.865 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Jean Francois Blarel"],"organizations":["Trung tâm đào tạo bảo dưỡng công nghiệp (CFMI)","Cenformi","ĐH Bách Khoa Hà Nội","IUT"],"address":["Pháp","Việt Nam","TP HCM"]}
2025-11-24 03:16:26.865 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 8.51s
2025-11-24 03:16:26.865 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Jean Francois Blarel'], 'organizations': ['Trung tâm đào tạo bảo dưỡng công nghiệp (CFMI)', 'ĐH Bách Khoa Hà Nội', 'Cenformi', 'IUT'], 'address': ['Pháp', 'TP HCM', 'Việt Nam']}
2025-11-24 03:16:26.865 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Jean Francois Blarel'], 'organizations': ['Trung tâm đào tạo bảo dưỡng công nghiệp (CFMI)', 'Cenformi', 'ĐH Bách Khoa Hà Nội', 'IUT'], 'address': ['Pháp', 'Việt Nam', 'TP HCM']}
Extracting entities:  36%|█████████████████████████▌                                             | 36/100 [09:40<14:47, 13.87s/it]2025-11-24 03:16:26.865 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 54.25it/s]
2025-11-24 03:16:26.887 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:16:35.965 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [9.1503267288208, -3.918476104736328, -4.307037830352783]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 229.28it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.17s/it, est. speed input: 715.31 toks/s, output: 74.57 toks/s]
2025-11-24 03:16:38.143 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Trần Cảnh Đào"], "organizations": ["Sở Văn hóa Thông tin Lâm Đồng", "Festival hoa Đà Lạt"], "address": ["công viên Đà Lạt", "khu thao trường Lâm Viên", "công viên Yersin", "thành phố Đà Lạt", "Đà Lạt", "thung lũng Tình Yêu", "hồ Xuân Hương", "hồ Than Thở", "hồ Dankia - suối Vàng", "thác Pongour", "Cam Ly", "đèo Ngoạn Mục", "khu Hòa Bình", "Lê Đại Hành", "Trần Quốc Toản", "Yersin", "quảng trường Đà Lạt"]}
2025-11-24 03:16:38.143 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 11.28s
2025-11-24 03:16:38.143 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Yersin', 'Trần Cảnh Đào', 'Bảo Đại'], 'organizations': ['Sở Văn hóa Thông tin Lâm Đồng', 'Tu viện Domain de Marie', 'Festival hoa Đà Lạt'], 'address': ['công viên Đà Lạt', 'nhà thờ Đà Lạt', 'Trần Quốc Toản', 'dinh Toàn quyền', 'Lê Đại Hành', 'công viên Yersin', 'cao nguyên', 'khu thao trường Lâm Viên', 'Yersin', 'thác Pongour', 'Cam Ly', 'khu Hòa Bình', 'Đà Lạt', 'thung lũng Tình Yêu', 'hồ Than Thở', 'hồ Dankia - suối Vàng', 'biệt điện Bảo Đại', 'Lâm Đồng', 'đèo Ngoạn Mục', 'thành phố Đà Lạt', 'hồ Xuân Hương', 'quảng trường Đà Lạt']}
2025-11-24 03:16:38.143 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Trần Cảnh Đào'], 'organizations': ['Sở Văn hóa Thông tin Lâm Đồng', 'Festival hoa Đà Lạt'], 'address': ['công viên Đà Lạt', 'khu thao trường Lâm Viên', 'công viên Yersin', 'thành phố Đà Lạt', 'Đà Lạt', 'thung lũng Tình Yêu', 'hồ Xuân Hương', 'hồ Than Thở', 'hồ Dankia - suối Vàng', 'thác Pongour', 'Cam Ly', 'đèo Ngoạn Mục', 'khu Hòa Bình', 'Lê Đại Hành', 'Trần Quốc Toản', 'Yersin', 'quảng trường Đà Lạt']}
Extracting entities:  37%|██████████████████████████▎                                            | 37/100 [09:52<13:44, 13.09s/it]2025-11-24 03:16:38.143 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 36.30it/s]
2025-11-24 03:16:38.175 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:16:57.190 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.393985748291016, 0.5709323883056641, 0.5324229001998901]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 198.48it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:01<00:00,  1.91s/it, est. speed input: 955.39 toks/s, output: 73.25 toks/s]
2025-11-24 03:16:59.108 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Nguyễn Văn Đức", "Trần Trung", "Tô Mạnh Cường"], "organizations": ["công an", "Bưu điện Hà Nội", "thanh tra ngành bưu điện"], "address": ["Hà Nội", "bến xe Gia Lâm", "bến xe khách Mỹ Đình", "đường Nguyễn Văn Cừ", "quận 4", "TP HCM", "Thủy Nguyên", "Hải Phòng", "quận 4", "cảng Khánh Hội", "Nhà Rồng", "TP HCM", "cổng Kho 5", "Kho 5"]}
2025-11-24 03:16:59.108 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 20.96s
2025-11-24 03:16:59.108 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Trần Trung', 'Nguyễn Văn Đức', 'Tô Mạnh Cường'], 'organizations': ['thanh tra ngành bưu điện', 'Bệnh viện K', 'Bưu điện Hà Nội'], 'address': ['Nguyễn Văn Cừ', 'Hà Nội', 'Gia Lâm', 'Trung Quốc', 'bến xe Mỹ Đình', 'Quán Sứ', 'Mỹ Đình', 'Hải Phòng', 'Thủy Nguyên']}
2025-11-24 03:16:59.108 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Nguyễn Văn Đức', 'Trần Trung', 'Tô Mạnh Cường'], 'organizations': ['công an', 'Bưu điện Hà Nội', 'thanh tra ngành bưu điện'], 'address': ['Hà Nội', 'bến xe Gia Lâm', 'bến xe khách Mỹ Đình', 'đường Nguyễn Văn Cừ', 'quận 4', 'TP HCM', 'Thủy Nguyên', 'Hải Phòng', 'quận 4', 'cảng Khánh Hội', 'Nhà Rồng', 'TP HCM', 'cổng Kho 5', 'Kho 5']}
Extracting entities:  38%|██████████████████████████▉                                            | 38/100 [10:13<15:58, 15.45s/it]2025-11-24 03:16:59.108 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 42.76it/s]
2025-11-24 03:16:59.135 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:17:12.315 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.445913314819336, -5.151505470275879, -5.19237756729126]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 214.64it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:08<00:00,  8.76s/it, est. speed input: 196.09 toks/s, output: 75.45 toks/s]
2025-11-24 03:17:21.081 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Lê Chinh", "Hoàng Sĩ Sơn"],"organizations": ["UBND thành phố Đà Lạt", "UBND tỉnh Lâm Đồng", "công ty có uy tín của Pháp"],"address": ["Đà Lạt", "Tỉnh Lâm Đồng", "trung tâm thành phố Đà Lạt", "khu dân cư đông đúc", "công viên", "chung cư hiện đại", "công viên văn hoá Bùi Thị Xuân - Đinh Tiên Hoàng", "khu Hoà Bình - đường Phan Bội Châu - chợ Đà Lạt", "đường Nguyễn Thị Minh Khai", "đường Phan Bội Châu", "chợ Đà Lạt", "công viên rộng 5,5 ha", "khu nghỉ tĩnh", "vui chơi thiếu nhi", "khu văn hoá", "thể thao", "khu thương mại", "bãi đỗ xe", "khu biệt thự", "công viên rộng 8,1 ha", "công viên", "công viên Đà Lạt", "cao nguyên", "khu thao trường Lâm Viên", "công viên Yersin", "hồ Xuân Hương", "quảng trường Đà Lạt", "đèo Ngoạn Mục", "thác Pongour", "Cam Ly", "khu Hòa Bình", "thung lũng Tình Yêu", "hồ Than Thở", "hồ Dankia - suối Vàng", "biệt điện Bảo Đại", "Lâm Đồng", "7,6 ha", "5,5 ha", "19 ha", "8,1 ha", "1,07 ha", "5 tầng", "12 tầng", "42 m", "200 căn hộ", "382 căn hộ", "68-100 m2", "khu vực trung tâm thành phố cao nguyên", "các khu nghỉ tĩnh", "vui chơi thiếu nhi", "khu văn hoá", "thể thao", "khu thương mại", "bãi đỗ xe", "khu biệt thự", "công viên rộng 5,5 ha", "công viên rộng 8,1 ha", "công viên", "công viên Đà Lạt", "cao nguyên", "khu thao trường Lâm Viên", "công viên Yersin", "hồ Xuân Hương", "quảng trường Đà Lạt", "đèo Ngoạn Mục", "thác Pongour", "Cam Ly", "khu Hòa Bình", "thung lũng Tình Yêu", "hồ Than Thở", "hồ Dankia - suối Vàng", "biệt điện Bảo Đại", "Lâm Đồng", "7,6 ha", "5,5 ha", "19 ha", "8,1 ha", "1,07 ha", "5 tầng", "12 tầng", "42 m", "200 căn hộ", "382 căn hộ", "68-100 m2"]}
2025-11-24 03:17:21.082 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 21.97s
2025-11-24 03:17:21.082 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Lê Chinh', 'Hoàng Sĩ Sơn'], 'organizations': ['UBND thành phố Đà Lạt', 'UBND tỉnh Lâm Đồng'], 'address': ['Đà Lạt', 'đường Phan Bội Châu', 'Tỉnh Lâm Đồng', 'Pháp', 'Bùi Thị Xuân', 'Đinh Tiên Hoàng', 'Phan Bội Châu', 'Hoà Bình', 'chợ Đà Lạt', 'Nguyễn Thị Minh Khai', 'Lâm Đồng']}
2025-11-24 03:17:21.082 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Lê Chinh', 'Hoàng Sĩ Sơn'], 'organizations': ['UBND thành phố Đà Lạt', 'UBND tỉnh Lâm Đồng', 'công ty có uy tín của Pháp'], 'address': ['Đà Lạt', 'Tỉnh Lâm Đồng', 'trung tâm thành phố Đà Lạt', 'khu dân cư đông đúc', 'công viên', 'chung cư hiện đại', 'công viên văn hoá Bùi Thị Xuân - Đinh Tiên Hoàng', 'khu Hoà Bình - đường Phan Bội Châu - chợ Đà Lạt', 'đường Nguyễn Thị Minh Khai', 'đường Phan Bội Châu', 'chợ Đà Lạt', 'công viên rộng 5,5 ha', 'khu nghỉ tĩnh', 'vui chơi thiếu nhi', 'khu văn hoá', 'thể thao', 'khu thương mại', 'bãi đỗ xe', 'khu biệt thự', 'công viên rộng 8,1 ha', 'công viên', 'công viên Đà Lạt', 'cao nguyên', 'khu thao trường Lâm Viên', 'công viên Yersin', 'hồ Xuân Hương', 'quảng trường Đà Lạt', 'đèo Ngoạn Mục', 'thác Pongour', 'Cam Ly', 'khu Hòa Bình', 'thung lũng Tình Yêu', 'hồ Than Thở', 'hồ Dankia - suối Vàng', 'biệt điện Bảo Đại', 'Lâm Đồng', '7,6 ha', '5,5 ha', '19 ha', '8,1 ha', '1,07 ha', '5 tầng', '12 tầng', '42 m', '200 căn hộ', '382 căn hộ', '68-100 m2', 'khu vực trung tâm thành phố cao nguyên', 'các khu nghỉ tĩnh', 'vui chơi thiếu nhi', 'khu văn hoá', 'thể thao', 'khu thương mại', 'bãi đỗ xe', 'khu biệt thự', 'công viên rộng 5,5 ha', 'công viên rộng 8,1 ha', 'công viên', 'công viên Đà Lạt', 'cao nguyên', 'khu thao trường Lâm Viên', 'công viên Yersin', 'hồ Xuân Hương', 'quảng trường Đà Lạt', 'đèo Ngoạn Mục', 'thác Pongour', 'Cam Ly', 'khu Hòa Bình', 'thung lũng Tình Yêu', 'hồ Than Thở', 'hồ Dankia - suối Vàng', 'biệt điện Bảo Đại', 'Lâm Đồng', '7,6 ha', '5,5 ha', '19 ha', '8,1 ha', '1,07 ha', '5 tầng', '12 tầng', '42 m', '200 căn hộ', '382 căn hộ', '68-100 m2']}
Extracting entities:  39%|███████████████████████████▋                                           | 39/100 [10:35<17:41, 17.41s/it]2025-11-24 03:17:21.082 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 42.28it/s]
2025-11-24 03:17:21.109 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:17:39.381 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.40199089050293, 0.4874172806739807, 0.05483629181981087]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 180.73it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:13<00:00, 13.71s/it, est. speed input: 138.65 toks/s, output: 74.69 toks/s]
2025-11-24 03:17:53.098 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Đào Ngọc Nghiêm", "Đỗ Hoàng Ân"], "organizations": ["Tổng công ty Thiết kế giao thông vận tải", "Sở Quy hoạch kiến trúc Hà Nội", "UBND thành phố", "công ty thiết kế"], "address": ["cầu Nhật Tân", "cầu Mỹ Thuận", "cầu Kiền", "cầu Rạch Miễu", "cầu Bính", "cầu Thuận Phước", "Đà Nẵng", "phường Phú Thượng", "quận Tây Hồ", "xã Vĩnh Ngọc", "huyện Đông Anh", "cầu Chui", "Kim Nỗ", "Long Biên", "huyện Đông Anh", "quận Long Biên", "Tầm Xá", "sông Hồng", "Hà Nội", "đường 5 kéo dài", "Bắc sông Hồng", "thành phố Hà Nội", "đường chính thuộc dự án phát triển hạ tầng đô thị Bắc Thăng Long - Vân Trì", "Đông Anh", "cầu Nhật Tân", "cầu Chui", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "cầu Nhật Tân", "c
2025-11-24 03:17:53.098 | INFO     | src.utils:parse_response:202 - No JSON found in response: {"person": ["Đào Ngọc Nghiêm", "Đỗ Hoàng Ân"], "organizations": ["Tổng công ty Thiết kế giao thông v
2025-11-24 03:17:53.098 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 32.02s
2025-11-24 03:17:53.098 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Đào Ngọc Nghiêm', 'Đỗ Hoàng Ân'], 'organizations': ['Sở Quy hoạch kiến trúc Hà Nội', 'Tổng công ty Thiết kế giao thông vận tải', 'UBND thành phố'], 'address': ['cầu Mỹ Thuận', 'cầu Rạch Miễu', 'Đông Anh', 'quận Tây Hồ', 'cầu Bính', 'cầu Chui', 'sông Hồng', 'cầu Thuận Phước', 'xã Vĩnh Ngọc', 'Bắc sông Hồng', 'cầu Kiền', 'Đà Nẵng', 'Cầu Nhật Tân', 'Bắc Thăng Long - Vân Trì', 'Tầm Xá', 'Hà Nội', 'thành phố Hà Nội', 'phường Phú Thượng', 'Kim Nỗ', 'huyện Đông Anh', 'Long Biên']}
2025-11-24 03:17:53.099 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': [], 'organizations': [], 'address': []}
Extracting entities:  40%|████████████████████████████▍                                          | 40/100 [11:07<21:47, 21.79s/it]2025-11-24 03:17:53.099 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 96.97it/s]
2025-11-24 03:17:53.113 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:17:56.996 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [9.669220924377441, -0.4343431293964386, -3.009934902191162]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 338.71it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:01<00:00,  1.53s/it, est. speed input: 568.54 toks/s, output: 75.80 toks/s]
2025-11-24 03:17:58.530 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Đỗ Đăng Ký", "Đào Thị Hoàng Dung", "Đoàn Trung Dũng"], "organizations": ["trường Nguyễn Gia Thiều", "trường Lê Văn Tám", "trường Gò Vấp 2", "Hội đồng chấm thi THCS"], "address": ["quận Gò Vấp", "quận 4", "quận 12", "quận Tân Bình", "huyện Củ Chi", "huyện Nhà Bè", "TP HCM"]}
2025-11-24 03:17:58.530 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 5.43s
2025-11-24 03:17:58.530 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Đào Thị Hoàng Dung', 'Đỗ Đăng Ký', 'Đoàn Trung Dũng'], 'organizations': ['trường Nguyễn Gia Thiều', 'trường Lê Văn Tám', 'trường Gò Vấp 2', 'Hội đồng chấm thi THCS'], 'address': ['quận Gò Vấp', 'quận 12', 'quận Bình Thạnh', 'quận 4', 'quận Tân Bình', 'huyện Củ Chi', 'huyện Nhà Bè', 'TP HCM']}
2025-11-24 03:17:58.531 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Đỗ Đăng Ký', 'Đào Thị Hoàng Dung', 'Đoàn Trung Dũng'], 'organizations': ['trường Nguyễn Gia Thiều', 'trường Lê Văn Tám', 'trường Gò Vấp 2', 'Hội đồng chấm thi THCS'], 'address': ['quận Gò Vấp', 'quận 4', 'quận 12', 'quận Tân Bình', 'huyện Củ Chi', 'huyện Nhà Bè', 'TP HCM']}
Extracting entities:  41%|█████████████████████████████                                          | 41/100 [11:12<16:36, 16.88s/it]2025-11-24 03:17:58.531 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 24.70it/s]
2025-11-24 03:17:58.575 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:18:14.101 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [9.251221656799316, -4.017229080200195, -5.128666400909424]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 173.25it/s]
Processed prompts: 100%|████████████████████| 1/1 [00:01<00:00,  1.13s/it, est. speed input: 1743.00 toks/s, output: 70.57 toks/s]
2025-11-24 03:18:15.242 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Trần Văn Tá", "Nguyễn Đức Kiên", "Bộ trưởng Y tế", "Trần Thị Trung Chiến"], "organizations": ["Bộ Tài chính", "Chính phủ", "Văn phòng Quốc hội", "Ủy ban Kinh tế và Ngân sách", "Bộ Y tế"], "address": ["toàn quốc"]}
2025-11-24 03:18:15.242 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 16.71s
2025-11-24 03:18:15.242 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Thủ tướng Chính phủ', 'Trần Văn Tá'], 'organizations': ['Nhà nước', 'Chính phủ', 'Bộ Tài chính', 'Văn phòng Quốc hội'], 'address': ['toàn quốc']}
2025-11-24 03:18:15.242 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Trần Văn Tá', 'Nguyễn Đức Kiên', 'Bộ trưởng Y tế', 'Trần Thị Trung Chiến'], 'organizations': ['Bộ Tài chính', 'Chính phủ', 'Văn phòng Quốc hội', 'Ủy ban Kinh tế và Ngân sách', 'Bộ Y tế'], 'address': ['toàn quốc']}
Extracting entities:  42%|█████████████████████████████▊                                         | 42/100 [11:29<16:16, 16.83s/it]2025-11-24 03:18:15.242 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|█████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 114.95it/s]
2025-11-24 03:18:15.255 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:18:20.164 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [3.880878210067749, -5.507259845733643, -6.93913459777832]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 361.08it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:00<00:00,  1.42it/s, est. speed input: 995.96 toks/s, output: 70.94 toks/s]
2025-11-24 03:18:20.873 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Jennifer Stephens"],"organizations": ["CĐ Bosworth","Hội đồng Anh","Hội đồng Anh Hà Nội","British Council"],"address": ["40 Cát Linh, Hà Nội","Hà Nội"]}
2025-11-24 03:18:20.873 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 5.63s
2025-11-24 03:18:20.873 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Jennifer Stephens'], 'organizations': ['Hội đồng Anh', 'Hội đồng Anh Hà Nội', 'CĐ Bosworth'], 'address': ['40 Cát Linh, Hà Nội']}
2025-11-24 03:18:20.873 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Jennifer Stephens'], 'organizations': ['CĐ Bosworth', 'Hội đồng Anh', 'Hội đồng Anh Hà Nội', 'British Council'], 'address': ['40 Cát Linh, Hà Nội', 'Hà Nội']}
Extracting entities:  43%|██████████████████████████████▌                                        | 43/100 [11:34<12:47, 13.47s/it]2025-11-24 03:18:20.873 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 42.25it/s]
2025-11-24 03:18:20.905 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:18:43.607 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.446898460388184, -1.306925892829895, -1.318150281906128]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 252.94it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:03<00:00,  3.22s/it, est. speed input: 389.35 toks/s, output: 35.99 toks/s]
2025-11-24 03:18:46.836 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Thủ tướng Phan Văn Khải", "Thiền sư Thích Nhất Hạnh", "GS. Trần Văn Khê", "Chủ tịch UBND TP HCM Lê Thanh Hải"], "organizations": ["Chính phủ", "Nhà nước", "Hội bảo trợ trẻ em TP HCM", "UBND TP HCM"], "address": ["Việt Nam", "Pháp", "Dinh Độc Lập", "TP HCM", "nước ngoài", "sân bay", "ao"]}
2025-11-24 03:18:46.836 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 25.96s
2025-11-24 03:18:46.836 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Thủ tướng Phan Văn Khải', 'GS. Trần Văn Khê', 'Thiền sư Thích Nhất Hạnh', 'Lê Thanh Hải'], 'organizations': ['Nhà nước', 'Chính phủ', 'UBND TP HCM'], 'address': ['Việt Nam', 'Pháp', 'Dinh Độc Lập', 'TP HCM', 'nước ngoài']}
2025-11-24 03:18:46.836 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Thủ tướng Phan Văn Khải', 'Thiền sư Thích Nhất Hạnh', 'GS. Trần Văn Khê', 'Chủ tịch UBND TP HCM Lê Thanh Hải'], 'organizations': ['Chính phủ', 'Nhà nước', 'Hội bảo trợ trẻ em TP HCM', 'UBND TP HCM'], 'address': ['Việt Nam', 'Pháp', 'Dinh Độc Lập', 'TP HCM', 'nước ngoài', 'sân bay', 'ao']}
Extracting entities:  44%|███████████████████████████████▏                                       | 44/100 [12:00<16:04, 17.22s/it]2025-11-24 03:18:46.836 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00,  7.63it/s]
2025-11-24 03:18:46.971 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents██████████| 1/1 [00:00<00:00,  7.64it/s]
2025-11-24 03:19:07.992 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [8.006454467773438, -7.624747276306152, -8.250273704528809]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 128.85it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:06<00:00,  6.11s/it, est. speed input: 526.05 toks/s, output: 34.71 toks/s]
2025-11-24 03:19:14.108 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person":["N. Hữu Chiều","Trần Thế Ngọc","Nguyễn Văn Chiến","Phan Minh Tân","Nguyễn Văn Đua","Đoàn Phú","Roderich Haire","Ngọc Mai"],"organizations":["Sở Tài nguyên - Môi trường (TN-MT) TPHCM","Sở Xây dựng","Sở Khoa học - Công nghệ TPHCM","Liên đoàn Bản đồ Địa chất miền Nam","Viện Vật lý Địa cầu","Báo Người Lao Động","Công ty Pouyuen","Công ty TNHH Bảo hiểm Quốc tế Mỹ - AIA (Việt Nam)","UBND TPHCM","Công an TP","Sở Y tế","Công ty TNHH Bảo hiểm Quốc tế Mỹ - AIA (Việt Nam)"],"address":["TPHCM","quận 1","Vũng Tàu","hầm vượt sông Sài Gòn","hầm Thủ Thiêm","chung cư Nguyễn Thái Bình","Nhật Bản"]}
2025-11-24 03:19:14.108 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 27.27s
2025-11-24 03:19:14.108 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Chiến', 'Đoàn Phú', 'Ngọc', 'Nguyễn Văn Đua', 'Phan Minh Tân', 'N. Hữu', 'Trần Thế Ngọc', 'T.Thắng', 'N.Triều', 'Ngọc Mai', 'Nguyễn Văn Chiến', 'Roderich Haire'], 'organizations': ['Sở Tài nguyên - Môi trường (TN-MT) TPHCM', 'Công an TP', 'Sở TN-MT', 'Viện Vật lý Địa cầu', 'Báo Người Lao Động', 'công ty Pouyuen', 'Công ty TNHH Bảo hiểm Quốc tế Mỹ - AIA (Việt Nam)', 'UBND TP', 'Sở Xây dựng', 'Sở Khoa học Công nghệ TPHCM', 'Công ty Pouyuen', 'Liên đoàn Bản đồ Địa chất miền Nam', 'Sở Tài nguyên - Môi trường', 'UBND TPHCM', 'Sở Y tế', 'AIA', 'Sở Khoa học - Công nghệ'], 'address': ['TP', 'Vũng Tàu', 'TPHCM', 'quận 1', 'Nhật', 'Đông Nam Bộ', 'hầm vượt sông Sài Gòn', 'hầm Thủ Thiêm', 'Chung cư Nguyễn Thái Bình', 'Nhật Bản']}
2025-11-24 03:19:14.108 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['N. Hữu Chiều', 'Trần Thế Ngọc', 'Nguyễn Văn Chiến', 'Phan Minh Tân', 'Nguyễn Văn Đua', 'Đoàn Phú', 'Roderich Haire', 'Ngọc Mai'], 'organizations': ['Sở Tài nguyên - Môi trường (TN-MT) TPHCM', 'Sở Xây dựng', 'Sở Khoa học - Công nghệ TPHCM', 'Liên đoàn Bản đồ Địa chất miền Nam', 'Viện Vật lý Địa cầu', 'Báo Người Lao Động', 'Công ty Pouyuen', 'Công ty TNHH Bảo hiểm Quốc tế Mỹ - AIA (Việt Nam)', 'UBND TPHCM', 'Công an TP', 'Sở Y tế', 'Công ty TNHH Bảo hiểm Quốc tế Mỹ - AIA (Việt Nam)'], 'address': ['TPHCM', 'quận 1', 'Vũng Tàu', 'hầm vượt sông Sài Gòn', 'hầm Thủ Thiêm', 'chung cư Nguyễn Thái Bình', 'Nhật Bản']}
Extracting entities:  45%|███████████████████████████████▉                                       | 45/100 [12:28<18:32, 20.24s/it]2025-11-24 03:19:14.109 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 38.28it/s]
2025-11-24 03:19:14.138 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:19:26.592 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [8.663812637329102, 3.661397933959961, 2.66264271736145]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 291.17it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.46s/it, est. speed input: 391.23 toks/s, output: 36.16 toks/s]
2025-11-24 03:19:29.058 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Trần Phạm Gia Khánh", "Phạm Thị Hòa", "Nguyễn Thế Bình"], "organizations": ["Hợp tác xã Phúc Tân", "UBND quận Hoàn Kiếm"], "address": ["quận Hoàn Kiếm", "Hà Nội", "khu dân cư ngõ 2 phố Cầu Đất", "sông Hồng", "phường Chương Dương"]}
2025-11-24 03:19:29.058 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 14.95s
2025-11-24 03:19:29.058 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Trần Phạm Gia Khánh', 'Phạm Thị Hòa', 'Nguyễn Thế Bình'], 'organizations': ['Hợp tác xã Phúc Tân', 'UBND quận Hoàn Kiếm'], 'address': ['quận Hoàn Kiếm', 'Hà Nội', 'khu dân cư ngõ 2 phố Cầu Đất', 'sông Hồng', 'phường Chương Dương']}
2025-11-24 03:19:29.058 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Trần Phạm Gia Khánh', 'Phạm Thị Hòa', 'Nguyễn Thế Bình'], 'organizations': ['Hợp tác xã Phúc Tân', 'UBND quận Hoàn Kiếm'], 'address': ['quận Hoàn Kiếm', 'Hà Nội', 'khu dân cư ngõ 2 phố Cầu Đất', 'sông Hồng', 'phường Chương Dương']}
Extracting entities:  46%|████████████████████████████████▋                                      | 46/100 [12:43<16:47, 18.65s/it]2025-11-24 03:19:29.058 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 38.26it/s]
2025-11-24 03:19:29.088 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:19:38.192 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.373624801635742, 1.9878807067871094, 1.6978352069854736]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 280.31it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:03<00:00,  3.29s/it, est. speed input: 310.55 toks/s, output: 36.50 toks/s]
2025-11-24 03:19:41.484 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": [], "organizations": ["Sapphire Princess", "Mitsubishi", "PTSC", "Vina Express", "Petro"], "address": ["Vũng Tàu", "Mỹ", "Anh", "Canada", "Australia", "Malaysia", "Singapore", "TP HCM", "Địa đạo Củ Chi", "Dinh Độc lập", "Nhà thờ Đức Bà", "Bảo tàng lịch sử", "Bà Rịa", "Thái Lan", "cảng Chân Mây", "Huế"]}
2025-11-24 03:19:41.484 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 12.43s
2025-11-24 03:19:41.484 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': [], 'organizations': ['Mitsubishi', 'Vina Express', 'PTSC', 'Petro', 'Sapphire Princess'], 'address': ['Dinh Độc lập', 'Mỹ', 'Anh', 'Bảo tàng lịch sử', 'Vũng Tàu', 'Việt Nam', 'Australia', 'Malaysia', 'Canada', 'Bà Rịa', 'Nhà thờ Đức Bà', 'Thái Lan', 'châu Á', 'TP HCM', 'Địa đạo Củ Chi', 'Singapore', 'Huế', 'cảng Chân Mây']}
2025-11-24 03:19:41.484 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': [], 'organizations': ['Sapphire Princess', 'Mitsubishi', 'PTSC', 'Vina Express', 'Petro'], 'address': ['Vũng Tàu', 'Mỹ', 'Anh', 'Canada', 'Australia', 'Malaysia', 'Singapore', 'TP HCM', 'Địa đạo Củ Chi', 'Dinh Độc lập', 'Nhà thờ Đức Bà', 'Bảo tàng lịch sử', 'Bà Rịa', 'Thái Lan', 'cảng Chân Mây', 'Huế']}
Extracting entities:  47%|█████████████████████████████████▎                                     | 47/100 [12:55<14:49, 16.78s/it]2025-11-24 03:19:41.485 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 23.66it/s]
2025-11-24 03:19:41.531 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:20:02.689 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.44674301147461, 2.4422786235809326, 2.2628910541534424]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 229.02it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:03<00:00,  3.81s/it, est. speed input: 361.42 toks/s, output: 35.70 toks/s]
2025-11-24 03:20:06.504 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Sue Kedgley", "Nguyễn Văn Lạng", "M.Mc Goun"], "organizations": ["APPF", "làng Hữu nghị", "Lao Động", "Ủy ban Y tế New Zealand", "Bộ Quốc phòng New Zealand", "chính phủ New Zealand", "quân đội Mỹ", "Hội Cựu chiến binh New Zealand", "Diễn đàn Nghị viện châu Á-Thái Bình Dương"], "address": ["Hạ Long", "Quảng Ninh", "New Zealand", "Việt Nam", "Đăk Lăk", "Mỹ"]}
2025-11-24 03:20:06.504 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 25.02s
2025-11-24 03:20:06.504 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Sue Kedgley', 'Bộ trưởng Giao thông New Zealand'], 'organizations': ['APPF', 'làng Hữu nghị', 'Lao Động', 'Ủy ban Y tế New Zealand', 'Bộ Quốc phòng New Zealand', 'chính phủ New Zealand', 'quân đội Mỹ', 'Hội Cựu chiến binh New Zealand', 'Diễn đàn Nghị viện châu Á-Thái Bình Dương'], 'address': ['Hạ Long', 'Mỹ', 'Việt Nam', 'New Zealand', 'Quảng Ninh']}
2025-11-24 03:20:06.505 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Sue Kedgley', 'Nguyễn Văn Lạng', 'M.Mc Goun'], 'organizations': ['APPF', 'làng Hữu nghị', 'Lao Động', 'Ủy ban Y tế New Zealand', 'Bộ Quốc phòng New Zealand', 'chính phủ New Zealand', 'quân đội Mỹ', 'Hội Cựu chiến binh New Zealand', 'Diễn đàn Nghị viện châu Á-Thái Bình Dương'], 'address': ['Hạ Long', 'Quảng Ninh', 'New Zealand', 'Việt Nam', 'Đăk Lăk', 'Mỹ']}
Extracting entities:  48%|██████████████████████████████████                                     | 48/100 [13:20<16:41, 19.25s/it]2025-11-24 03:20:06.505 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 26.95it/s]
2025-11-24 03:20:06.545 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:20:23.603 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.301645278930664, -3.477508783340454, -3.590893268585205]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 216.65it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:04<00:00,  4.58s/it, est. speed input: 346.21 toks/s, output: 36.26 toks/s]
2025-11-24 03:20:28.187 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Đào Lệ Hương", "Nguyễn Hoài Thanh", "Thanh", "Hoàng Công Khôi", "Khôi"], "organizations": ["Tổng công ty đường sắt Việt Nam", "Học viện hành chính quốc gia", "Thuỷ sản", "Bộ Giao thông vận tải", "SEA Games", "Công ty FPT", "Chính phủ", "Thanh", "Hoàng Long", "bộ Thương mại"], "address": ["phố Hàng Bông", "Hà Nội", "181 Hàng Bông", "Thường Tín", "Hà Tây", "75 Hàng Bông", "11 lô N, 67 Phúc Xá, Ba Đình", "Ba Đình"]}
2025-11-24 03:20:28.187 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 21.68s
2025-11-24 03:20:28.187 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Thanh', 'Đào Lệ Hương', 'Hương', 'Nguyễn Hoài Thanh'], 'organizations': ['Tổng công ty đường sắt Việt Nam', 'Học viện hành chính quốc gia', 'Thuỷ sản', 'Bộ Giao thông vận tải', 'SEA Games', 'Công ty FPT', 'Chính phủ', 'Thanh', 'Hoàng Long', 'bộ Thương mại'], 'address': ['phố Hàng Bông', '11 lô N, 67 Phúc Xá, Ba Đình', 'Hà Nội', '75 Hàng Bông', '181 Hàng Bông', 'Thường Tín', 'Hà Tây']}
2025-11-24 03:20:28.187 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Đào Lệ Hương', 'Nguyễn Hoài Thanh', 'Thanh', 'Hoàng Công Khôi', 'Khôi'], 'organizations': ['Tổng công ty đường sắt Việt Nam', 'Học viện hành chính quốc gia', 'Thuỷ sản', 'Bộ Giao thông vận tải', 'SEA Games', 'Công ty FPT', 'Chính phủ', 'Thanh', 'Hoàng Long', 'bộ Thương mại'], 'address': ['phố Hàng Bông', 'Hà Nội', '181 Hàng Bông', 'Thường Tín', 'Hà Tây', '75 Hàng Bông', '11 lô N, 67 Phúc Xá, Ba Đình', 'Ba Đình']}
Extracting entities:  49%|██████████████████████████████████▊                                    | 49/100 [13:42<16:59, 19.98s/it]2025-11-24 03:20:28.187 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 19.76it/s]
2025-11-24 03:20:28.241 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:20:41.676 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [7.383238792419434, -2.5737979412078857, -2.823895215988159]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 194.70it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.11s/it, est. speed input: 876.81 toks/s, output: 73.50 toks/s]
2025-11-24 03:20:43.791 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Thu Hương", "Minh", "Hoàng Công Khôi"], "organizations": ["UBND các phường", "UBND quận Hoàn Kiếm", "công ty thoát nước", "công ty chiếu sáng"], "address": ["Việt Nam", "Hà Nội", "phố đi bộ Hàng Đào - Hàng Ngang - Hàng Đường - Đồng Xuân", "phố Khâm Thiên", "đường Yên Phụ", "chợ Đồng Xuân", "Quảng Ninh", "Trung Quốc", "Hải Phòng", "số nhà 12, Đồng Xuân", "bến xe Long Biên", "Hàng Bạc", "Hàng Bồ", "Tạ Hiền"]}
2025-11-24 03:20:43.791 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 15.60s
2025-11-24 03:20:43.791 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Minh', 'Thu Hương', 'Hoàng Công Khôi', 'Khôi'], 'organizations': ['UBND các phường', 'UBND quận Hoàn Kiếm', 'Công an quận', 'công ty thoát nước', 'công ty chiếu sáng'], 'address': ['Việt Nam', 'quận Hoàn Kiếm', 'Hà Nội', 'Khâm Thiên', 'Hàng Đào', 'Hàng Bạc', 'Trung Quốc', 'thành phố', 'Hàng Đường', 'Hàng Bồ', 'Hàng Ngang', 'Đồng Xuân', 'Tạ Hiền']}
2025-11-24 03:20:43.791 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Thu Hương', 'Minh', 'Hoàng Công Khôi'], 'organizations': ['UBND các phường', 'UBND quận Hoàn Kiếm', 'công ty thoát nước', 'công ty chiếu sáng'], 'address': ['Việt Nam', 'Hà Nội', 'phố đi bộ Hàng Đào - Hàng Ngang - Hàng Đường - Đồng Xuân', 'phố Khâm Thiên', 'đường Yên Phụ', 'chợ Đồng Xuân', 'Quảng Ninh', 'Trung Quốc', 'Hải Phòng', 'số nhà 12, Đồng Xuân', 'bến xe Long Biên', 'Hàng Bạc', 'Hàng Bồ', 'Tạ Hiền']}
Extracting entities:  50%|███████████████████████████████████▌                                   | 50/100 [13:57<15:33, 18.67s/it]2025-11-24 03:20:43.791 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 72.24it/s]
2025-11-24 03:20:43.809 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:20:51.906 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [10.33389949798584, 0.4203280508518219, -1.2126123905181885]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 282.71it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:01<00:00,  1.22s/it, est. speed input: 895.01 toks/s, output: 74.72 toks/s]
2025-11-24 03:20:53.128 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Lương Thị Thuận"], "organizations": ["Uỷ ban Dân số Gia đình và Trẻ em TP HCM", "Uỷ ban Dân số Gia đình và Trẻ em thành phố", "Uỷ ban Dân số Gia đình và Trẻ em Việt Nam", "Bộ Tài chính", "HĐND", "UBND thành phố"], "address": ["TP HCM"]}
2025-11-24 03:20:53.129 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 9.34s
2025-11-24 03:20:53.129 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Lương Thị Thuận'], 'organizations': ['HĐND', 'Uỷ ban Dân số Gia đình và Trẻ em TP HCM', 'Uỷ ban Dân số Gia đình và Trẻ em thành phố', 'UBND thành phố', 'Bộ Tài chính', 'Uỷ ban Dân số Gia đình và Trẻ em', 'Uỷ ban Dân số Gia đình và Trẻ em Việt Nam'], 'address': ['TP HCM']}
2025-11-24 03:20:53.129 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Lương Thị Thuận'], 'organizations': ['Uỷ ban Dân số Gia đình và Trẻ em TP HCM', 'Uỷ ban Dân số Gia đình và Trẻ em thành phố', 'Uỷ ban Dân số Gia đình và Trẻ em Việt Nam', 'Bộ Tài chính', 'HĐND', 'UBND thành phố'], 'address': ['TP HCM']}
Extracting entities:  51%|████████████████████████████████████▏                                  | 51/100 [14:07<12:57, 15.87s/it]2025-11-24 03:20:53.129 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 68.21it/s]
2025-11-24 03:20:53.147 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:21:03.339 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [9.932878494262695, 0.2689152657985687, -0.14971646666526794]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 290.50it/s]
Processed prompts: 100%|████████████████████| 1/1 [00:00<00:00,  1.58it/s, est. speed input: 1672.59 toks/s, output: 72.93 toks/s]
2025-11-24 03:21:03.974 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Bành Tiến Long"], "organizations": ["Bộ GDĐT", "Cục Khảo thí", "Ban chỉ đạo thi", "Sở GDĐT"], "address": ["Hà Nội"]}
2025-11-24 03:21:03.974 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 10.85s
2025-11-24 03:21:03.974 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Bành Tiến Long'], 'organizations': ['Cục Khảo thí', 'Bộ GDĐT', 'Ban chỉ đạo thi', 'Sở GDĐT'], 'address': ['Hà Nội']}
2025-11-24 03:21:03.974 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Bành Tiến Long'], 'organizations': ['Bộ GDĐT', 'Cục Khảo thí', 'Ban chỉ đạo thi', 'Sở GDĐT'], 'address': ['Hà Nội']}
Extracting entities:  52%|████████████████████████████████████▉                                  | 52/100 [14:17<11:29, 14.36s/it]2025-11-24 03:21:03.974 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 83.22it/s]
2025-11-24 03:21:03.990 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:21:07.444 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [6.8582444190979, -0.8249087929725647, -2.7426514625549316]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 304.97it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:01<00:00,  1.01s/it, est. speed input: 880.29 toks/s, output: 75.09 toks/s]
2025-11-24 03:21:08.461 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Jordan D. Ryan"],"organizations": ["UNDP", "Liên Hợp Quốc", "Chính phủ VN", "Đại học Colombia", "Đại học George Washington", "Đại học Yale", "trường Quản lý Nhà nước Kenedy", "Đại học Harvard"],"address": ["VN", "Liberia"]}
2025-11-24 03:21:08.461 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 4.49s
2025-11-24 03:21:08.461 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Jordan D. Ryan'], 'organizations': ['UNDP', 'Đại học Harvard', 'Liên Hợp Quốc', 'Đại học Colombia', 'Chương trình phát triển Liên Hợp Quốc', 'Chính phủ VN', 'Liên hợp quốc', 'Đại học George Washington', 'Đại học Yale', 'trường Quản lý Nhà nước Kenedy', 'UN'], 'address': ['Liberia', 'VN']}
2025-11-24 03:21:08.461 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Jordan D. Ryan'], 'organizations': ['UNDP', 'Liên Hợp Quốc', 'Chính phủ VN', 'Đại học Colombia', 'Đại học George Washington', 'Đại học Yale', 'trường Quản lý Nhà nước Kenedy', 'Đại học Harvard'], 'address': ['VN', 'Liberia']}
Extracting entities:  53%|█████████████████████████████████████▋                                 | 53/100 [14:22<08:55, 11.40s/it]2025-11-24 03:21:08.461 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 53.04it/s]
2025-11-24 03:21:08.484 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:21:17.283 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [10.047945022583008, -0.1524450033903122, -0.19600284099578857]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 238.27it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.06s/it, est. speed input: 746.87 toks/s, output: 74.40 toks/s]
2025-11-24 03:21:19.345 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Trần Cảnh Đào"], "organizations": ["Festival hoa", "Sở Văn hoá Thông tin Đà Lạt", "Ban tổ chức Festival", "Nhà hàng Thuỷ Tạ", "Khách sạn Công Đoàn"], "address": ["Đà Lạt", "Hồ Xuân Hương", "Sân vận động Đà Lạt", "Khu Hoà Bình", "chợ Đà Lạt", "đường Đinh Tiên Hoàng", "đường Hoàng Văn Thụ", "đường Trần Phú", "đường Trần Hưng Đạo", "đường Yersin", "Sân khấu chính", "trước cổng chợ Đà Lạt", "phía sau Sân vận động"]}
2025-11-24 03:21:19.345 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 10.88s
2025-11-24 03:21:19.345 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Lạc Long Quân', 'Trần Cảnh Đào', 'Âu', 'Cảnh Đào'], 'organizations': ['Festival hoa', 'Nhà hàng Thuỷ Tạ', 'Khách sạn Công Đoàn', 'Sở Văn hoá Thông tin Đà Lạt', 'Ban tổ chức Festival'], 'address': ['Đà Lạt', 'Hồ Xuân Hương', 'Sân vận động', 'Trần Phú', 'Việt Nam', 'Trần Hưng Đạo', 'Sân vận động Đà Lạt', 'Hồ Than Thở', 'Hoàng Văn Thụ', 'Yersin', 'Đinh Tiên Hoàng', 'Khu Hoà Bình', 'chợ Đà Lạt']}
2025-11-24 03:21:19.345 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Trần Cảnh Đào'], 'organizations': ['Festival hoa', 'Sở Văn hoá Thông tin Đà Lạt', 'Ban tổ chức Festival', 'Nhà hàng Thuỷ Tạ', 'Khách sạn Công Đoàn'], 'address': ['Đà Lạt', 'Hồ Xuân Hương', 'Sân vận động Đà Lạt', 'Khu Hoà Bình', 'chợ Đà Lạt', 'đường Đinh Tiên Hoàng', 'đường Hoàng Văn Thụ', 'đường Trần Phú', 'đường Trần Hưng Đạo', 'đường Yersin', 'Sân khấu chính', 'trước cổng chợ Đà Lạt', 'phía sau Sân vận động']}
Extracting entities:  54%|██████████████████████████████████████▎                                | 54/100 [14:33<08:37, 11.24s/it]2025-11-24 03:21:19.345 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 67.31it/s]
2025-11-24 03:21:19.364 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:21:36.136 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.446563720703125, -5.363099575042725, -5.970386505126953]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 235.21it/s]
Processed prompts: 100%|████████████████████| 1/1 [00:00<00:00,  1.25it/s, est. speed input: 1613.74 toks/s, output: 72.61 toks/s]
2025-11-24 03:21:36.941 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Nguyễn Văn Chiến"], "organizations": ["Hội đồng thẩm định", "Ban Quản lý dự án cải thiện môi trường TP HCM", "Công ty Tư vấn cấp thoát nước và môi trường Việt Nam"], "address": ["TP HCM"]}
2025-11-24 03:21:36.941 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 17.60s
2025-11-24 03:21:36.941 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Nguyễn Văn Chiến'], 'organizations': ['Hội đồng thẩm định', 'Công ty Tư vấn cấp thoát nước và môi trường Việt Nam', 'Ban Quản lý dự án cải thiện môi trường TP HCM'], 'address': ['TP HCM']}
2025-11-24 03:21:36.941 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Nguyễn Văn Chiến'], 'organizations': ['Hội đồng thẩm định', 'Ban Quản lý dự án cải thiện môi trường TP HCM', 'Công ty Tư vấn cấp thoát nước và môi trường Việt Nam'], 'address': ['TP HCM']}
Extracting entities:  55%|███████████████████████████████████████                                | 55/100 [14:50<09:51, 13.15s/it]2025-11-24 03:21:36.941 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 39.41it/s]
2025-11-24 03:21:36.970 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:21:58.930 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.445900917053223, -7.303133487701416, -8.337845802307129]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 219.30it/s]
Processed prompts: 100%|██████████████████████| 1/1 [00:28<00:00, 28.10s/it, est. speed input: 56.51 toks/s, output: 36.44 toks/s]
2025-11-24 03:22:27.036 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Nguyễn Chánh Khê", "Trần Đức Lương", "Lê Tiến Ba", "Nguyễn Huy Hoàng", "Lê Trọng Văn", "Nguyễn Việt Dũng", "Nguyễn Dy Niên"], "organizations": ["Uỷ ban Người Việt Nam ở nước ngoài", "Câu lạc bộ doanh nhân", "VnExpress", "Quỹ hỗ trợ kiều bào", "Bộ Ngoại giao"], "address": ["Việt Nam", "Hà Nội", "TP HCM", "Liên bang Nga", "Mỹ", "Đức", "California", "Sài Gòn", "Việt Nam", "Hà Nội", "Sài Gòn", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam", "Việt Nam",
2025-11-24 03:22:27.037 | INFO     | src.utils:parse_response:202 - No JSON found in response: {"person": ["Nguyễn Chánh Khê", "Trần Đức Lương", "Lê Tiến Ba", "Nguyễn Huy Hoàng", "Lê Trọng Văn", 
2025-11-24 03:22:27.037 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 50.10s
2025-11-24 03:22:27.037 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Nguyễn Huy Hoàng', 'Nguyễn Chánh Khê', 'Nguyễn Việt Dũng', 'Trần Đức Lương', 'Lê Trọng Văn', 'Nguyễn Dy Niên', 'Lê Tiến Ba'], 'organizations': ['Câu lạc bộ doanh nhân', 'VnExpress', 'Uỷ ban về Người Việt ở nước ngoài', 'Uỷ ban Người Việt Nam ở nước ngoài', 'Quỹ hỗ trợ kiều bào'], 'address': ['Nga', 'Mỹ', 'Việt Nam', 'Hà Nội', 'Liên bang Nga', 'VN', 'Sài Gòn', 'Việt', 'Văn Miếu', 'Đức', 'California', 'TP HCM']}
2025-11-24 03:22:27.037 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': [], 'organizations': [], 'address': []}
Extracting entities:  56%|███████████████████████████████████████▊                               | 56/100 [15:41<17:46, 24.23s/it]2025-11-24 03:22:27.037 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 44.02it/s]
2025-11-24 03:22:27.063 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:22:47.207 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.445745468139648, -5.195157527923584, -5.302742004394531]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 312.66it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:01<00:00,  1.12s/it, est. speed input: 933.30 toks/s, output: 74.81 toks/s]
2025-11-24 03:22:48.334 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Nguyễn Văn Đua"], "organizations": ["UBND TP HCM", "UBND quận 10", "Sở xây dụng TP HCM", "chung cư Ngô Gia Tự", "chung cư Nguyễn Kim"], "address": ["TP HCM", "quận 10", "khu trung tâm thương mại quận 10"]}
2025-11-24 03:22:48.335 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 21.30s
2025-11-24 03:22:48.335 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Nguyễn Văn Đua'], 'organizations': ['UBND quận 10', 'UBND TP HCM', 'Sở xây dụng TP HCM'], 'address': ['chung cư Ngô Gia Tự', 'khu trung tâm thương mại quận 10', 'chung cư Nguyễn Kim', 'TP HCM', 'quận 10']}
2025-11-24 03:22:48.335 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Nguyễn Văn Đua'], 'organizations': ['UBND TP HCM', 'UBND quận 10', 'Sở xây dụng TP HCM', 'chung cư Ngô Gia Tự', 'chung cư Nguyễn Kim'], 'address': ['TP HCM', 'quận 10', 'khu trung tâm thương mại quận 10']}
Extracting entities:  57%|████████████████████████████████████████▍                              | 57/100 [16:02<16:44, 23.35s/it]2025-11-24 03:22:48.335 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 25.06it/s]
2025-11-24 03:22:48.378 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:23:02.562 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [8.52099323272705, -7.709948539733887, -8.156083106994629]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 171.76it/s]
Processed prompts: 100%|████████████████████| 1/1 [00:01<00:00,  1.35s/it, est. speed input: 1563.07 toks/s, output: 71.32 toks/s]
2025-11-24 03:23:03.915 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Y.", "Nguyễn Hoài Chương", "Huỳnh Minh Trí"], "organizations": ["CCI", "ISE", "YFU", "AYUSA", "EF", "ASPECT Foundation"], "address": ["Mỹ", "VN", "California", "Kansas", "TP.HCM", "Indiana", "Hoa Kỳ", "bang Indiana", "Hoa Kỳ", "Trung Quốc", "châu Á"]}
2025-11-24 03:23:03.916 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 15.58s
2025-11-24 03:23:03.916 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Y.', 'Huỳnh Minh Trí', 'Nguyễn Hoài Chương'], 'organizations': ['ISE', 'CCI', 'EF', 'SLEP', 'TOEFL', 'Sở GD-ĐT TP.HCM', 'SAT', 'AYUSA', 'ASPECT Foundation', 'YFU'], 'address': ['Mỹ', 'VN', 'Indiana', 'Hoa Kỳ', 'Hàn Quốc', 'Thái Lan', 'Đức', 'Virginia', 'California', 'Kansas', 'TP.HCM']}
2025-11-24 03:23:03.916 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Y.', 'Nguyễn Hoài Chương', 'Huỳnh Minh Trí'], 'organizations': ['CCI', 'ISE', 'YFU', 'AYUSA', 'EF', 'ASPECT Foundation'], 'address': ['Mỹ', 'VN', 'California', 'Kansas', 'TP.HCM', 'Indiana', 'Hoa Kỳ', 'bang Indiana', 'Hoa Kỳ', 'Trung Quốc', 'châu Á']}
Extracting entities:  58%|█████████████████████████████████████████▏                             | 58/100 [16:17<14:42, 21.02s/it]2025-11-24 03:23:03.916 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 21.12it/s]
2025-11-24 03:23:03.967 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:23:18.348 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [8.765989303588867, 0.42735275626182556, 0.23864074051380157]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 142.84it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.95s/it, est. speed input: 888.03 toks/s, output: 72.56 toks/s]
2025-11-24 03:23:21.305 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Bùi Duy Cam", "Phạm Đức Vọng", "Phan Huy Phú", "Dương Thị Mai Phương", "Nguyễn Hồng Đào"], "organizations": ["ĐH Khoa học tự nhiên Hà Nội", "Đại học Mở Hà Nội", "Viện ĐH Mở Hà Nội", "ĐH dân lập Thăng Long", "ĐH dân lập Phương Đông", "trường Lao động - Xã hội", "ĐH dân lập Văn Lang", "ĐH dân lập Hồng Bàng", "ĐH Mở bán công TP HCM", "ĐH dân lập Văn Hiến", "ĐH dân lập Bình Dương", "ĐH Luật TP HCM", "ĐH Xã hội và nhân văn TP HCM", "Bộ GDĐT"], "address": ["phía Bắc", "phía Nam", "Hà Nội", "TP HCM", "Nam", "Bắc", "miền Bắc", "miền Nam"]}
2025-11-24 03:23:21.305 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 17.39s
2025-11-24 03:23:21.305 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Bùi Duy Cam', 'Phạm Đức Vọng', 'Phan Huy Phú', 'Dương Thị Mai Phương', 'Nguyễn Hồng Đào'], 'organizations': ['ĐH dân lập Văn Lang', 'Đại học Mở Hà Nội', 'VnExpress', 'ĐH Xã hội và nhân văn TP HCM', 'ĐH Văn Lang', 'ĐH Luật TP HCM', 'Bộ GDĐT', 'ĐH dân lập Văn Hiến', 'ĐH dân lập Bình Dương', 'ĐH dân lập Phương Đông', 'trường Lao động - Xã hội', 'Viện ĐH Mở Hà Nội', 'ĐH Dân lập Hồng Bàng', 'ĐH Mở bán công TP HCM', 'ĐH dân lập Thăng Long', 'ĐH Khoa học tự nhiên Hà Nội'], 'address': ['phía Nam', 'miền Bắc', 'Nam', 'Bắc', 'phía Bắc', 'miền Nam']}
2025-11-24 03:23:21.305 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Bùi Duy Cam', 'Phạm Đức Vọng', 'Phan Huy Phú', 'Dương Thị Mai Phương', 'Nguyễn Hồng Đào'], 'organizations': ['ĐH Khoa học tự nhiên Hà Nội', 'Đại học Mở Hà Nội', 'Viện ĐH Mở Hà Nội', 'ĐH dân lập Thăng Long', 'ĐH dân lập Phương Đông', 'trường Lao động - Xã hội', 'ĐH dân lập Văn Lang', 'ĐH dân lập Hồng Bàng', 'ĐH Mở bán công TP HCM', 'ĐH dân lập Văn Hiến', 'ĐH dân lập Bình Dương', 'ĐH Luật TP HCM', 'ĐH Xã hội và nhân văn TP HCM', 'Bộ GDĐT'], 'address': ['phía Bắc', 'phía Nam', 'Hà Nội', 'TP HCM', 'Nam', 'Bắc', 'miền Bắc', 'miền Nam']}
Extracting entities:  59%|█████████████████████████████████████████▉                             | 59/100 [16:35<13:37, 19.93s/it]2025-11-24 03:23:21.305 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 85.40it/s]
2025-11-24 03:23:21.321 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:23:24.024 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.444613456726074, -3.6129281520843506, -4.912298679351807]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 314.96it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:01<00:00,  1.58s/it, est. speed input: 573.94 toks/s, output: 75.93 toks/s]
2025-11-24 03:23:25.608 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": [], "organizations": ["Festival thanh niên sinh viên thế giới Trung ương Đoàn", "Festival thanh niên sinh viên thế giới", "Liên hoan lần này", "Tòa án quốc tế chống chủ nghĩa đế quốc", "Câu lạc bộ khu vực", "Hội nghị chuyên đề", "Các buổi giao lưu gặp gỡ"], "address": ["Việt Nam", "Caracas", "Venezuela", "châu Á", "100 quốc gia và vùng lãnh thổ", "19 nước"]}
2025-11-24 03:23:25.608 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 4.30s
2025-11-24 03:23:25.608 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': [], 'organizations': ['Festival thanh niên sinh viên thế giới', 'Trung ương Đoàn'], 'address': ['châu Á', 'Venezuela', 'Việt Nam', 'Caracas']}
2025-11-24 03:23:25.608 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': [], 'organizations': ['Festival thanh niên sinh viên thế giới Trung ương Đoàn', 'Festival thanh niên sinh viên thế giới', 'Liên hoan lần này', 'Tòa án quốc tế chống chủ nghĩa đế quốc', 'Câu lạc bộ khu vực', 'Hội nghị chuyên đề', 'Các buổi giao lưu gặp gỡ'], 'address': ['Việt Nam', 'Caracas', 'Venezuela', 'châu Á', '100 quốc gia và vùng lãnh thổ', '19 nước']}
Extracting entities:  60%|██████████████████████████████████████████▌                            | 60/100 [16:39<10:09, 15.24s/it]2025-11-24 03:23:25.609 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 83.25it/s]
2025-11-24 03:23:25.624 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:23:30.561 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [10.945775032043457, 0.03836189582943916, -0.06399092078208923]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 285.89it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:01<00:00,  1.34s/it, est. speed input: 705.25 toks/s, output: 75.46 toks/s]
2025-11-24 03:23:31.904 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Nguyễn Chơn Trung"], "organizations": ["Ủy ban người Việt Nam ở nước ngoài tại TP HCM", "UBND thành phố", "Chính phủ", "Ủy ban người Việt Nam ở nước ngoài", "Ngân hàng Thế giới (WB)", "Sở Giao thông công chính TP HCM", "Sở Y tế"], "address": ["TP HCM", "Việt Nam", "sân bay Tân Sơn Nhất"]}
2025-11-24 03:23:31.904 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 6.30s
2025-11-24 03:23:31.904 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Nguyễn Chơn Trung'], 'organizations': ['Ủy ban người Việt Nam ở nước ngoài', 'Chính phủ', 'UBND thành phố', 'Ủy ban người Việt Nam ở nước ngoài tại TP HCM'], 'address': ['TP HCM', 'Việt Nam', 'sân bay Tân Sơn Nhất']}
2025-11-24 03:23:31.904 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Nguyễn Chơn Trung'], 'organizations': ['Ủy ban người Việt Nam ở nước ngoài tại TP HCM', 'UBND thành phố', 'Chính phủ', 'Ủy ban người Việt Nam ở nước ngoài', 'Ngân hàng Thế giới (WB)', 'Sở Giao thông công chính TP HCM', 'Sở Y tế'], 'address': ['TP HCM', 'Việt Nam', 'sân bay Tân Sơn Nhất']}
Extracting entities:  61%|███████████████████████████████████████████▎                           | 61/100 [16:45<08:09, 12.56s/it]2025-11-24 03:23:31.905 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 85.07it/s]
2025-11-24 03:23:31.920 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:23:34.177 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.208196640014648, 2.044715404510498, 1.4541738033294678]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 316.50it/s]
Processed prompts: 100%|████████████████████| 1/1 [00:00<00:00,  1.64it/s, est. speed input: 1451.61 toks/s, output: 73.81 toks/s]
2025-11-24 03:23:34.791 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": [], "organizations": ["Công ty Textion Plastic Lighter", "công ty TNHH Textion Plastic Lighter"], "address": ["Bình Dương", "Thủ Dầu Một"]}
2025-11-24 03:23:34.791 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 2.89s
2025-11-24 03:23:34.791 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': [], 'organizations': ['Công ty Textion Plastic Lighter', 'công ty TNHH Textion Plastic Lighter'], 'address': ['Bình Dương', 'Thủ Dầu Một']}
2025-11-24 03:23:34.791 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': [], 'organizations': ['Công ty Textion Plastic Lighter', 'công ty TNHH Textion Plastic Lighter'], 'address': ['Bình Dương', 'Thủ Dầu Một']}
Extracting entities:  62%|████████████████████████████████████████████                           | 62/100 [16:48<06:06,  9.66s/it]2025-11-24 03:23:34.792 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 63.18it/s]
2025-11-24 03:23:34.811 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:23:46.512 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [7.656477928161621, -10.329870223999023, -10.55845832824707]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 277.11it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:01<00:00,  1.74s/it, est. speed input: 646.64 toks/s, output: 75.36 toks/s]
2025-11-24 03:23:48.255 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Ông Vũ Mạnh Cường", "Nguyễn Tấn Dũng", "Thành Vinh"], "organizations": ["Thủ tướng Chính phủ", "Bộ Xây dựng", "Cục quản lý nhà", "UBND cấp huyện", "Chính phủ", "Ủy ban Thường vụ Quốc hội", "Bộ Công an", "VnExpress", "UBND", "Bộ Y tế", "Cục Thú y", "OIE"], "address": ["Việt Nam", "Hà Nội", "TP HCM", "Bình Dương", "nước ngoài"]}
2025-11-24 03:23:48.255 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 13.46s
2025-11-24 03:23:48.255 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Vũ Mạnh Cường'], 'organizations': ['UBND cấp huyện', 'Thủ tướng Chính phủ', 'Chính phủ', 'Bộ Xây dựng', 'Cục quản lý nhà', 'Ủy ban Thường vụ Quốc hội'], 'address': ['Việt Nam']}
2025-11-24 03:23:48.255 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Ông Vũ Mạnh Cường', 'Nguyễn Tấn Dũng', 'Thành Vinh'], 'organizations': ['Thủ tướng Chính phủ', 'Bộ Xây dựng', 'Cục quản lý nhà', 'UBND cấp huyện', 'Chính phủ', 'Ủy ban Thường vụ Quốc hội', 'Bộ Công an', 'VnExpress', 'UBND', 'Bộ Y tế', 'Cục Thú y', 'OIE'], 'address': ['Việt Nam', 'Hà Nội', 'TP HCM', 'Bình Dương', 'nước ngoài']}
Extracting entities:  63%|████████████████████████████████████████████▋                          | 63/100 [17:02<06:39, 10.80s/it]2025-11-24 03:23:48.256 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|█████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 115.26it/s]
2025-11-24 03:23:48.268 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:23:53.024 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [10.220328330993652, -4.927033424377441, -5.527062892913818]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 347.10it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:00<00:00,  1.19it/s, est. speed input: 928.71 toks/s, output: 75.30 toks/s]
2025-11-24 03:23:53.865 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Nguyễn Văn Đua"], "organizations": ["Ngân hàng Thế giới (WB)", "UBND TP HCM", "Sở Giao thông công chính TP HCM", "Sở Y tế"], "address": ["Nhiêu Lộc - Thị Nghè"]}
2025-11-24 03:23:53.865 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 5.61s
2025-11-24 03:23:53.865 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Nguyễn Văn Đua'], 'organizations': ['Ngân hàng Thế giới (WB)', 'Sở Giao thông công chính TP HCM', 'WB', 'UBND TP HCM', 'Sở Y tế'], 'address': ['Nhiêu Lộc - Thị Nghè']}
2025-11-24 03:23:53.865 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Nguyễn Văn Đua'], 'organizations': ['Ngân hàng Thế giới (WB)', 'UBND TP HCM', 'Sở Giao thông công chính TP HCM', 'Sở Y tế'], 'address': ['Nhiêu Lộc - Thị Nghè']}
Extracting entities:  64%|█████████████████████████████████████████████▍                         | 64/100 [17:07<05:32,  9.24s/it]2025-11-24 03:23:53.865 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 54.79it/s]
2025-11-24 03:23:53.887 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:24:12.527 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [8.82132625579834, 0.19117119908332825, -0.192696213722229]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 241.09it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:03<00:00,  3.69s/it, est. speed input: 341.91 toks/s, output: 36.33 toks/s]
2025-11-24 03:24:16.221 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Bùi Quang Anh", "Tôn Thất Hàn"], "organizations": ["Cục Thú y", "UBND tỉnh", "VnExpress"], "address": ["Hải Phòng", "Đà Nẵng", "Lâm Đồng", "Bình Dương", "Tây Ninh", "Long An", "TP HCM", "Đồng Tháp Mười", "Tứ Giác Long Xuyên", "Mỹ Thuận", "Cần Thơ", "Bình Thuận", "Thanh Hóa", "miền Trung", "Tây Nguyên", "Mộc Hóa"]}
2025-11-24 03:24:16.221 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 22.36s
2025-11-24 03:24:16.221 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Bùi Quang Anh', 'Tôn Thất Hàn'], 'organizations': ['VnExpress', 'UBND tỉnh'], 'address': ['Đà Nẵng', 'Tây Ninh', 'Bình Dương', 'TP HCM', 'Hải Phòng', 'Long An', 'Lâm Đồng']}
2025-11-24 03:24:16.221 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Bùi Quang Anh', 'Tôn Thất Hàn'], 'organizations': ['Cục Thú y', 'UBND tỉnh', 'VnExpress'], 'address': ['Hải Phòng', 'Đà Nẵng', 'Lâm Đồng', 'Bình Dương', 'Tây Ninh', 'Long An', 'TP HCM', 'Đồng Tháp Mười', 'Tứ Giác Long Xuyên', 'Mỹ Thuận', 'Cần Thơ', 'Bình Thuận', 'Thanh Hóa', 'miền Trung', 'Tây Nguyên', 'Mộc Hóa']}
Extracting entities:  65%|██████████████████████████████████████████████▏                        | 65/100 [17:30<07:41, 13.18s/it]2025-11-24 03:24:16.221 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 57.13it/s]
2025-11-24 03:24:16.242 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:24:22.932 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.435641288757324, -2.401158094406128, -2.9211513996124268]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 305.84it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:01<00:00,  1.08s/it, est. speed input: 680.17 toks/s, output: 36.09 toks/s]
2025-11-24 03:24:24.017 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": [], "organizations": ["Trung tâm Xúc tiến Thương mại và Đầu tư TPHCM", "WTO"], "address": ["VN", "TPHCM"]}
2025-11-24 03:24:24.017 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 7.80s
2025-11-24 03:24:24.017 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': [], 'organizations': ['WTO', 'NLĐ', 'Trung tâm Xúc tiến Thương mại và Đầu tư TPHCM'], 'address': ['VN', 'TPHCM']}
2025-11-24 03:24:24.017 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': [], 'organizations': ['Trung tâm Xúc tiến Thương mại và Đầu tư TPHCM', 'WTO'], 'address': ['VN', 'TPHCM']}
Extracting entities:  66%|██████████████████████████████████████████████▊                        | 66/100 [17:38<06:33, 11.56s/it]2025-11-24 03:24:24.017 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 29.58it/s]
2025-11-24 03:24:24.055 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:24:43.643 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [6.36820650100708, 0.8293405175209045, 0.3763113021850586]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 272.39it/s]
Processed prompts: 100%|████████████████████| 1/1 [00:00<00:00,  1.41it/s, est. speed input: 1476.03 toks/s, output: 33.93 toks/s]
2025-11-24 03:24:44.355 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["chú tiểu", "hai vị sư già"], "organizations": [], "address": []}
2025-11-24 03:24:44.355 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 20.34s
2025-11-24 03:24:44.355 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': [], 'organizations': [], 'address': []}
2025-11-24 03:24:44.355 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['chú tiểu', 'hai vị sư già'], 'organizations': [], 'address': []}
Extracting entities:  67%|███████████████████████████████████████████████▌                       | 67/100 [17:58<07:48, 14.20s/it]2025-11-24 03:24:44.355 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 47.86it/s]
2025-11-24 03:24:44.379 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:24:55.751 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [9.345908164978027, 2.408592939376831, 2.3444013595581055]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 303.69it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:01<00:00,  1.63s/it, est. speed input: 606.02 toks/s, output: 35.58 toks/s]
2025-11-24 03:24:57.386 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Blaise Compaore", "Nông Đức Mạnh", "Nguyễn Văn An"], "organizations": ["Đảng Cộng sản Việt Nam", "Burkina Faso"], "address": ["Việt Nam", "Burkina Faso"]}
2025-11-24 03:24:57.386 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 13.03s
2025-11-24 03:24:57.386 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Nông Đức Mạnh', 'Nguyễn Văn An', 'Blaise Compaore'], 'organizations': ['Nhà nước', 'Đảng Cộng sản Việt Nam', 'Đảng', 'Quốc hội'], 'address': ['Việt Nam', 'VN', 'Burkina Faso']}
2025-11-24 03:24:57.386 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Blaise Compaore', 'Nông Đức Mạnh', 'Nguyễn Văn An'], 'organizations': ['Đảng Cộng sản Việt Nam', 'Burkina Faso'], 'address': ['Việt Nam', 'Burkina Faso']}
Extracting entities:  68%|████████████████████████████████████████████████▎                      | 68/100 [18:11<07:23, 13.85s/it]2025-11-24 03:24:57.386 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 20.10it/s]
2025-11-24 03:24:57.440 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:25:18.447 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.444334983825684, -5.376261234283447, -5.544196128845215]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 212.91it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:03<00:00,  3.84s/it, est. speed input: 436.44 toks/s, output: 35.44 toks/s]
2025-11-24 03:25:22.291 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Nguyễn Văn Long", "Vũ Thúy", "Trần Thị Minh Tuyết", "Nguyễn Hồng Vũ Minh", "Nguyễn Thanh Tâm", "Hà Vân"], "organizations": ["Trường Nguyễn Đình Chiểu"], "address": ["trường", "các trường đại học trong và ngoài nước", "mẫu giáo", "cấp 2", "cấp 1", "trung học cơ sở", "trung học phổ thông", "đại học", "cơ sở", "các cơ sở", "môi trường làm việc", "các công ty"]}
2025-11-24 03:25:22.291 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 24.90s
2025-11-24 03:25:22.291 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Hà Vân', 'Trần Thị Minh Tuyết', 'Nguyễn Hồng Vũ Minh', 'Vũ Thúy', 'Nguyễn Văn Long', 'Nguyễn Thanh Tâm'], 'organizations': ['Trường Nguyễn Đình Chiểu'], 'address': ['cả nước']}
2025-11-24 03:25:22.291 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Nguyễn Văn Long', 'Vũ Thúy', 'Trần Thị Minh Tuyết', 'Nguyễn Hồng Vũ Minh', 'Nguyễn Thanh Tâm', 'Hà Vân'], 'organizations': ['Trường Nguyễn Đình Chiểu'], 'address': ['trường', 'các trường đại học trong và ngoài nước', 'mẫu giáo', 'cấp 2', 'cấp 1', 'trung học cơ sở', 'trung học phổ thông', 'đại học', 'cơ sở', 'các cơ sở', 'môi trường làm việc', 'các công ty']}
Extracting entities:  69%|████████████████████████████████████████████████▉                      | 69/100 [18:36<08:52, 17.16s/it]2025-11-24 03:25:22.291 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 27.49it/s]
2025-11-24 03:25:22.331 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:25:42.626 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [10.176280975341797, -4.365607738494873, -4.372844219207764]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 237.06it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.65s/it, est. speed input: 579.81 toks/s, output: 35.51 toks/s]
2025-11-24 03:25:45.278 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Tào Hữu Phùng", "Phạm Quang Dự", "Thủ tướng Chính phủ"], "organizations": ["Tổ chức OPEC", "OPEC", "Ủy ban Kinh tế - ngân sách", "Bộ Tài chính", "Bộ Kế hoạch - đầu tư", "Chính phủ", "QH", "Ủy ban Kinh tế - ngân sách của QH"], "address": []}
2025-11-24 03:25:45.278 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 22.99s
2025-11-24 03:25:45.279 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Dự', 'Thủ tướng Chính phủ', 'Tào Hữu Phùng', 'Phạm Quang Dự'], 'organizations': ['Tổ chức OPEC', 'OPEC', 'Ủy ban Kinh tế - ngân sách', 'Ủy ban Kinh tế ngân sách', 'Chính phủ', 'Bộ Kế hoạch - đầu tư', 'QH', 'Bộ Tài chính', 'Ủy ban Kinh tế - ngân sách của QH'], 'address': []}
2025-11-24 03:25:45.279 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Tào Hữu Phùng', 'Phạm Quang Dự', 'Thủ tướng Chính phủ'], 'organizations': ['Tổ chức OPEC', 'OPEC', 'Ủy ban Kinh tế - ngân sách', 'Bộ Tài chính', 'Bộ Kế hoạch - đầu tư', 'Chính phủ', 'QH', 'Ủy ban Kinh tế - ngân sách của QH'], 'address': []}
Extracting entities:  70%|█████████████████████████████████████████████████▋                     | 70/100 [18:59<09:27, 18.91s/it]2025-11-24 03:25:45.279 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 42.23it/s]
2025-11-24 03:25:45.306 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:26:02.459 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.213752746582031, 0.2750938832759857, -1.5318390130996704]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 289.46it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.63s/it, est. speed input: 444.26 toks/s, output: 36.07 toks/s]
2025-11-24 03:26:05.097 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Ngà"], "organizations": ["Trung tâm dự báo khí tượng thủy văn trung ương", "Phòng dự báo hạn ngắn"], "address": ["Bắc Bộ", "Bắc Trung Bộ", "Nghệ An", "Thừa Thiên - Huế", "Hà Nội", "vùng núi phía Bắc", "Đà Nẵng", "Bình Thuận", "Nam Bộ", "Tây Nguyên"]}
2025-11-24 03:26:05.097 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 19.82s
2025-11-24 03:26:05.097 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Ngà'], 'organizations': ['Trung tâm dự báo khí tượng thủy văn trung ương', 'Phòng dự báo hạn ngắn'], 'address': ['Tây Nguyên', 'Đà Nẵng', 'Nam Bộ', 'Hà Nội', 'Bình Thuận', 'Bắc Bộ', 'Bắc Trung Bộ', 'Nghệ An', 'Thừa Thiên - Huế']}
2025-11-24 03:26:05.097 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Ngà'], 'organizations': ['Trung tâm dự báo khí tượng thủy văn trung ương', 'Phòng dự báo hạn ngắn'], 'address': ['Bắc Bộ', 'Bắc Trung Bộ', 'Nghệ An', 'Thừa Thiên - Huế', 'Hà Nội', 'vùng núi phía Bắc', 'Đà Nẵng', 'Bình Thuận', 'Nam Bộ', 'Tây Nguyên']}
Extracting entities:  71%|██████████████████████████████████████████████████▍                    | 71/100 [19:19<09:16, 19.18s/it]2025-11-24 03:26:05.097 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 38.35it/s]
2025-11-24 03:26:05.127 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:26:16.377 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [9.001897811889648, 4.026828765869141, 3.1736273765563965]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 288.13it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:01<00:00,  1.70s/it, est. speed input: 602.67 toks/s, output: 35.87 toks/s]
2025-11-24 03:26:18.082 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Nguyễn Cao Váng"], "organizations": ["Công ty Xăng dầu khu vực I", "UBND thành phố"], "address": ["Hà Nội", "Gia Lâm", "Phú Thị", "Đức Giang", "Bắc"]}
2025-11-24 03:26:18.082 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 12.98s
2025-11-24 03:26:18.082 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Nguyễn Cao Váng'], 'organizations': ['Công ty Xăng dầu khu vực I', 'UBND thành phố'], 'address': ['Hà Nội', 'Gia Lâm', 'Đức Giang', 'Phú Thị', 'Bắc']}
2025-11-24 03:26:18.082 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Nguyễn Cao Váng'], 'organizations': ['Công ty Xăng dầu khu vực I', 'UBND thành phố'], 'address': ['Hà Nội', 'Gia Lâm', 'Phú Thị', 'Đức Giang', 'Bắc']}
Extracting entities:  72%|███████████████████████████████████████████████████                    | 72/100 [19:32<08:05, 17.32s/it]2025-11-24 03:26:18.082 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 13.18it/s]
2025-11-24 03:26:18.162 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:26:38.769 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [10.966156959533691, 0.248353973031044, 0.06284178793430328]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 169.56it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:04<00:00,  4.53s/it, est. speed input: 498.09 toks/s, output: 34.88 toks/s]
2025-11-24 03:26:43.305 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Nguyễn Văn Thọ", "Nguyễn Thị Hải Vân", "Như Trang"], "organizations": ["VnExpress", "Công ty cổ phần dịch vụ thương mại Thái Sơn", "Công ty Đầu tư và Dịch vụ Thương mại Văn Thụ", "Công ty TNHH Nguồn việc làm", "Bộ Lao động Thương binh và Xã hội", "Sở Kế hoạch và Đầu tư", "Vụ Lao động Việc làm"], "address": ["đường Láng", "quận Đống Đa", "Hà Nội", "74 đường Láng", "232 đường Láng", "970 đường Láng", "64 tỉnh thành"]}
2025-11-24 03:26:43.305 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 25.22s
2025-11-24 03:26:43.305 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Nguyễn Thị Hải Vân', 'Nguyễn Văn Thọ', 'Vân', 'Như Trang'], 'organizations': ['Vụ Lao động Việc làm', 'Công ty cổ phần dịch vụ thương mại Thái Sơn', 'VnExpress', 'Bộ Lao động Thương binh và Xã hội', 'Công ty TNHH Nguồn việc làm', 'Chính phủ', 'Sở Kế hoạch và Đầu tư', 'Cao đẳng Sư phạm Hà Nội', 'Công ty Đầu tư và Dịch vụ Thương mại Văn Thụ'], 'address': ['64 tỉnh thành', 'quận Đống Đa', 'Hà Nội', '232 đường Láng', 'đường Láng', 'Cả nước']}
2025-11-24 03:26:43.305 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Nguyễn Văn Thọ', 'Nguyễn Thị Hải Vân', 'Như Trang'], 'organizations': ['VnExpress', 'Công ty cổ phần dịch vụ thương mại Thái Sơn', 'Công ty Đầu tư và Dịch vụ Thương mại Văn Thụ', 'Công ty TNHH Nguồn việc làm', 'Bộ Lao động Thương binh và Xã hội', 'Sở Kế hoạch và Đầu tư', 'Vụ Lao động Việc làm'], 'address': ['đường Láng', 'quận Đống Đa', 'Hà Nội', '74 đường Láng', '232 đường Láng', '970 đường Láng', '64 tỉnh thành']}
Extracting entities:  73%|███████████████████████████████████████████████████▊                   | 73/100 [19:57<08:51, 19.69s/it]2025-11-24 03:26:43.305 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 46.56it/s]
2025-11-24 03:26:43.330 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:26:58.843 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [6.5186662673950195, -2.235853433609009, -2.662956953048706]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 296.23it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:01<00:00,  1.41s/it, est. speed input: 750.11 toks/s, output: 75.22 toks/s]
2025-11-24 03:27:00.257 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Ngô Quyền", "C.D", "T.N", "Nguyễn Trung Kiên", "Lê Tất Vinh"], "organizations": ["Sở Văn hóa - Thông tin Hải Phòng", "PA25"], "address": ["hồ Tam Bạc", "đường Minh Khai", "quận Hồng Bàng", "đường Chùa Hàng", "Lê Chân", "Hải Phòng", "Anh Quốc", "Lào"]}
2025-11-24 03:27:00.257 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 16.95s
2025-11-24 03:27:00.257 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['T.N', 'Lê Tất Vinh', 'Nguyễn Trung Kiên', 'C.D'], 'organizations': ['Sở Văn hóa - Thông tin Hải Phòng', 'Phòng Bảo vệ an ninh văn hóa - tư tưởng', 'Sở', 'PA25'], 'address': ['Anh Quốc', 'Lào', 'Lê Chân', 'đường Minh Khai', 'quận Hồng Bàng', 'hồ Tam Bạc', 'đường Chùa Hàng', 'Hải Phòng']}
2025-11-24 03:27:00.257 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Ngô Quyền', 'C.D', 'T.N', 'Nguyễn Trung Kiên', 'Lê Tất Vinh'], 'organizations': ['Sở Văn hóa - Thông tin Hải Phòng', 'PA25'], 'address': ['hồ Tam Bạc', 'đường Minh Khai', 'quận Hồng Bàng', 'đường Chùa Hàng', 'Lê Chân', 'Hải Phòng', 'Anh Quốc', 'Lào']}
Extracting entities:  74%|████████████████████████████████████████████████████▌                  | 74/100 [20:14<08:10, 18.87s/it]2025-11-24 03:27:00.257 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 52.90it/s]
2025-11-24 03:27:00.280 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:27:12.480 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [10.592939376831055, 0.012428181245923042, -0.6149494051933289]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 240.36it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.21s/it, est. speed input: 677.18 toks/s, output: 74.14 toks/s]
2025-11-24 03:27:14.697 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Lê Hoàng Bình", "Nguyễn Quốc Hợp", "Đỗ Quốc Anh", "Bành Tiến Long"],"organizations": ["ĐH Dân lập Kỹ thuật Công nghệ Sài Gòn", "ĐH Dân lập Kỹ thuật công nghệ", "ĐH dân lập Văn Hiến", "Bộ Giáo dục và Đào tạo", "VnExpress", "ĐH dân lập Ngoại ngữ Tin học", "Đại học Văn Hiến", "Văn Hiến", "Công nghệ Sài gòn", "Bộ", "Đoàn công tác của Bộ", "Giám đốc Văn phòng đại diện Bộ Giáo dục và đào tạo tại TP HCM"],"address": ["phía Nam", "Huế", "TP HCM"]}
2025-11-24 03:27:14.698 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 14.44s
2025-11-24 03:27:14.698 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Bành Tiến Long', 'Nguyễn Quốc Hợp', 'Lê Hoàng Bình', 'Đỗ Quốc Anh'], 'organizations': ['ĐH Dân lập Kỹ thuật Công nghệ Sài Gòn', 'ĐH Dân lập Kỹ thuật công nghệ', 'Bộ Giáo dục và Đào tạo', 'VnExpress', 'ĐH dân lập', 'ĐH dân lập Ngoại ngữ Tin học', 'ĐH Văn Hiến', 'ĐH dân lập Văn Hiến', 'Văn Hiến', 'Bộ', 'Công nghệ Sài gòn', 'Bộ Giáo dục và đào tạo', 'Đoàn công tác của Bộ'], 'address': ['phía Nam', 'TP HCM', 'Huế']}
2025-11-24 03:27:14.698 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Lê Hoàng Bình', 'Nguyễn Quốc Hợp', 'Đỗ Quốc Anh', 'Bành Tiến Long'], 'organizations': ['ĐH Dân lập Kỹ thuật Công nghệ Sài Gòn', 'ĐH Dân lập Kỹ thuật công nghệ', 'ĐH dân lập Văn Hiến', 'Bộ Giáo dục và Đào tạo', 'VnExpress', 'ĐH dân lập Ngoại ngữ Tin học', 'Đại học Văn Hiến', 'Văn Hiến', 'Công nghệ Sài gòn', 'Bộ', 'Đoàn công tác của Bộ', 'Giám đốc Văn phòng đại diện Bộ Giáo dục và đào tạo tại TP HCM'], 'address': ['phía Nam', 'Huế', 'TP HCM']}
Extracting entities:  75%|█████████████████████████████████████████████████████▎                 | 75/100 [20:28<07:18, 17.54s/it]2025-11-24 03:27:14.698 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 63.91it/s]
2025-11-24 03:27:14.717 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:27:28.161 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.446419715881348, 4.599300861358643, 4.3495025634765625]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 258.24it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:01<00:00,  1.35s/it, est. speed input: 843.08 toks/s, output: 74.96 toks/s]
2025-11-24 03:27:29.513 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Nguyễn Văn Chiến"], "organizations": ["Công ty TNHH Thương Tuyến", "Emma", "Sở Tài nguyên và Môi trường", "Lemma", "Bộ Kế hoạch và Đầu tư", "UBND thành phố", "Thủ tướng"], "address": ["TP HCM", "Tây Bắc - Phước Hiệp - Củ Chi", "Phước Hiệp, Củ Chi", "Đông Thạnh", "Mỹ"]}
2025-11-24 03:27:29.513 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 14.82s
2025-11-24 03:27:29.513 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Nguyễn Văn Chiến', 'Thủ tướng'], 'organizations': ['Bộ Kế hoạch và Đầu tư', 'Emma', 'Sở Tài nguyên và Môi trường', 'UBND thành phố', 'Công ty TNHH Thương Tuyến', 'Lemma'], 'address': ['Mỹ', 'Việt Nam', 'Tây Bắc - Phước Hiệp - Củ Chi', 'Phước Hiệp, Củ Chi', 'Pháp', 'Đông Thạnh', 'TP HCM']}
2025-11-24 03:27:29.513 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Nguyễn Văn Chiến'], 'organizations': ['Công ty TNHH Thương Tuyến', 'Emma', 'Sở Tài nguyên và Môi trường', 'Lemma', 'Bộ Kế hoạch và Đầu tư', 'UBND thành phố', 'Thủ tướng'], 'address': ['TP HCM', 'Tây Bắc - Phước Hiệp - Củ Chi', 'Phước Hiệp, Củ Chi', 'Đông Thạnh', 'Mỹ']}
Extracting entities:  76%|█████████████████████████████████████████████████████▉                 | 76/100 [20:43<06:41, 16.72s/it]2025-11-24 03:27:29.513 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 26.79it/s]
2025-11-24 03:27:29.554 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:27:45.532 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [9.66988754272461, -2.0163846015930176, -3.5884323120117188]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 180.22it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.25s/it, est. speed input: 904.84 toks/s, output: 73.33 toks/s]
2025-11-24 03:27:47.789 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Lê Thanh Hải", "Lê Trường Giang", "ông Hải", "ông Thảo", "Nguyễn Tấn Dũng", "Thành Vinh", "Nguyễn Phước Thảo", "Phạm Văn Bự"], "organizations": ["Sở Y tế", "Sở Thương mại", "Sở Nông nghiệp và Phát triển nông thôn (NNPTNT)", "Công ty chế biến Gia Cầm CP", "Công ty Liên doanh KFC VN", "Công ty KFC", "Tổng công ty Nông nghiệp Sài Gòn", "Bộ Nông nghiệp và Phát triển nông thôn", "Cục Thú y"], "address": ["TP HCM", "Đồng Nai", "Long Thành"]}
2025-11-24 03:27:47.789 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 18.28s
2025-11-24 03:27:47.789 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Nguyễn Phước Thảo', 'Phạm Văn Bự', 'ông Hải', 'ông Thảo', 'Lê Thanh Hải', 'Lê Trường Giang'], 'organizations': ['CP', 'Sở NNPTNT', 'Sở Nông nghiệp và Phát triển nông thôn (NNPTNT)', 'Sở Thương mại', 'Công ty Liên doanh KFC VN', 'Công ty chế biến Gia Cầm CP', 'Tổng công ty Nông nghiệp Sài Gòn', 'Sở Y tế', 'KFC', 'Bộ NNPTNT', 'Bộ Nông nghiệp và Phát triển nông thôn', 'Công ty KFC'], 'address': ['miền Tây', 'Đồng Nai', 'TP HCM', 'Long Thành', 'miền Đông']}
2025-11-24 03:27:47.789 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Lê Thanh Hải', 'Lê Trường Giang', 'ông Hải', 'ông Thảo', 'Nguyễn Tấn Dũng', 'Thành Vinh', 'Nguyễn Phước Thảo', 'Phạm Văn Bự'], 'organizations': ['Sở Y tế', 'Sở Thương mại', 'Sở Nông nghiệp và Phát triển nông thôn (NNPTNT)', 'Công ty chế biến Gia Cầm CP', 'Công ty Liên doanh KFC VN', 'Công ty KFC', 'Tổng công ty Nông nghiệp Sài Gòn', 'Bộ Nông nghiệp và Phát triển nông thôn', 'Cục Thú y'], 'address': ['TP HCM', 'Đồng Nai', 'Long Thành']}
Extracting entities:  77%|██████████████████████████████████████████████████████▋                | 77/100 [21:01<06:35, 17.19s/it]2025-11-24 03:27:47.789 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 48.30it/s]
2025-11-24 03:27:47.813 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:28:00.855 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.443780899047852, -6.263813018798828, -6.643043041229248]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 230.54it/s]
Processed prompts: 100%|████████████████████| 1/1 [00:01<00:00,  1.34s/it, est. speed input: 1044.26 toks/s, output: 73.95 toks/s]
2025-11-24 03:28:02.199 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Tetsuo Watabe", "Phạm Thanh Tòng"], "organizations": ["KS New World", "hãng Brother Nhật Bản", "Công ty Thiết bị văn phòng Sao Nam", "Hội Chữ thập đỏ TP Hồ Chí Minh", "Thanh Niên"], "address": ["TP Hồ Chí Minh", "Nhật Bản", "Hiroshima", "Nagasaki", "châu Á Thái Bình Dương", "Singapore"]}
2025-11-24 03:28:02.199 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 14.41s
2025-11-24 03:28:02.200 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Phạm Thanh Tòng', 'Tetsuo Watabe'], 'organizations': ['KS New World', 'Chính phủ Việt Nam', 'hãng Brother Nhật Bản', 'Thanh Niên', 'Công ty Thiết bị văn phòng Sao Nam', 'Hội Chữ thập đỏ TP Hồ Chí Minh'], 'address': ['TP Hồ Chí Minh', 'Mỹ', 'Việt Nam', 'châu Á Thái Bình Dương', 'Nhật', 'Hiroshima', 'Nhật Bản', 'Singapore', 'Nagasaki']}
2025-11-24 03:28:02.200 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Tetsuo Watabe', 'Phạm Thanh Tòng'], 'organizations': ['KS New World', 'hãng Brother Nhật Bản', 'Công ty Thiết bị văn phòng Sao Nam', 'Hội Chữ thập đỏ TP Hồ Chí Minh', 'Thanh Niên'], 'address': ['TP Hồ Chí Minh', 'Nhật Bản', 'Hiroshima', 'Nagasaki', 'châu Á Thái Bình Dương', 'Singapore']}
Extracting entities:  78%|███████████████████████████████████████████████████████▍               | 78/100 [21:16<05:59, 16.36s/it]2025-11-24 03:28:02.200 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 64.40it/s]
2025-11-24 03:28:02.219 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:28:13.700 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.445596694946289, -0.30053263902664185, -0.6647627353668213]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 250.14it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:01<00:00,  1.54s/it, est. speed input: 930.68 toks/s, output: 73.99 toks/s]
2025-11-24 03:28:15.246 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Nguyễn Thị Quy", "Nguyễn Hữu Phúc", "Trần Văn Tú", "Trần Đắc Sử", "Bành Tiến Long"], "organizations": ["ĐH Ngoại thương Hà Nội", "Thủy sản", "Sư phạm Đồng Tháp", "ĐH Giao thông Vận tải Hà Nội", "ĐH Dược Hà Nội", "ĐH Kỹ thuật Công nghệ", "Bộ GDĐT"], "address": ["khu vực phía Nam", "Thanh Hóa"]}
2025-11-24 03:28:15.246 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 13.05s
2025-11-24 03:28:15.247 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Bành Tiến Long', 'Nguyễn Hữu Phúc', 'Trần Văn Tú', 'Nguyễn Thị Quy', 'Trần Đắc Sử'], 'organizations': ['Sư phạm Đồng Tháp', 'ĐH Ngoại thương (cơ sở 2)', 'ĐH Giao thông Vận tải Hà Nội', 'ĐH Dược Hà Nội', 'Bộ GDĐT', 'Thủy sản', 'ĐH Kỹ thuật Công nghệ', 'ĐH Ngoại thương Hà Nội'], 'address': ['khu vực phía Nam', 'Thanh Hóa']}
2025-11-24 03:28:15.247 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Nguyễn Thị Quy', 'Nguyễn Hữu Phúc', 'Trần Văn Tú', 'Trần Đắc Sử', 'Bành Tiến Long'], 'organizations': ['ĐH Ngoại thương Hà Nội', 'Thủy sản', 'Sư phạm Đồng Tháp', 'ĐH Giao thông Vận tải Hà Nội', 'ĐH Dược Hà Nội', 'ĐH Kỹ thuật Công nghệ', 'Bộ GDĐT'], 'address': ['khu vực phía Nam', 'Thanh Hóa']}
Extracting entities:  79%|████████████████████████████████████████████████████████               | 79/100 [21:29<05:22, 15.36s/it]2025-11-24 03:28:15.247 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 68.04it/s]
2025-11-24 03:28:15.265 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:28:27.916 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.446019172668457, 2.645216703414917, 1.6173052787780762]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 281.95it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:01<00:00,  1.79s/it, est. speed input: 683.91 toks/s, output: 74.69 toks/s]
2025-11-24 03:28:29.715 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": [], "organizations": ["Trung tâm Dự báo Khí tượng thủy văn trung ương"], "address": ["Long Xuyên", "Đồng Tháp Mười", "Tứ Giác Long Xuyên", "Tân Châu", "Châu Đốc", "Mỹ Thuận", "Mộc Hóa", "sông Tiền", "sông Hậu", "Cần Thơ", "Thanh Hóa", "Thừa Thiên Huế", "Bình Thuận", "Tây Nguyên", "Nam Đàn", "sông Cả", "Hà Tĩnh", "Nghệ An"]}
2025-11-24 03:28:29.715 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 14.47s
2025-11-24 03:28:29.715 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': [], 'organizations': ['Trung tâm Dự báo Khí tượng thủy văn trung ương'], 'address': ['Long Xuyên', 'Đồng Tháp Mười', 'sông Tiền', 'sông Cả', 'Nghệ An', 'sông Hậu', 'sông Cửu Long', 'Châu Đốc', 'Tứ Giác Long Xuyên', 'Hà Tĩnh', 'Tân Châu', 'Thanh Hóa', 'miền Trung', 'Mỹ Thuận', 'Cần Thơ', 'Bình Thuận', 'Thừa Thiên Huế', 'Nam Đàn', 'Tây Nguyên', 'Mộc Hóa']}
2025-11-24 03:28:29.715 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': [], 'organizations': ['Trung tâm Dự báo Khí tượng thủy văn trung ương'], 'address': ['Long Xuyên', 'Đồng Tháp Mười', 'Tứ Giác Long Xuyên', 'Tân Châu', 'Châu Đốc', 'Mỹ Thuận', 'Mộc Hóa', 'sông Tiền', 'sông Hậu', 'Cần Thơ', 'Thanh Hóa', 'Thừa Thiên Huế', 'Bình Thuận', 'Tây Nguyên', 'Nam Đàn', 'sông Cả', 'Hà Tĩnh', 'Nghệ An']}
Extracting entities:  80%|████████████████████████████████████████████████████████▊              | 80/100 [21:43<05:01, 15.09s/it]2025-11-24 03:28:29.715 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 74.71it/s]
2025-11-24 03:28:29.732 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:28:38.706 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.16073226928711, -6.058313846588135, -6.4818034172058105]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 276.25it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:01<00:00,  1.39s/it, est. speed input: 810.16 toks/s, output: 74.63 toks/s]
2025-11-24 03:28:40.104 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["David Liston"],"organizations": ["Hội đồng Anh", "ĐH Liverpool John Moores", "Sofitel Plaza"],"address": ["Anh Quốc", "Liverpool", "40 Cát Linh, Hà Nội", "17 Lê Duẩn, quận 1", "230 Kim Mã, Ba Đình, Hà Nội", "502/472, Nguyễn Đình Chiểu, phường 4, quận 3", "TP HCM"]}
2025-11-24 03:28:40.104 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 10.39s
2025-11-24 03:28:40.104 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['David Liston'], 'organizations': ['Hội đồng Anh', 'khách sạn Sofitel Plaza', 'ĐH Liverpool John Moores'], 'address': ['Anh Quốc', 'Liverpool', '502/472, Nguyễn Đình Chiểu, phường 4, quận 3', '40 Cát Linh, Hà Nội', '230 Kim Mã, Ba Đình, Hà Nội', 'TP HCM', '17 Lê Duẩn, quận 1']}
2025-11-24 03:28:40.104 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['David Liston'], 'organizations': ['Hội đồng Anh', 'ĐH Liverpool John Moores', 'Sofitel Plaza'], 'address': ['Anh Quốc', 'Liverpool', '40 Cát Linh, Hà Nội', '17 Lê Duẩn, quận 1', '230 Kim Mã, Ba Đình, Hà Nội', '502/472, Nguyễn Đình Chiểu, phường 4, quận 3', 'TP HCM']}
Extracting entities:  81%|█████████████████████████████████████████████████████████▌             | 81/100 [21:54<04:19, 13.68s/it]2025-11-24 03:28:40.104 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 69.49it/s]
2025-11-24 03:28:40.122 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:28:46.853 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.43343448638916, -1.5750750303268433, -3.080092430114746]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 298.06it/s]
Processed prompts: 100%|████████████████████| 1/1 [00:00<00:00,  1.38it/s, est. speed input: 1370.84 toks/s, output: 73.31 toks/s]
2025-11-24 03:28:47.580 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Chuck Searcy"],"organizations": ["Quỹ tưởng niệm cựu chiến binh Mỹ tại Việt Nam", "Quỹ hòa giải và phát triển Mỹ"],"address": ["Việt Nam", "Mỹ", "Pháp"]}
2025-11-24 03:28:47.580 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 7.48s
2025-11-24 03:28:47.580 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Chuck Searcy'], 'organizations': ['Quỹ tưởng niệm cựu chiến binh Mỹ tại Việt Nam', 'Internet', 'Quỹ hòa giải và phát triển Mỹ'], 'address': ['Pháp', 'Mỹ', 'Việt Nam']}
2025-11-24 03:28:47.580 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Chuck Searcy'], 'organizations': ['Quỹ tưởng niệm cựu chiến binh Mỹ tại Việt Nam', 'Quỹ hòa giải và phát triển Mỹ'], 'address': ['Việt Nam', 'Mỹ', 'Pháp']}
Extracting entities:  82%|██████████████████████████████████████████████████████████▏            | 82/100 [22:01<03:32, 11.82s/it]2025-11-24 03:28:47.580 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 40.24it/s]
2025-11-24 03:28:47.609 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:29:01.560 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.437796592712402, 0.806270956993103, -0.3625171482563019]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 200.13it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.04s/it, est. speed input: 870.44 toks/s, output: 73.52 toks/s]
2025-11-24 03:29:03.606 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Anh Thanh", "Anh Lập", "Tô Thị Hạnh", "Nguyễn Thị Sang", "Trần Phước Hưởng"],"organizations": ["Singer", "Trường tiểu học phường 1", "Phòng Quản lý đô thị thị xã Vị Thanh"],"address": ["Hậu Giang", "thị xã Vị Thanh", "đường 30-4", "đường Nguyễn Việt Hồng", "đường Trần Hưng Đạo", "đường Đoàn Thị Điểm", "đường Nguyễn Thái Học", "đường Ngô Quốc Trị", "phường 5", "phường 1", "đường Đồ Chiểu"]}
2025-11-24 03:29:03.607 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 16.03s
2025-11-24 03:29:03.607 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Anh Lập', 'Nguyễn Thị Sang', 'Anh Thanh', 'Tô Thị Hạnh', 'Trần Phước Hưởng'], 'organizations': ['Phòng Quản lý đô thị thị xã Vị Thanh', 'Singer', 'Trường tiểu học phường 1'], 'address': ['phường 5', 'Trần Hưng Đạo', 'Hậu Giang', 'đường 30-4', 'Nguyễn Thái Học', 'Đường Nguyễn Việt Hồng', 'đường Đồ Chiểu', 'đường Trưng Trắc', 'thị xã Vị Thanh', 'phường 1', 'Đoàn Thị Điểm', 'đường Ngô Quốc Trị', '30-4']}
2025-11-24 03:29:03.607 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Anh Thanh', 'Anh Lập', 'Tô Thị Hạnh', 'Nguyễn Thị Sang', 'Trần Phước Hưởng'], 'organizations': ['Singer', 'Trường tiểu học phường 1', 'Phòng Quản lý đô thị thị xã Vị Thanh'], 'address': ['Hậu Giang', 'thị xã Vị Thanh', 'đường 30-4', 'đường Nguyễn Việt Hồng', 'đường Trần Hưng Đạo', 'đường Đoàn Thị Điểm', 'đường Nguyễn Thái Học', 'đường Ngô Quốc Trị', 'phường 5', 'phường 1', 'đường Đồ Chiểu']}
Extracting entities:  83%|██████████████████████████████████████████████████████████▉            | 83/100 [22:17<03:42, 13.08s/it]2025-11-24 03:29:03.607 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 23.76it/s]
2025-11-24 03:29:03.653 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:29:19.474 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [9.344090461730957, -6.032395839691162, -6.204548358917236]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 174.43it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.91s/it, est. speed input: 748.15 toks/s, output: 72.92 toks/s]
2025-11-24 03:29:22.388 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["bà Năm Quyết", "Mộng Thu", "Nguyễn Đức Thắng", "Nguyễn Văn Xuân", "Sáu Huyến", "Lâm Thị Lấm", "Ba Hạnh", "Tư Thương", "Hồ Văn Sáu", "Phạm Thành Thảo"], "organizations": ["trạm y tế xã An Thạnh Nam", "Chi cục Kiểm lâm tỉnh Sóc Trăng", "Cục Kiểm lâm", "Nông trường 30/4"], "address": ["xã Trung Bình", "Sóc Trăng", "xã An Thạnh Nam", "Xóm Đáy", "Trung Bình", "xã An Thạnh Ba", "chợ Rạch Tráng", "Mỏ Ó", "Vàm Hồ", "ấp Võ Thành Văn", "huyện Long Phú", "ngư cảng Trần Đề", "Cù Lao Dung", "Long Phú"]}
2025-11-24 03:29:22.388 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 18.78s
2025-11-24 03:29:22.388 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Phạm Thành Thảo', 'Lâm Thị Lấm', 'Kim Thị Thùy Linh', 'bà Năm Quyết', 'Tư Thương', 'Tân', 'Ba Hạnh', 'Hồ Văn Sáu'], 'organizations': ['trạm y tế xã An Thạnh Nam', 'Chi cục Kiểm lâm tỉnh Sóc Trăng', 'Cục Kiểm lâm', 'Nông trường 30/4'], 'address': ['xã Trung Bình', 'Sóc Trăng', 'xã An Thạnh Nam', 'Xóm Đáy', 'Trung Bình', 'xã An Thạnh Ba', 'chợ Rạch Tráng', 'Mỏ Ó', 'Vàm Hồ', 'ấp Võ Thành Văn', 'huyện Long Phú', 'ngư cảng Trần Đề', 'Cù Lao Dung', 'Long Phú']}
2025-11-24 03:29:22.388 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['bà Năm Quyết', 'Mộng Thu', 'Nguyễn Đức Thắng', 'Nguyễn Văn Xuân', 'Sáu Huyến', 'Lâm Thị Lấm', 'Ba Hạnh', 'Tư Thương', 'Hồ Văn Sáu', 'Phạm Thành Thảo'], 'organizations': ['trạm y tế xã An Thạnh Nam', 'Chi cục Kiểm lâm tỉnh Sóc Trăng', 'Cục Kiểm lâm', 'Nông trường 30/4'], 'address': ['xã Trung Bình', 'Sóc Trăng', 'xã An Thạnh Nam', 'Xóm Đáy', 'Trung Bình', 'xã An Thạnh Ba', 'chợ Rạch Tráng', 'Mỏ Ó', 'Vàm Hồ', 'ấp Võ Thành Văn', 'huyện Long Phú', 'ngư cảng Trần Đề', 'Cù Lao Dung', 'Long Phú']}
Extracting entities:  84%|███████████████████████████████████████████████████████████▋           | 84/100 [22:36<03:56, 14.79s/it]2025-11-24 03:29:22.389 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 73.41it/s]
2025-11-24 03:29:22.406 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:29:28.548 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.130820274353027, 2.435809373855591, 0.957713782787323]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 269.02it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.31s/it, est. speed input: 490.31 toks/s, output: 75.80 toks/s]
2025-11-24 03:29:30.861 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Bùi Đặng Dũng", "Nguyễn Văn Hiệu", "Nguyễn Quang Đạt", "Nguyễn Quốc Hùng", "Nguyễn Hoài Bắc", "Đào Việt Dũng", "Phạm Quang Minh", "Nguyễn Hiền Tùng", "Lê Đức Hạnh", "Hà Minh Tiến"], "organizations": ["Viện Khoa học và Công nghệ Việt Nam", "Trung ương Đoàn TNCS Hồ Chí Minh", "Công ty Kim khí Thăng Long", "Phòng Thí nghiệm Khí động - Động lực Viện Tên lửa", "Trung tâm KHKT Công nghiệp quân sự", "Bộ Quốc phòng", "Nhà máy Z121 Tổng cục Công nghiệp Quốc phòng"], "address": ["Hà Nội"]}
2025-11-24 03:29:30.862 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 8.47s
2025-11-24 03:29:30.862 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Nguyễn Văn Hiệu', 'Phạm Quang Minh', 'Hà Minh Tiến', 'Đào Việt Dũng', 'Nguyễn Hiền Tùng', 'Nguyễn Hoài Bắc', 'Lê Đức Hạnh', 'Nguyễn Quốc Hùng', 'Bùi Đặng Dũng', 'Nguyễn Quang Đạt'], 'organizations': ['Trung ương Đoàn TNCS Hồ Chí Minh', 'Công ty Kim khí Thăng Long', 'Bộ Quốc phòng', 'Viện Khoa học và Công nghệ Việt Nam', 'Nhà máy Z121 Tổng cục Công nghiệp Quốc phòng', 'TTXVN', 'Phòng Thí nghiệm Khí động - Động lực Viện Tên lửa', 'Trung tâm KHKT Công nghiệp quân sự'], 'address': ['Hà Nội']}
2025-11-24 03:29:30.862 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Bùi Đặng Dũng', 'Nguyễn Văn Hiệu', 'Nguyễn Quang Đạt', 'Nguyễn Quốc Hùng', 'Nguyễn Hoài Bắc', 'Đào Việt Dũng', 'Phạm Quang Minh', 'Nguyễn Hiền Tùng', 'Lê Đức Hạnh', 'Hà Minh Tiến'], 'organizations': ['Viện Khoa học và Công nghệ Việt Nam', 'Trung ương Đoàn TNCS Hồ Chí Minh', 'Công ty Kim khí Thăng Long', 'Phòng Thí nghiệm Khí động - Động lực Viện Tên lửa', 'Trung tâm KHKT Công nghiệp quân sự', 'Bộ Quốc phòng', 'Nhà máy Z121 Tổng cục Công nghiệp Quốc phòng'], 'address': ['Hà Nội']}
Extracting entities:  85%|████████████████████████████████████████████████████████████▎          | 85/100 [22:44<03:13, 12.90s/it]2025-11-24 03:29:30.862 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 63.37it/s]
2025-11-24 03:29:30.881 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:29:38.611 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.444619178771973, -1.6907503604888916, -2.4082562923431396]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 248.48it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.28s/it, est. speed input: 623.15 toks/s, output: 75.09 toks/s]
2025-11-24 03:29:40.894 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Cao Thị Ngọc Lan"], "organizations": ["Sở Quy hoạch kiến trúc", "Sở Du lịch", "Tổng cục Du lịch", "UBND Hà Nội", "Hội nghị cấp cao APEC 2006"], "address": ["Hà Nội", "Tây Hồ Tây", "Ngoại giao đoàn", "phường Xuân La", "quận Tây Hồ", "Linh Đàm", "Trung tâm văn hóa thể dục thể thao", "Trung tâm Y tế quận Hoàng Mai", "đường Trần Duy Hưng", "Trung tâm Hội nghị quốc gia", "sông Hồng", "tuyến Bắc Thăng Long Nội Bài", "xã Xuân Nộn", "Nam Hồng", "đầm Vân Trì"]}
2025-11-24 03:29:40.894 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 10.03s
2025-11-24 03:29:40.894 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Cao Thị Ngọc Lan'], 'organizations': ['APEC 2006', 'Sở Du lịch', 'UBND Hà Nội', 'HĐND Hà Nội', 'Sở Quy hoạch Kiến trúc', 'Sở Quy hoạch kiến trúc', 'Trung tâm Hội nghị quốc gia', 'UBND thành phố', 'Tổng cục Du lịch', 'Trung tâm văn hóa thể dục thể thao'], 'address': ['Vân Trì', 'Trần Duy Hưng', 'Xuân Nộn', 'Hà Nội', 'Tây Hồ Tây', 'Xuân La', 'Ngoại giao đoàn', 'Nam Hồng', 'Bắc Thăng Long Nội Bài', 'sông Hồng', 'Hoàng Mai', 'Linh Đàm', 'Tây Hồ']}
2025-11-24 03:29:40.894 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Cao Thị Ngọc Lan'], 'organizations': ['Sở Quy hoạch kiến trúc', 'Sở Du lịch', 'Tổng cục Du lịch', 'UBND Hà Nội', 'Hội nghị cấp cao APEC 2006'], 'address': ['Hà Nội', 'Tây Hồ Tây', 'Ngoại giao đoàn', 'phường Xuân La', 'quận Tây Hồ', 'Linh Đàm', 'Trung tâm văn hóa thể dục thể thao', 'Trung tâm Y tế quận Hoàng Mai', 'đường Trần Duy Hưng', 'Trung tâm Hội nghị quốc gia', 'sông Hồng', 'tuyến Bắc Thăng Long Nội Bài', 'xã Xuân Nộn', 'Nam Hồng', 'đầm Vân Trì']}
Extracting entities:  86%|█████████████████████████████████████████████████████████████          | 86/100 [22:54<02:48, 12.04s/it]2025-11-24 03:29:40.894 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 39.87it/s]
2025-11-24 03:29:40.923 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:29:54.950 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [10.866340637207031, 2.1218345165252686, 1.5535777807235718]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 209.28it/s]
Processed prompts: 100%|████████████████████| 1/1 [00:01<00:00,  1.62s/it, est. speed input: 1079.16 toks/s, output: 73.47 toks/s]
2025-11-24 03:29:56.575 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Đỗ Quang Văn", "Phương", "Linh", "Hoàng Mạnh Chính", "Trương Quang Mông", "Phạm Thế Minh"],"organizations": ["cảnh sát hình sự", "Công an quận 3", "Sở Giao thông công chính TP HCM", "Bộ Giao thông vận tải", "ga Sài Gòn", "công an phường 9", "ngành đường sắt", "Ga Sài Gòn"],"address": ["ga Sài Gòn", "Hà Nội", "ga phía Bắc"]}
2025-11-24 03:29:56.576 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 15.68s
2025-11-24 03:29:56.576 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Phương', 'Đỗ Quang Văn', 'Linh', 'Minh', 'Mông', 'Trương Quang Mông', 'Phạm Thế Minh', 'Hoàng Mạnh Chính'], 'organizations': ['cảnh sát hình sự', 'Công an quận 3', 'Sở Giao thông công chính TP HCM', 'VnExpress', 'Công an quận', 'Bộ Giao thông vận tải', 'ga Sài Gòn', 'công an phường 9', 'ngành đường sắt', 'Ga Sài Gòn'], 'address': ['Hà Nội', 'ga phía Bắc', 'ga Sài Gòn']}
2025-11-24 03:29:56.576 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Đỗ Quang Văn', 'Phương', 'Linh', 'Hoàng Mạnh Chính', 'Trương Quang Mông', 'Phạm Thế Minh'], 'organizations': ['cảnh sát hình sự', 'Công an quận 3', 'Sở Giao thông công chính TP HCM', 'Bộ Giao thông vận tải', 'ga Sài Gòn', 'công an phường 9', 'ngành đường sắt', 'Ga Sài Gòn'], 'address': ['ga Sài Gòn', 'Hà Nội', 'ga phía Bắc']}
Extracting entities:  87%|█████████████████████████████████████████████████████████████▊         | 87/100 [23:10<02:50, 13.13s/it]2025-11-24 03:29:56.576 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|█████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 106.50it/s]
2025-11-24 03:29:56.589 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:29:58.405 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [8.251877784729004, 1.2801564931869507, -0.4120132625102997]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 347.30it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:03<00:00,  3.36s/it, est. speed input: 239.65 toks/s, output: 76.81 toks/s]
2025-11-24 03:30:01.768 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Phan Văn Khải", "Ôn Gia Bảo", "Bộ trưởng Kế hoạch và Đầu tư", "các thứ trưởng Ngoại giao", "các thứ trưởng Giao thông vận tải", "các thứ trưởng Công nghiệp", "các thứ trưởng Nông nghiệp và Phát triển nông thôn", "Đại sứ Việt Nam tại Trung Quốc", "Chủ tịch UBND tỉnh Lào Cai", "Phó Chủ tịch Phòng Thương mại và Công nghiệp Việt Nam"],"organizations": ["Hội nghị cấp cao Hợp tác các nước Tiểu vùng sông Mê Công mở rộng (GMS)", "Quốc vụ viện nước CHND Trung Hoa", "Phòng Thương mại và Công nghiệp Việt Nam", "UBND tỉnh Lào Cai", "Bộ Kế hoạch và Đầu tư", "Bộ Ngoại giao", "Bộ Giao thông vận tải", "Bộ Công nghiệp", "Bộ Nông nghiệp và Phát triển nông thôn"],"address": ["Việt Nam", "Hà Nội", "Trung Quốc", "Côn Minh", "vùng sông Mê Công", "tiểu vùng sông Mê Công", "Đông - Nam Á"]}
2025-11-24 03:30:01.768 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 5.19s
2025-11-24 03:30:01.768 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Ôn Gia Bảo', 'Phan Văn Khải'], 'organizations': ['Hội nghị cấp cao Hợp tác các nước Tiểu vùng sông Mê Công mở rộng (GMS)', 'UBND tỉnh Lào Cai', 'Phòng Thương mại và Công nghiệp Việt Nam', 'Quốc vụ viện nước CHND Trung Hoa'], 'address': ['Việt Nam', 'Hà Nội', 'Trung Quốc', 'vùng sông Mê Công', 'tiểu vùng sông Mê Công', 'Đông - Nam Á', 'Côn Minh']}
2025-11-24 03:30:01.768 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Phan Văn Khải', 'Ôn Gia Bảo', 'Bộ trưởng Kế hoạch và Đầu tư', 'các thứ trưởng Ngoại giao', 'các thứ trưởng Giao thông vận tải', 'các thứ trưởng Công nghiệp', 'các thứ trưởng Nông nghiệp và Phát triển nông thôn', 'Đại sứ Việt Nam tại Trung Quốc', 'Chủ tịch UBND tỉnh Lào Cai', 'Phó Chủ tịch Phòng Thương mại và Công nghiệp Việt Nam'], 'organizations': ['Hội nghị cấp cao Hợp tác các nước Tiểu vùng sông Mê Công mở rộng (GMS)', 'Quốc vụ viện nước CHND Trung Hoa', 'Phòng Thương mại và Công nghiệp Việt Nam', 'UBND tỉnh Lào Cai', 'Bộ Kế hoạch và Đầu tư', 'Bộ Ngoại giao', 'Bộ Giao thông vận tải', 'Bộ Công nghiệp', 'Bộ Nông nghiệp và Phát triển nông thôn'], 'address': ['Việt Nam', 'Hà Nội', 'Trung Quốc', 'Côn Minh', 'vùng sông Mê Công', 'tiểu vùng sông Mê Công', 'Đông - Nam Á']}
Extracting entities:  88%|██████████████████████████████████████████████████████████████▍        | 88/100 [23:15<02:08, 10.75s/it]2025-11-24 03:30:01.768 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 21.09it/s]
2025-11-24 03:30:01.820 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:30:18.961 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [7.682171821594238, -4.952247619628906, -6.162838935852051]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 147.86it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:03<00:00,  3.57s/it, est. speed input: 745.90 toks/s, output: 73.02 toks/s]
2025-11-24 03:30:22.543 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Lân", "Hoàng Văn Biên", "Phụ xe", "Người bảo vệ", "Nguyệt", "Trần Văn Bon", "Kế", "Vũ Gia Khánh", "Huỳnh Văn Nhỏ", "Hải", "Thanh", "Khánh", "Nhỏ", "Trần Văn Bon", "Kế", "Vũ Gia Khánh", "Huỳnh Văn Nhỏ", "Hải", "Thanh", "Khánh", "Nhỏ"], "organizations": ["đội điều tra thụ lý", "phòng bảo vệ quân sự cảng Sài Gòn", "đội bảo vệ cảng Nhà Rồng", "cảng Sài Gòn", "cảng Khánh Hội", "cổng Bến Súc", "cổng Kho 5", "cổng Nhà Rồng"], "address": ["cổng Bến Súc", "Kho 5", "Nhà Rồng", "Khánh Hội", "đường Nguyễn Tất Thành", "quận 4", "TP HCM", "Bình Dương", "cảng Khánh Hội", "cổng Kho 5", "cổng Nhà Rồng"] }
2025-11-24 03:30:22.543 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 20.77s
2025-11-24 03:30:22.543 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Hải', 'Vũ Gia Khánh', 'Hoàng', 'Lân', 'Nguyệt', 'Nhỏ', 'Hoàng Văn Biên', 'Khánh', 'Trần Văn Bon', 'Kế', 'Thanh', 'Huỳnh Văn Nhỏ'], 'organizations': ['đội điều tra thụ lý', 'phòng bảo vệ quân sự cảng Sài Gòn', 'đội bảo vệ cảng Nhà Rồng', 'cảng Sài Gòn'], 'address': ['cổng Nhà Rồng', 'cổng Bến Súc', 'Bình Dương', 'quận 4', 'cảng Khánh Hội', 'Khánh Hội', 'Nhà Rồng', 'TP HCM', 'đường Nguyễn Tất Thành', 'cổng Kho 5', 'Kho 5']}
2025-11-24 03:30:22.543 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Lân', 'Hoàng Văn Biên', 'Phụ xe', 'Người bảo vệ', 'Nguyệt', 'Trần Văn Bon', 'Kế', 'Vũ Gia Khánh', 'Huỳnh Văn Nhỏ', 'Hải', 'Thanh', 'Khánh', 'Nhỏ', 'Trần Văn Bon', 'Kế', 'Vũ Gia Khánh', 'Huỳnh Văn Nhỏ', 'Hải', 'Thanh', 'Khánh', 'Nhỏ'], 'organizations': ['đội điều tra thụ lý', 'phòng bảo vệ quân sự cảng Sài Gòn', 'đội bảo vệ cảng Nhà Rồng', 'cảng Sài Gòn', 'cảng Khánh Hội', 'cổng Bến Súc', 'cổng Kho 5', 'cổng Nhà Rồng'], 'address': ['cổng Bến Súc', 'Kho 5', 'Nhà Rồng', 'Khánh Hội', 'đường Nguyễn Tất Thành', 'quận 4', 'TP HCM', 'Bình Dương', 'cảng Khánh Hội', 'cổng Kho 5', 'cổng Nhà Rồng']}
Extracting entities:  89%|███████████████████████████████████████████████████████████████▏       | 89/100 [23:36<02:31, 13.76s/it]2025-11-24 03:30:22.543 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 38.06it/s]
2025-11-24 03:30:22.573 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:30:39.588 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [8.519367218017578, 2.807088613510132, 0.3367139995098114]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 183.49it/s]
Processed prompts: 100%|████████████████████| 1/1 [00:01<00:00,  1.63s/it, est. speed input: 1030.62 toks/s, output: 73.57 toks/s]
2025-11-24 03:30:41.226 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Phạm Thị Ánh Nguyệt", "Nguyễn Bình An", "Trần Quốc Huân", "Lê Trường Giang", "Nguyễn Thiện Nhân"], "organizations": ["Vinamilk", "Dutch Lady Việt Nam", "Công ty TNHH Thương Tuyến", "Sở Giáo dục và Đào tạo", "UBND TP HCM", "Công ty bao bì Liksin"], "address": ["Củ Chi", "Hóc Môn", "Cần Giờ", "TP HCM"]}
2025-11-24 03:30:41.226 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 18.68s
2025-11-24 03:30:41.226 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Huân', 'Nguyễn Thiện Nhân', 'Nguyễn Bình An', 'Lê Trường Giang', 'Phạm Thị Ánh Nguyệt', 'Trần Quốc Huân'], 'organizations': ['Dutch Lady Việt Nam', 'công ty bao bì Liksin', 'Sở Giáo dục và Đào tạo', 'UBND TP HCM', 'Vinamilk'], 'address': ['Cần Giờ', 'Hóc Môn', 'TP HCM', 'Củ Chi', 'Thành phố']}
2025-11-24 03:30:41.226 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Phạm Thị Ánh Nguyệt', 'Nguyễn Bình An', 'Trần Quốc Huân', 'Lê Trường Giang', 'Nguyễn Thiện Nhân'], 'organizations': ['Vinamilk', 'Dutch Lady Việt Nam', 'Công ty TNHH Thương Tuyến', 'Sở Giáo dục và Đào tạo', 'UBND TP HCM', 'Công ty bao bì Liksin'], 'address': ['Củ Chi', 'Hóc Môn', 'Cần Giờ', 'TP HCM']}
Extracting entities:  90%|███████████████████████████████████████████████████████████████▉       | 90/100 [23:55<02:32, 15.23s/it]2025-11-24 03:30:41.226 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 52.73it/s]
2025-11-24 03:30:41.249 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:30:55.194 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [10.868613243103027, 1.2293016910552979, 1.0857471227645874]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 222.09it/s]
Processed prompts: 100%|████████████████████| 1/1 [00:00<00:00,  1.02it/s, est. speed input: 1249.04 toks/s, output: 73.17 toks/s]
2025-11-24 03:30:56.184 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Nguyễn Đức Kiên", "Trần Thị Trung Chiến"], "organizations": ["Bộ Y tế", "Chính phủ", "Ủy ban Kinh tế và Ngân sách", "Quốc hội", "Bộ trưởng Y tế", "Ủy ban Kinh tế ngân sách"], "address": []}
2025-11-24 03:30:56.184 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 14.96s
2025-11-24 03:30:56.184 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Nguyễn Đức Kiên', 'Bộ trưởng Y tế', 'Trần Thị Trung Chiến'], 'organizations': ['Quốc hội', 'Ủy ban Kinh tế Ngân sách', 'Chính phủ', 'Bộ Y tế', 'Ủy ban Kinh tế và Ngân sách'], 'address': []}
2025-11-24 03:30:56.184 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Nguyễn Đức Kiên', 'Trần Thị Trung Chiến'], 'organizations': ['Bộ Y tế', 'Chính phủ', 'Ủy ban Kinh tế và Ngân sách', 'Quốc hội', 'Bộ trưởng Y tế', 'Ủy ban Kinh tế ngân sách'], 'address': []}
Extracting entities:  91%|████████████████████████████████████████████████████████████████▌      | 91/100 [24:10<02:16, 15.15s/it]2025-11-24 03:30:56.184 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 54.24it/s]
2025-11-24 03:30:56.206 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:31:08.367 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [10.570621490478516, -4.729887008666992, -6.883022785186768]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 222.03it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.08s/it, est. speed input: 710.69 toks/s, output: 74.05 toks/s]
2025-11-24 03:31:10.452 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Eric Kuan"],"organizations": ["MDIS", "University of Wales", "University of Bradford", "University of Westminster", "Edith Cowan University", "Macquarie University", "Southern Cross University", "Oklahoma City University", "Công ty tư vấn du học VINECO", "Học viện Phát triển Quản lý Singapore MDIS", "UniCampus"],"address": ["63 Nguyễn Huệ, quận 1, TP HCM", "360 Kim Mã, Hà Nội", "TP HCM", "Hà Nội", "Anh quốc", "Australia", "Mỹ", "9/22 Phạm Văn Hai, P1, Q. Tân Bình, TP HCM"]}
2025-11-24 03:31:10.452 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 14.27s
2025-11-24 03:31:10.452 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Eric Kuan'], 'organizations': ['Oklahoma City University', 'Học viện Phát triển Quản lý Singapore MDIS', 'khách sạn Duxton', 'University of Wales', 'chính phủ Singapore', 'UniCampus', 'Công ty tư vấn du học VINECO', 'Edith Cowan University', 'University of Westminster', 'Macquarie University', 'khách sạn Daewoo', 'Southern Cross University', 'MDIS', 'University of Bradford'], 'address': ['Mỹ', 'Việt Nam', 'Australia', 'Anh quốc', '63 Nguyễn Huệ, quận 1, TP HCM', '9/22 Phạm Văn Hai, P1, Q. Tân Bình, TP HCM', 'TP HCM', '360 Kim Mã, Hà Nội', 'Singapore']}
2025-11-24 03:31:10.452 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Eric Kuan'], 'organizations': ['MDIS', 'University of Wales', 'University of Bradford', 'University of Westminster', 'Edith Cowan University', 'Macquarie University', 'Southern Cross University', 'Oklahoma City University', 'Công ty tư vấn du học VINECO', 'Học viện Phát triển Quản lý Singapore MDIS', 'UniCampus'], 'address': ['63 Nguyễn Huệ, quận 1, TP HCM', '360 Kim Mã, Hà Nội', 'TP HCM', 'Hà Nội', 'Anh quốc', 'Australia', 'Mỹ', '9/22 Phạm Văn Hai, P1, Q. Tân Bình, TP HCM']}
Extracting entities:  92%|█████████████████████████████████████████████████████████████████▎     | 92/100 [24:24<01:59, 14.89s/it]2025-11-24 03:31:10.452 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 63.57it/s]
2025-11-24 03:31:10.472 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:31:23.233 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.430683135986328, -5.98238468170166, -6.233555316925049]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 256.96it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:03<00:00,  3.13s/it, est. speed input: 380.03 toks/s, output: 75.37 toks/s]
2025-11-24 03:31:26.370 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Thủ tướng", "Chủ tịch UBND tỉnh", "lãnh đạo tỉnh Quảng Nam"], "organizations": ["Văn phòng Chính phủ", "UBND tỉnh Quảng Nam", "Sở VHTT tỉnh Quảng Nam", "UBND thị xã Hội An", "Xí nghiệp xây dựng Kim An", "Công ty Xây dựng Hội An", "Thanh tra Chính phủ", "Công ty Xây dựng Hội An", "Bộ VHTT", "Sở VHTT Quảng Nam", "Công ty TNHH Việt Mỹ (ATI)", "Công ty ATI", "Bộ Tài nguyên - môi trường", "Sở Tài nguyên - môi trường"], "address": ["Hội An", "Quảng Nam", "Nguyễn Thái Học", "Hoàng Văn Thụ", "số 15 Nguyễn Thái Học", "số 17 Nguyễn Thái Học", "số 23 Hoàng Văn Thụ", "số 9 Nguyễn Thái Học", "số 33 Nguyễn Thái Học", "số 46 Nguyễn Thái Học"]}
2025-11-24 03:31:26.370 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 15.92s
2025-11-24 03:31:26.370 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Chủ tịch UBND tỉnh', 'Thủ tướng'], 'organizations': ['UBND thị xã Hội An', 'Sở VHTT Quảng Nam', 'Công ty Xây dựng Hội An', 'Xí nghiệp xây dựng Kim An', 'Văn phòng Chính phủ', 'UBND tỉnh Quảng Nam', 'Thanh tra Chính phủ', 'Sở VHTT tỉnh Quảng Nam'], 'address': ['Hội An', 'Quảng Nam']}
2025-11-24 03:31:26.370 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Thủ tướng', 'Chủ tịch UBND tỉnh', 'lãnh đạo tỉnh Quảng Nam'], 'organizations': ['Văn phòng Chính phủ', 'UBND tỉnh Quảng Nam', 'Sở VHTT tỉnh Quảng Nam', 'UBND thị xã Hội An', 'Xí nghiệp xây dựng Kim An', 'Công ty Xây dựng Hội An', 'Thanh tra Chính phủ', 'Công ty Xây dựng Hội An', 'Bộ VHTT', 'Sở VHTT Quảng Nam', 'Công ty TNHH Việt Mỹ (ATI)', 'Công ty ATI', 'Bộ Tài nguyên - môi trường', 'Sở Tài nguyên - môi trường'], 'address': ['Hội An', 'Quảng Nam', 'Nguyễn Thái Học', 'Hoàng Văn Thụ', 'số 15 Nguyễn Thái Học', 'số 17 Nguyễn Thái Học', 'số 23 Hoàng Văn Thụ', 'số 9 Nguyễn Thái Học', 'số 33 Nguyễn Thái Học', 'số 46 Nguyễn Thái Học']}
Extracting entities:  93%|██████████████████████████████████████████████████████████████████     | 93/100 [24:40<01:46, 15.20s/it]2025-11-24 03:31:26.370 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 34.38it/s]
2025-11-24 03:31:26.403 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:31:49.615 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.446969985961914, 5.07426118850708, 4.797638416290283]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 100.34it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.20s/it, est. speed input: 819.48 toks/s, output: 66.81 toks/s]
2025-11-24 03:31:51.829 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Lê Minh Triết", "Nguyễn Văn Hiệp", "Cát Nguyên Hùng", "Nguyễn Ngọc Thủy", "Đào Văn Lượng"], "organizations": ["Viện khoa học và công nghệ", "Sở KHCN TP HCM", "Sở Xây dựng TP HCM", "Bệnh viện Bệnh nhiệt đới", "Bệnh viện chấn thương chỉnh hình", "Liên đoàn bản đồ địa chất Miền Nam", "Viện Vật lý địa cầu", "UBND TP HCM", "Sở Khoa học công nghệ"], "address": ["TP HCM", "Hà Nội", "sông Hồng"]}
2025-11-24 03:31:51.830 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 25.46s
2025-11-24 03:31:51.830 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Cát Nguyên Hùng', 'Hiệp', 'Đào Văn Lượng', 'Nguyễn Ngọc Thủy', 'Lê Minh Triết', 'Nguyễn Văn Hiệp'], 'organizations': ['Nhà nước', 'Sở KHCN TP HCM', 'Viện khoa học và công nghệ', 'Bệnh viện chấn thương chỉnh hình', 'Bệnh viện Bệnh nhiệt đới', 'UBND', 'Viện Vật lý địa cầu', 'UBND TP HCM', 'Liên đoàn bản đồ địa chất Miền Nam', 'Viện khoa học công nghệ', 'Sở Khoa học công nghệ', 'Sở Xây dựng TP HCM'], 'address': ['TP HCM', 'Hà Nội', 'Việt Nam', 'sông Hồng']}
2025-11-24 03:31:51.830 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Lê Minh Triết', 'Nguyễn Văn Hiệp', 'Cát Nguyên Hùng', 'Nguyễn Ngọc Thủy', 'Đào Văn Lượng'], 'organizations': ['Viện khoa học và công nghệ', 'Sở KHCN TP HCM', 'Sở Xây dựng TP HCM', 'Bệnh viện Bệnh nhiệt đới', 'Bệnh viện chấn thương chỉnh hình', 'Liên đoàn bản đồ địa chất Miền Nam', 'Viện Vật lý địa cầu', 'UBND TP HCM', 'Sở Khoa học công nghệ'], 'address': ['TP HCM', 'Hà Nội', 'sông Hồng']}
Extracting entities:  94%|██████████████████████████████████████████████████████████████████▋    | 94/100 [25:05<01:49, 18.28s/it]2025-11-24 03:31:51.830 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 32.70it/s]
2025-11-24 03:31:51.874 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:32:08.858 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [9.24710750579834, 4.86810302734375, 4.738182067871094]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 277.49it/s]
Processed prompts: 100%|████████████████████| 1/1 [00:00<00:00,  1.49it/s, est. speed input: 1496.12 toks/s, output: 72.94 toks/s]
2025-11-24 03:32:09.534 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Lê Trường Giang"], "organizations": ["UBND TP HCM", "Sở Y tế"], "address": ["TP HCM", "quận 3", "quận Phú Nhuận"]}
2025-11-24 03:32:09.534 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 17.70s
2025-11-24 03:32:09.534 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Lê Trường Giang'], 'organizations': ['UBND TP HCM', 'Sở Y tế'], 'address': ['TP HCM', 'quận 3', 'quận Phú Nhuận']}
2025-11-24 03:32:09.535 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Lê Trường Giang'], 'organizations': ['UBND TP HCM', 'Sở Y tế'], 'address': ['TP HCM', 'quận 3', 'quận Phú Nhuận']}
Extracting entities:  95%|███████████████████████████████████████████████████████████████████▍   | 95/100 [25:23<01:30, 18.10s/it]2025-11-24 03:32:09.535 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 69.11it/s]
2025-11-24 03:32:09.553 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:32:20.908 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.445136070251465, -4.7999796867370605, -5.767158508300781]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 279.90it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.40s/it, est. speed input: 459.53 toks/s, output: 75.82 toks/s]
2025-11-24 03:32:23.313 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": [], "organizations": ["Tổng công ty Cao su VN", "Công ty Cao su Quảng Trị", "Công ty TNHH Việt Mỹ (ATI)", "Công ty ATI", "Sở Tài nguyên - môi trường", "UBND tỉnh Quảng Trị", "UBND tỉnh Thừa Thiên - Huế", "UBND huyện Hải Lăng", "UBND huyện Phong Điền", "Bộ Tài nguyên - môi trường"], "address": ["Gio Linh", "huyện Hải Lăng", "xã Vĩnh Sơn", "thị xã Đông Hà", "huyện Phong Điền", "tỉnh Thừa Thiên - Huế", "xã Hải An", "thôn Câu Nhi", "sông Bến Hải", "xã Hải Chánh", "Quảng Trị"]}
2025-11-24 03:32:23.313 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 13.78s
2025-11-24 03:32:23.313 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': [], 'organizations': ['Công ty Cao su Quảng Trị', 'Tổng công ty Cao su VN', 'UBND tỉnh Quảng Trị', 'UBND tỉnh Thừa Thiên - Huế', 'UBND tỉnh', 'Công ty TNHH Việt Mỹ (ATI)', 'Công ty ATI', 'Bộ Tài nguyên - môi trường', 'Sở Tài nguyên - môi trường'], 'address': ['huyện Hải Lăng', 'xã Vĩnh Sơn', 'xã Hải Chánh', 'thị xã Đông Hà', 'huyện Phong Điền', 'tỉnh Thừa Thiên - Huế', 'xã Hải An', 'thôn Câu Nhi', 'sông Bến Hải', 'Gio Linh', 'Quảng Trị']}
2025-11-24 03:32:23.313 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': [], 'organizations': ['Tổng công ty Cao su VN', 'Công ty Cao su Quảng Trị', 'Công ty TNHH Việt Mỹ (ATI)', 'Công ty ATI', 'Sở Tài nguyên - môi trường', 'UBND tỉnh Quảng Trị', 'UBND tỉnh Thừa Thiên - Huế', 'UBND huyện Hải Lăng', 'UBND huyện Phong Điền', 'Bộ Tài nguyên - môi trường'], 'address': ['Gio Linh', 'huyện Hải Lăng', 'xã Vĩnh Sơn', 'thị xã Đông Hà', 'huyện Phong Điền', 'tỉnh Thừa Thiên - Huế', 'xã Hải An', 'thôn Câu Nhi', 'sông Bến Hải', 'xã Hải Chánh', 'Quảng Trị']}
Extracting entities:  96%|████████████████████████████████████████████████████████████████████▏  | 96/100 [25:37<01:07, 16.81s/it]2025-11-24 03:32:23.313 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 99.47it/s]
2025-11-24 03:32:23.327 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:32:29.098 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [8.435070991516113, 2.0787951946258545, 1.124245524406433]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 334.13it/s]
Processed prompts: 100%|████████████████████| 1/1 [00:00<00:00,  1.29it/s, est. speed input: 1107.64 toks/s, output: 74.87 toks/s]
2025-11-24 03:32:29.876 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Hoà thượng Thích Nhất Hạnh"], "organizations": ["Làng Mai", "chùa Pháp Vân", "Hiểu và Thương"], "address": ["TP HCM", "quận Tân Phú", "Việt Nam", "Pháp"]}
2025-11-24 03:32:29.877 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 6.56s
2025-11-24 03:32:29.877 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Hoà thượng Thích Nhất Hạnh'], 'organizations': ['Làng Mai'], 'address': ['Việt Nam', 'Pháp', 'chùa Pháp Vân', 'quận Tân Phú', 'TP HCM']}
2025-11-24 03:32:29.877 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Hoà thượng Thích Nhất Hạnh'], 'organizations': ['Làng Mai', 'chùa Pháp Vân', 'Hiểu và Thương'], 'address': ['TP HCM', 'quận Tân Phú', 'Việt Nam', 'Pháp']}
Extracting entities:  97%|████████████████████████████████████████████████████████████████████▊  | 97/100 [25:43<00:41, 13.73s/it]2025-11-24 03:32:29.877 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 42.62it/s]
2025-11-24 03:32:29.904 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:32:45.821 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.445621490478516, -5.922740459442139, -6.7594757080078125]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 202.46it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:02<00:00,  2.04s/it, est. speed input: 818.73 toks/s, output: 74.34 toks/s]
2025-11-24 03:32:47.871 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Nguyễn Thiện Nhân", "Nguyễn Phước Thảo"], "organizations": ["UBND TP HCM", "Ban chỉ đạo phòng chống dịch cúm gia cầm, thủy cầm TP HCM", "Công ty Huỳnh Gia", "Công ty Phú An Sinh", "Sở Tài chính", "Sở Nông nghiệp"], "address": ["TP HCM", "quận 2", "quận 8", "quận 9", "quận 10", "Bình Chánh", "Bình Tân", "Củ Chi", "Nhà Bè", "Cần Giờ", "Hóc Môn", "Tân Bình"]}
2025-11-24 03:32:47.871 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 17.99s
2025-11-24 03:32:47.871 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Nguyễn Phước Thảo', 'Thảo', 'Nhân', 'Nguyễn Thiện Nhân'], 'organizations': ['Công ty Phú An Sinh', 'Công ty Huỳnh Gia', 'Sở Nông nghiệp', 'UBND thành phố', 'Sở Tài chính', 'Ban chỉ đạo phòng chống dịch cúm gia cầm, thủy cầm TP HCM'], 'address': ['Cần Giờ', 'Bình Tân', '10', '8', '9', 'Tân Bình', 'Hóc Môn', 'Nhà Bè', 'quận 2', 'TP HCM', 'Bình Chánh', 'Củ Chi', 'Long An', 'quận 10']}
2025-11-24 03:32:47.871 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Nguyễn Thiện Nhân', 'Nguyễn Phước Thảo'], 'organizations': ['UBND TP HCM', 'Ban chỉ đạo phòng chống dịch cúm gia cầm, thủy cầm TP HCM', 'Công ty Huỳnh Gia', 'Công ty Phú An Sinh', 'Sở Tài chính', 'Sở Nông nghiệp'], 'address': ['TP HCM', 'quận 2', 'quận 8', 'quận 9', 'quận 10', 'Bình Chánh', 'Bình Tân', 'Củ Chi', 'Nhà Bè', 'Cần Giờ', 'Hóc Môn', 'Tân Bình']}
Extracting entities:  98%|█████████████████████████████████████████████████████████████████████▌ | 98/100 [26:01<00:30, 15.01s/it]2025-11-24 03:32:47.872 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 49.23it/s]
2025-11-24 03:32:47.896 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:33:03.196 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [11.445027351379395, 1.83576500415802, 1.6356745958328247]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 243.19it/s]
Processed prompts: 100%|█████████████████████| 1/1 [00:01<00:00,  1.49s/it, est. speed input: 897.35 toks/s, output: 73.88 toks/s]
2025-11-24 03:33:04.690 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Tiến \"Xanh\"", "Trần Tấn Bảo", "Vũ Kim Tiến", "Nguyễn Thái Bình"], "organizations": ["Phân đoạn Yên Viên", "Xí nghiệp đầu máy Hà Nội", "xí nghiệp đầu máy Hà Lào", "Xí nghiệp Đầu máy Hà Nội", "Xí nghiệp Đầu máy Hà Lào"], "address": ["Bắc Giang", "Lăng Cô", "Lan Mẫu", "Bảo Sơn", "Kép"]}
2025-11-24 03:33:04.690 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 16.82s
2025-11-24 03:33:04.690 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Tiến "Xanh"', 'Trần Tấn Bảo', 'Vũ Kim Tiến', 'Nguyễn Thái Bình'], 'organizations': ['Phân đoạn Yên Viên', 'Xí nghiệp đầu máy Hà Lào', 'xí nghiệp đầu máy Hà Lào', 'Xí nghiệp Đầu máy Hà Nội'], 'address': ['Bắc Giang', 'Lăng Cô', 'Lan Mẫu', 'Yên Viên', 'Bảo Sơn', 'Kép']}
2025-11-24 03:33:04.690 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Tiến "Xanh"', 'Trần Tấn Bảo', 'Vũ Kim Tiến', 'Nguyễn Thái Bình'], 'organizations': ['Phân đoạn Yên Viên', 'Xí nghiệp đầu máy Hà Nội', 'xí nghiệp đầu máy Hà Lào', 'Xí nghiệp Đầu máy Hà Nội', 'Xí nghiệp Đầu máy Hà Lào'], 'address': ['Bắc Giang', 'Lăng Cô', 'Lan Mẫu', 'Bảo Sơn', 'Kép']}
Extracting entities:  99%|██████████████████████████████████████████████████████████████████████▎| 99/100 [26:18<00:15, 15.55s/it]2025-11-24 03:33:04.690 | INFO     | src.rag_pipeline:extract_entities:258 - Starting RAG-based entity extraction
Batches: 100%|██████████████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 72.62it/s]
2025-11-24 03:33:04.708 | DEBUG    | src.rag_pipeline:retrieve:164 - Reranking 9 documents                  | 0/1 [00:00<?, ?it/s]
2025-11-24 03:33:13.681 | DEBUG    | src.rag_pipeline:rerank:203 - Top rerank scores: [10.9169282913208, 4.497673511505127, 4.367375373840332]
Adding requests: 100%|█████████████████████████████████████████████████████████████████████████████| 1/1 [00:00<00:00, 260.65it/s]
Processed prompts: 100%|████████████████████| 1/1 [00:00<00:00,  1.18it/s, est. speed input: 1353.86 toks/s, output: 73.12 toks/s]
2025-11-24 03:33:14.534 | DEBUG    | src.rag_pipeline:_query_vllm_model:297 - vLLM response: {"person": ["Huỳnh Đông Tuấn", "Đinh Văn Tốt"],"organizations": ["khu du lịch Suối Tiên", "Thảo Cầm Viên TP HCM", "Sở thú", "Văn Thánh", "Đầm sen"],"address": ["TP HCM"]}
2025-11-24 03:33:14.534 | INFO     | src.rag_pipeline:extract_entities:276 - RAG extraction completed in 9.84s
2025-11-24 03:33:14.534 | DEBUG    | __main__:<module>:58 - Ground truth: {'person': ['Huỳnh Đông Tuấn', 'Đinh Văn Tốt'], 'organizations': ['Khu du lịch Đầm Sen', 'Suối Tiên', 'Sở thú', 'Văn Thánh', 'Đầm sen', 'khu du lịch Suối Tiên', 'Thảo Cầm Viên TP HCM'], 'address': ['TP HCM']}
2025-11-24 03:33:14.534 | DEBUG    | __main__:<module>:59 - Prediction  : {'person': ['Huỳnh Đông Tuấn', 'Đinh Văn Tốt'], 'organizations': ['khu du lịch Suối Tiên', 'Thảo Cầm Viên TP HCM', 'Sở thú', 'Văn Thánh', 'Đầm sen'], 'address': ['TP HCM']}
Extracting entities: 100%|██████████████████████████████████████████████████████████████████████| 100/100 [26:28<00:00, 15.89s/it]
2025-11-24 03:33:14.534 | INFO     | __main__:<module>:63 - Calculating metrics...
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:88 - ================================================================================
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:89 - EVALUATION RESULTS
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:90 - ================================================================================
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:91 - Total samples: 100
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:92 - Corpus size: 100
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:93 - Total time: 1588.54s
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:94 - Throughput: 0.06 samples/s
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:95 - Avg time per sample: 15.89s
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:96 - 
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:97 - OVERALL METRICS:
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:98 -   Precision: 0.8166
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:99 -   Recall   : 0.8068
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:100 -   F1 Score : 0.8116
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:101 - 
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:102 - PER-ENTITY METRICS:
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:105 -   PERSON:
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:106 -     Precision: 0.8516
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:107 -     Recall   : 0.8165
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:108 -     F1 Score : 0.8337
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:105 -   ORGANIZATIONS:
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:106 -     Precision: 0.8569
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:107 -     Recall   : 0.8168
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:108 -     F1 Score : 0.8363
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:105 -   ADDRESS:
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:106 -     Precision: 0.7729
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:107 -     Recall   : 0.7947
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:108 -     F1 Score : 0.7836
2025-11-24 03:33:14.535 | INFO     | __main__:<module>:109 - ================================================================================
2025-11-24 03:33:14.539 | SUCCESS  | __main__:<module>:114 - Results saved to /data2/samdv/test/results/rag_eval/evaluation_results.json
2025-11-24 03:33:14.539 | INFO     | src.rag_pipeline:cleanup:303 - Cleaning up RAG extractor resources...